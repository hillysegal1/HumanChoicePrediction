
Start training the environment...
################
# Epoch 0
################



















































Create online-simulation users for this epoch. mean games/user: 44.31: 100%|██████████| 840/840 [01:45<00:00,  7.98it/s]

Online Simulation:   1%|          | 90/9306 [00:03<06:19, 24.26it/s]
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.8276, -0.5746],
         [-0.8276, -0.5746],
         [-0.8276, -0.5746],
         [-0.8276, -0.5746],
         [-0.8276, -0.5746],
         [-0.8276, -0.5746],
         [-0.8276, -0.5746],
         [-0.8276, -0.5746],
         [-0.8276, -0.5746],
         [-0.8276, -0.5746]],
        [[-0.8202, -0.5804],
         [-0.8202, -0.5804],
         [-0.8202, -0.5804],
         [-0.8202, -0.5804],
         [-0.8202, -0.5804],
         [-0.8202, -0.5804],
         [-0.8202, -0.5804],
         [-0.8202, -0.5804],
         [-0.8202, -0.5804],
         [-0.8202, -0.5804]],
        [[-0.8275, -0.5747],
         [-0.8275, -0.5747],
         [-0.8275, -0.5747],
         [-0.8275, -0.5747],
         [-0.8275, -0.5747],
         [-0.8275, -0.5747],
         [-0.8275, -0.5747],
         [-0.8275, -0.5747],
         [-0.8275, -0.5747],
         [-0.8275, -0.5747]],
        [[-0.8200, -0.5806],
         [-0.8200, -0.5806],
         [-0.8200, -0.5806],
         [-0.8200, -0.5806],
         [-0.8200, -0.5806],
         [-0.8200, -0.5806],
         [-0.8200, -0.5806],
         [-0.8200, -0.5806],
         [-0.8200, -0.5806],
         [-0.8200, -0.5806]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.8194, -0.5811],
         [-0.8194, -0.5811],
         [-0.8194, -0.5811],
         [-0.8194, -0.5811],
         [-0.8194, -0.5811],
         [-0.8194, -0.5811],
         [-0.8194, -0.5811],
         [-0.8194, -0.5811],
         [-0.8194, -0.5811],
         [-0.8194, -0.5811]],
        [[-0.8115, -0.5874],
         [-0.8115, -0.5874],
         [-0.8115, -0.5874],
         [-0.8115, -0.5874],
         [-0.8115, -0.5874],
         [-0.8115, -0.5874],
         [-0.8115, -0.5874],
         [-0.8115, -0.5874],
         [-0.8115, -0.5874],
         [-0.8115, -0.5874]],
        [[-0.8197, -0.5808],
         [-0.8197, -0.5808],
         [-0.8197, -0.5808],
         [-0.8197, -0.5808],
         [-0.8197, -0.5808],
         [-0.8197, -0.5808],
         [-0.8197, -0.5808],
         [-0.8197, -0.5808],
         [-0.8197, -0.5808],
         [-0.8197, -0.5808]],
        [[-0.8115, -0.5873],
         [-0.8115, -0.5873],
         [-0.8115, -0.5873],
         [-0.8115, -0.5873],
         [-0.8115, -0.5873],
         [-0.8115, -0.5873],
         [-0.8115, -0.5873],
         [-0.8115, -0.5873],
         [-0.8115, -0.5873],
         [-0.8115, -0.5873]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.8111, -0.5876],
         [-0.8111, -0.5876],
         [-0.8111, -0.5876],
         [-0.8111, -0.5876],
         [-0.8111, -0.5876],
         [-0.8111, -0.5876],
         [-0.8111, -0.5876],
         [-0.8111, -0.5876],
         [-0.8111, -0.5876],
         [-0.8111, -0.5876]],
        [[-0.8046, -0.5929],
         [-0.8046, -0.5929],
         [-0.8046, -0.5929],
         [-0.8046, -0.5929],
         [-0.8046, -0.5929],
         [-0.8046, -0.5929],
         [-0.8046, -0.5929],
         [-0.8046, -0.5929],
         [-0.8046, -0.5929],
         [-0.8046, -0.5929]],
        [[-0.8113, -0.5875],
         [-0.8113, -0.5875],
         [-0.8113, -0.5875],
         [-0.8113, -0.5875],
         [-0.8113, -0.5875],
         [-0.8113, -0.5875],
         [-0.8113, -0.5875],
         [-0.8113, -0.5875],
         [-0.8113, -0.5875],
         [-0.8113, -0.5875]],
        [[-0.8046, -0.5929],
         [-0.8046, -0.5929],
         [-0.8046, -0.5929],
         [-0.8046, -0.5929],
         [-0.8046, -0.5929],
         [-0.8046, -0.5929],
         [-0.8046, -0.5929],
         [-0.8046, -0.5929],
         [-0.8046, -0.5929],
         [-0.8046, -0.5929]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.8044, -0.5930],
         [-0.8044, -0.5930],
         [-0.8044, -0.5930],
         [-0.8044, -0.5930],
         [-0.8044, -0.5930],
         [-0.8044, -0.5930],
         [-0.8044, -0.5930],
         [-0.8044, -0.5930],
         [-0.8044, -0.5930],
         [-0.8044, -0.5930]],
        [[-0.8012, -0.5956],
         [-0.8012, -0.5956],
         [-0.8012, -0.5956],
         [-0.8012, -0.5956],
         [-0.8012, -0.5956],
         [-0.8012, -0.5956],
         [-0.8012, -0.5956],
         [-0.8012, -0.5956],
         [-0.8012, -0.5956],
         [-0.8012, -0.5956]],
        [[-0.8044, -0.5930],
         [-0.8044, -0.5930],
         [-0.8044, -0.5930],
         [-0.8044, -0.5930],
         [-0.8044, -0.5930],
         [-0.8044, -0.5930],
         [-0.8044, -0.5930],
         [-0.8044, -0.5930],
         [-0.8044, -0.5930],
         [-0.8044, -0.5930]],
        [[-0.8006, -0.5961],
         [-0.8006, -0.5961],
         [-0.8006, -0.5961],
         [-0.8006, -0.5961],
         [-0.8006, -0.5961],
         [-0.8006, -0.5961],
         [-0.8006, -0.5961],
         [-0.8006, -0.5961],
         [-0.8006, -0.5961],
         [-0.8006, -0.5961]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7978, -0.5984],
         [-0.7978, -0.5984],
         [-0.7978, -0.5984],
         [-0.7978, -0.5984],
         [-0.7978, -0.5984],
         [-0.7978, -0.5984],
         [-0.7978, -0.5984],
         [-0.7978, -0.5984],
         [-0.7978, -0.5984],
         [-0.7978, -0.5984]],
        [[-0.7971, -0.5990],
         [-0.7971, -0.5990],
         [-0.7971, -0.5990],
         [-0.7971, -0.5990],
         [-0.7971, -0.5990],
         [-0.7971, -0.5990],
         [-0.7971, -0.5990],
         [-0.7971, -0.5990],
         [-0.7971, -0.5990],
         [-0.7971, -0.5990]],
        [[-0.7974, -0.5987],
         [-0.7974, -0.5987],
         [-0.7974, -0.5987],
         [-0.7974, -0.5987],
         [-0.7974, -0.5987],
         [-0.7974, -0.5987],
         [-0.7974, -0.5987],
         [-0.7974, -0.5987],
         [-0.7974, -0.5987],
         [-0.7974, -0.5987]],
        [[-0.7968, -0.5993],
         [-0.7968, -0.5993],
         [-0.7968, -0.5993],
         [-0.7968, -0.5993],
         [-0.7968, -0.5993],
         [-0.7968, -0.5993],
         [-0.7968, -0.5993],
         [-0.7968, -0.5993],
         [-0.7968, -0.5993],
         [-0.7968, -0.5993]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7949, -0.6008],
         [-0.7949, -0.6008],
         [-0.7949, -0.6008],
         [-0.7949, -0.6008],
         [-0.7949, -0.6008],
         [-0.7949, -0.6008],
         [-0.7949, -0.6008],
         [-0.7949, -0.6008],
         [-0.7949, -0.6008],
         [-0.7949, -0.6008]],
        [[-0.7945, -0.6012],
         [-0.7945, -0.6012],
         [-0.7945, -0.6012],
         [-0.7945, -0.6012],
         [-0.7945, -0.6012],
         [-0.7945, -0.6012],
         [-0.7945, -0.6012],
         [-0.7945, -0.6012],
         [-0.7945, -0.6012],
         [-0.7945, -0.6012]],
        [[-0.7955, -0.6003],
         [-0.7955, -0.6003],
         [-0.7955, -0.6003],
         [-0.7955, -0.6003],
         [-0.7955, -0.6003],
         [-0.7955, -0.6003],
         [-0.7955, -0.6003],
         [-0.7955, -0.6003],
         [-0.7955, -0.6003],
         [-0.7955, -0.6003]],
        [[-0.7948, -0.6009],
         [-0.7948, -0.6009],
         [-0.7948, -0.6009],
         [-0.7948, -0.6009],
         [-0.7948, -0.6009],
         [-0.7948, -0.6009],
         [-0.7948, -0.6009],
         [-0.7948, -0.6009],
         [-0.7948, -0.6009],
         [-0.7948, -0.6009]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7918, -0.6033],
         [-0.7918, -0.6033],
         [-0.7918, -0.6033],
         [-0.7918, -0.6033],
         [-0.7918, -0.6033],
         [-0.7918, -0.6033],
         [-0.7918, -0.6033],
         [-0.7918, -0.6033],
         [-0.7918, -0.6033],
         [-0.7918, -0.6033]],
        [[-0.7909, -0.6041],
         [-0.7909, -0.6041],
         [-0.7909, -0.6041],
         [-0.7909, -0.6041],
         [-0.7909, -0.6041],
         [-0.7909, -0.6041],
         [-0.7909, -0.6041],
         [-0.7909, -0.6041],
         [-0.7909, -0.6041],
         [-0.7909, -0.6041]],
        [[-0.7915, -0.6036],
         [-0.7915, -0.6036],
         [-0.7915, -0.6036],
         [-0.7915, -0.6036],
         [-0.7915, -0.6036],
         [-0.7915, -0.6036],
         [-0.7915, -0.6036],
         [-0.7915, -0.6036],
         [-0.7915, -0.6036],
         [-0.7915, -0.6036]],
        [[-0.7912, -0.6039],
         [-0.7912, -0.6039],
         [-0.7912, -0.6039],
         [-0.7912, -0.6039],
         [-0.7912, -0.6039],
         [-0.7912, -0.6039],
         [-0.7912, -0.6039],
         [-0.7912, -0.6039],
         [-0.7912, -0.6039],
         [-0.7912, -0.6039]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7878, -0.6067],
         [-0.7878, -0.6067],
         [-0.7878, -0.6067],
         [-0.7878, -0.6067],
         [-0.7878, -0.6067],
         [-0.7878, -0.6067],
         [-0.7878, -0.6067],
         [-0.7878, -0.6067],
         [-0.7878, -0.6067],
         [-0.7878, -0.6067]],
        [[-0.7873, -0.6071],
         [-0.7873, -0.6071],
         [-0.7873, -0.6071],
         [-0.7873, -0.6071],
         [-0.7873, -0.6071],
         [-0.7873, -0.6071],
         [-0.7873, -0.6071],
         [-0.7873, -0.6071],
         [-0.7873, -0.6071],
         [-0.7873, -0.6071]],
        [[-0.7871, -0.6072],
         [-0.7871, -0.6072],
         [-0.7871, -0.6072],
         [-0.7871, -0.6072],
         [-0.7871, -0.6072],
         [-0.7871, -0.6072],
         [-0.7871, -0.6072],
         [-0.7871, -0.6072],
         [-0.7871, -0.6072],
         [-0.7871, -0.6072]],
        [[-0.7870, -0.6074],
         [-0.7870, -0.6074],
         [-0.7870, -0.6074],
         [-0.7870, -0.6074],
         [-0.7870, -0.6074],
         [-0.7870, -0.6074],
         [-0.7870, -0.6074],
         [-0.7870, -0.6074],
         [-0.7870, -0.6074],
         [-0.7870, -0.6074]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7818, -0.6117],
         [-0.7818, -0.6117],
         [-0.7818, -0.6117],
         [-0.7818, -0.6117],
         [-0.7818, -0.6117],
         [-0.7818, -0.6117],
         [-0.7818, -0.6117],
         [-0.7818, -0.6117],
         [-0.7818, -0.6117],
         [-0.7818, -0.6117]],
        [[-0.7816, -0.6119],
         [-0.7816, -0.6119],
         [-0.7816, -0.6119],
         [-0.7816, -0.6119],
         [-0.7816, -0.6119],
         [-0.7816, -0.6119],
         [-0.7816, -0.6119],
         [-0.7816, -0.6119],
         [-0.7816, -0.6119],
         [-0.7816, -0.6119]],
        [[-0.7818, -0.6118],
         [-0.7818, -0.6118],
         [-0.7818, -0.6118],
         [-0.7818, -0.6118],
         [-0.7818, -0.6118],
         [-0.7818, -0.6118],
         [-0.7818, -0.6118],
         [-0.7818, -0.6118],
         [-0.7818, -0.6118],
         [-0.7818, -0.6118]],
        [[-0.7816, -0.6119],
         [-0.7816, -0.6119],
         [-0.7816, -0.6119],
         [-0.7816, -0.6119],
         [-0.7816, -0.6119],
         [-0.7816, -0.6119],
         [-0.7816, -0.6119],
         [-0.7816, -0.6119],
         [-0.7816, -0.6119],
         [-0.7816, -0.6119]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7760, -0.6166],
         [-0.7760, -0.6166],
         [-0.7760, -0.6166],
         [-0.7760, -0.6166],
         [-0.7760, -0.6166],
         [-0.7760, -0.6166],
         [-0.7760, -0.6166],
         [-0.7760, -0.6166],
         [-0.7760, -0.6166],
         [-0.7760, -0.6166]],
        [[-0.7761, -0.6166],
         [-0.7761, -0.6166],
         [-0.7761, -0.6166],
         [-0.7761, -0.6166],
         [-0.7761, -0.6166],
         [-0.7761, -0.6166],
         [-0.7761, -0.6166],
         [-0.7761, -0.6166],
         [-0.7761, -0.6166],
         [-0.7761, -0.6166]],
        [[-0.7759, -0.6167],
         [-0.7759, -0.6167],
         [-0.7759, -0.6167],
         [-0.7759, -0.6167],
         [-0.7759, -0.6167],
         [-0.7759, -0.6167],
         [-0.7759, -0.6167],
         [-0.7759, -0.6167],
         [-0.7759, -0.6167],
         [-0.7759, -0.6167]],
        [[-0.7791, -0.6140],
         [-0.7791, -0.6140],
         [-0.7791, -0.6140],
         [-0.7791, -0.6140],
         [-0.7791, -0.6140],
         [-0.7791, -0.6140],
         [-0.7791, -0.6140],
         [-0.7791, -0.6140],
         [-0.7791, -0.6140],
         [-0.7791, -0.6140]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7706, -0.6212],
         [-0.7706, -0.6212],
         [-0.7706, -0.6212],
         [-0.7706, -0.6212],
         [-0.7706, -0.6212],
         [-0.7706, -0.6212],
         [-0.7706, -0.6212],
         [-0.7706, -0.6212],
         [-0.7706, -0.6212],
         [-0.7706, -0.6212]],
        [[-0.7704, -0.6215],
         [-0.7704, -0.6215],
         [-0.7704, -0.6215],
         [-0.7704, -0.6215],
         [-0.7704, -0.6215],
         [-0.7704, -0.6215],
         [-0.7704, -0.6215],
         [-0.7704, -0.6215],
         [-0.7704, -0.6215],
         [-0.7704, -0.6215]],
        [[-0.7726, -0.6195],
         [-0.7726, -0.6195],
         [-0.7726, -0.6195],
         [-0.7726, -0.6195],
         [-0.7726, -0.6195],
         [-0.7726, -0.6195],
         [-0.7726, -0.6195],
         [-0.7726, -0.6195],
         [-0.7726, -0.6195],
         [-0.7726, -0.6195]],
        [[-0.7711, -0.6209],
         [-0.7711, -0.6209],
         [-0.7711, -0.6209],
         [-0.7711, -0.6209],
         [-0.7711, -0.6209],
         [-0.7711, -0.6209],
         [-0.7711, -0.6209],
         [-0.7711, -0.6209],
         [-0.7711, -0.6209],
         [-0.7711, -0.6209]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7645, -0.6265],
         [-0.7645, -0.6265],
         [-0.7645, -0.6265],
         [-0.7645, -0.6265],
         [-0.7645, -0.6265],
         [-0.7645, -0.6265],
         [-0.7645, -0.6265],
         [-0.7645, -0.6265],
         [-0.7645, -0.6265],
         [-0.7645, -0.6265]],
        [[-0.7650, -0.6261],
         [-0.7650, -0.6261],
         [-0.7650, -0.6261],
         [-0.7650, -0.6261],
         [-0.7650, -0.6261],
         [-0.7650, -0.6261],
         [-0.7650, -0.6261],
         [-0.7650, -0.6261],
         [-0.7650, -0.6261],
         [-0.7650, -0.6261]],
        [[-0.7654, -0.6258],
         [-0.7654, -0.6258],
         [-0.7654, -0.6258],
         [-0.7654, -0.6258],
         [-0.7654, -0.6258],
         [-0.7654, -0.6258],
         [-0.7654, -0.6258],
         [-0.7654, -0.6258],
         [-0.7654, -0.6258],
         [-0.7654, -0.6258]],
        [[-0.7672, -0.6242],
         [-0.7672, -0.6242],
         [-0.7672, -0.6242],
         [-0.7672, -0.6242],
         [-0.7672, -0.6242],
         [-0.7672, -0.6242],
         [-0.7672, -0.6242],
         [-0.7672, -0.6242],
         [-0.7672, -0.6242],
         [-0.7672, -0.6242]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7592, -0.6312],
         [-0.7592, -0.6312],
         [-0.7592, -0.6312],
         [-0.7592, -0.6312],
         [-0.7592, -0.6312],
         [-0.7592, -0.6312],
         [-0.7592, -0.6312],
         [-0.7592, -0.6312],
         [-0.7592, -0.6312],
         [-0.7592, -0.6312]],
        [[-0.7626, -0.6282],
         [-0.7626, -0.6282],
         [-0.7626, -0.6282],
         [-0.7626, -0.6282],
         [-0.7626, -0.6282],
         [-0.7626, -0.6282],
         [-0.7626, -0.6282],
         [-0.7626, -0.6282],
         [-0.7626, -0.6282],
         [-0.7626, -0.6282]],
        [[-0.7597, -0.6308],
         [-0.7597, -0.6308],
         [-0.7597, -0.6308],
         [-0.7597, -0.6308],
         [-0.7597, -0.6308],
         [-0.7597, -0.6308],
         [-0.7597, -0.6308],
         [-0.7597, -0.6308],
         [-0.7597, -0.6308],
         [-0.7597, -0.6308]],
        [[-0.7598, -0.6307],
         [-0.7598, -0.6307],
         [-0.7598, -0.6307],
         [-0.7598, -0.6307],
         [-0.7598, -0.6307],
         [-0.7598, -0.6307],
         [-0.7598, -0.6307],
         [-0.7598, -0.6307],
         [-0.7598, -0.6307],
         [-0.7598, -0.6307]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7527, -0.6369],
         [-0.7527, -0.6369],
         [-0.7527, -0.6369],
         [-0.7527, -0.6369],
         [-0.7527, -0.6369],
         [-0.7527, -0.6369],
         [-0.7527, -0.6369],
         [-0.7527, -0.6369],
         [-0.7527, -0.6369],
         [-0.7527, -0.6369]],
        [[-0.7547, -0.6352],
         [-0.7547, -0.6352],
         [-0.7547, -0.6352],
         [-0.7547, -0.6352],
         [-0.7547, -0.6352],
         [-0.7547, -0.6352],
         [-0.7547, -0.6352],
         [-0.7547, -0.6352],
         [-0.7547, -0.6352],
         [-0.7547, -0.6352]],
        [[-0.7556, -0.6343],
         [-0.7556, -0.6343],
         [-0.7556, -0.6343],
         [-0.7556, -0.6343],
         [-0.7556, -0.6343],
         [-0.7556, -0.6343],
         [-0.7556, -0.6343],
         [-0.7556, -0.6343],
         [-0.7556, -0.6343],
         [-0.7556, -0.6343]],
        [[-0.7571, -0.6330],
         [-0.7571, -0.6330],
         [-0.7571, -0.6330],
         [-0.7571, -0.6330],
         [-0.7571, -0.6330],
         [-0.7571, -0.6330],
         [-0.7571, -0.6330],
         [-0.7571, -0.6330],
         [-0.7571, -0.6330],
         [-0.7571, -0.6330]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7471, -0.6419],
         [-0.7471, -0.6419],
         [-0.7471, -0.6419],
         [-0.7471, -0.6419],
         [-0.7471, -0.6419],
         [-0.7471, -0.6419],
         [-0.7471, -0.6419],
         [-0.7471, -0.6419],
         [-0.7471, -0.6419],
         [-0.7471, -0.6419]],
        [[-0.7493, -0.6399],
         [-0.7493, -0.6399],
         [-0.7493, -0.6399],
         [-0.7493, -0.6399],
         [-0.7493, -0.6399],
         [-0.7493, -0.6399],
         [-0.7493, -0.6399],
         [-0.7493, -0.6399],
         [-0.7493, -0.6399],
         [-0.7493, -0.6399]],
        [[-0.7445, -0.6443],
         [-0.7445, -0.6443],
         [-0.7445, -0.6443],
         [-0.7445, -0.6443],
         [-0.7445, -0.6443],
         [-0.7445, -0.6443],
         [-0.7445, -0.6443],
         [-0.7445, -0.6443],
         [-0.7445, -0.6443],
         [-0.7445, -0.6443]],
        [[-0.7500, -0.6394],
         [-0.7500, -0.6394],
         [-0.7500, -0.6394],
         [-0.7500, -0.6394],
         [-0.7500, -0.6394],
         [-0.7500, -0.6394],
         [-0.7500, -0.6394],
         [-0.7500, -0.6394],
         [-0.7500, -0.6394],
         [-0.7500, -0.6394]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7386, -0.6497],
         [-0.7386, -0.6497],
         [-0.7386, -0.6497],
         [-0.7386, -0.6497],
         [-0.7386, -0.6497],
         [-0.7386, -0.6497],
         [-0.7386, -0.6497],
         [-0.7386, -0.6497],
         [-0.7386, -0.6497],
         [-0.7386, -0.6497]],
        [[-0.7419, -0.6466],
         [-0.7419, -0.6466],
         [-0.7419, -0.6466],
         [-0.7419, -0.6466],
         [-0.7419, -0.6466],
         [-0.7419, -0.6466],
         [-0.7419, -0.6466],
         [-0.7419, -0.6466],
         [-0.7419, -0.6466],
         [-0.7419, -0.6466]],
        [[-0.7400, -0.6484],
         [-0.7400, -0.6484],
         [-0.7400, -0.6484],
         [-0.7400, -0.6484],
         [-0.7400, -0.6484],
         [-0.7400, -0.6484],
         [-0.7400, -0.6484],
         [-0.7400, -0.6484],
         [-0.7400, -0.6484],
         [-0.7400, -0.6484]],
        [[-0.7434, -0.6453],
         [-0.7434, -0.6453],
         [-0.7434, -0.6453],
         [-0.7434, -0.6453],
         [-0.7434, -0.6453],
         [-0.7434, -0.6453],
         [-0.7434, -0.6453],
         [-0.7434, -0.6453],
         [-0.7434, -0.6453],
         [-0.7434, -0.6453]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7338, -0.6541],
         [-0.7338, -0.6541],
         [-0.7338, -0.6541],
         [-0.7338, -0.6541],
         [-0.7338, -0.6541],
         [-0.7338, -0.6541],
         [-0.7338, -0.6541],
         [-0.7338, -0.6541],
         [-0.7338, -0.6541],
         [-0.7338, -0.6541]],
        [[-0.7400, -0.6484],
         [-0.7400, -0.6484],
         [-0.7400, -0.6484],
         [-0.7400, -0.6484],
         [-0.7400, -0.6484],
         [-0.7400, -0.6484],
         [-0.7400, -0.6484],
         [-0.7400, -0.6484],
         [-0.7400, -0.6484],
         [-0.7400, -0.6484]],
        [[-0.7317, -0.6560],
         [-0.7317, -0.6560],
         [-0.7317, -0.6560],
         [-0.7317, -0.6560],
         [-0.7317, -0.6560],
         [-0.7317, -0.6560],
         [-0.7317, -0.6560],
         [-0.7317, -0.6560],
         [-0.7317, -0.6560],
         [-0.7317, -0.6560]],
        [[-0.7389, -0.6494],
         [-0.7389, -0.6494],
         [-0.7389, -0.6494],
         [-0.7389, -0.6494],
         [-0.7389, -0.6494],
         [-0.7389, -0.6494],
         [-0.7389, -0.6494],
         [-0.7389, -0.6494],
         [-0.7389, -0.6494],
         [-0.7389, -0.6494]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7245, -0.6628],
         [-0.7245, -0.6628],
         [-0.7245, -0.6628],
         [-0.7245, -0.6628],
         [-0.7245, -0.6628],
         [-0.7245, -0.6628],
         [-0.7245, -0.6628],
         [-0.7245, -0.6628],
         [-0.7245, -0.6628],
         [-0.7245, -0.6628]],
        [[-0.7310, -0.6567],
         [-0.7310, -0.6567],
         [-0.7310, -0.6567],
         [-0.7310, -0.6567],
         [-0.7310, -0.6567],
         [-0.7310, -0.6567],
         [-0.7310, -0.6567],
         [-0.7310, -0.6567],
         [-0.7310, -0.6567],
         [-0.7310, -0.6567]],
        [[-0.7246, -0.6627],
         [-0.7246, -0.6627],
         [-0.7246, -0.6627],
         [-0.7246, -0.6627],
         [-0.7246, -0.6627],
         [-0.7246, -0.6627],
         [-0.7246, -0.6627],
         [-0.7246, -0.6627],
         [-0.7246, -0.6627],
         [-0.7246, -0.6627]],
        [[-0.7311, -0.6565],
         [-0.7311, -0.6565],
         [-0.7311, -0.6565],
         [-0.7311, -0.6565],
         [-0.7311, -0.6565],
         [-0.7311, -0.6565],
         [-0.7311, -0.6565],
         [-0.7311, -0.6565],
         [-0.7311, -0.6565],
         [-0.7311, -0.6565]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7220, -0.6651],
         [-0.7220, -0.6651],
         [-0.7220, -0.6651],
         [-0.7220, -0.6651],
         [-0.7220, -0.6651],
         [-0.7220, -0.6651],
         [-0.7220, -0.6651],
         [-0.7220, -0.6651],
         [-0.7220, -0.6651],
         [-0.7220, -0.6651]],
        [[-0.7273, -0.6601],
         [-0.7273, -0.6601],
         [-0.7273, -0.6601],
         [-0.7273, -0.6601],
         [-0.7273, -0.6601],
         [-0.7273, -0.6601],
         [-0.7273, -0.6601],
         [-0.7273, -0.6601],
         [-0.7273, -0.6601],
         [-0.7273, -0.6601]],
        [[-0.7221, -0.6650],
         [-0.7221, -0.6650],
         [-0.7221, -0.6650],
         [-0.7221, -0.6650],
         [-0.7221, -0.6650],
         [-0.7221, -0.6650],
         [-0.7221, -0.6650],
         [-0.7221, -0.6650],
         [-0.7221, -0.6650],
         [-0.7221, -0.6650]],
        [[-0.7253, -0.6620],
         [-0.7253, -0.6620],
         [-0.7253, -0.6620],
         [-0.7253, -0.6620],
         [-0.7253, -0.6620],
         [-0.7253, -0.6620],
         [-0.7253, -0.6620],
         [-0.7253, -0.6620],
         [-0.7253, -0.6620],
         [-0.7253, -0.6620]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7120, -0.6747],
         [-0.7120, -0.6747],
         [-0.7120, -0.6747],
         [-0.7120, -0.6747],
         [-0.7120, -0.6747],
         [-0.7120, -0.6747],
         [-0.7120, -0.6747],
         [-0.7120, -0.6747],
         [-0.7120, -0.6747],
         [-0.7120, -0.6747]],
        [[-0.7228, -0.6643],
         [-0.7228, -0.6643],
         [-0.7228, -0.6643],
         [-0.7228, -0.6643],
         [-0.7228, -0.6643],
         [-0.7228, -0.6643],
         [-0.7228, -0.6643],
         [-0.7228, -0.6643],
         [-0.7228, -0.6643],
         [-0.7228, -0.6643]],
        [[-0.7126, -0.6741],
         [-0.7126, -0.6741],
         [-0.7126, -0.6741],
         [-0.7126, -0.6741],
         [-0.7126, -0.6741],
         [-0.7126, -0.6741],
         [-0.7126, -0.6741],
         [-0.7126, -0.6741],
         [-0.7126, -0.6741],
         [-0.7126, -0.6741]],
        [[-0.7209, -0.6661],
         [-0.7209, -0.6661],
         [-0.7209, -0.6661],
         [-0.7209, -0.6661],
         [-0.7209, -0.6661],
         [-0.7209, -0.6661],
         [-0.7209, -0.6661],
         [-0.7209, -0.6661],
         [-0.7209, -0.6661],
         [-0.7209, -0.6661]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7098, -0.6768],
         [-0.7098, -0.6768],
         [-0.7098, -0.6768],
         [-0.7098, -0.6768],
         [-0.7098, -0.6768],
         [-0.7098, -0.6768],
         [-0.7098, -0.6768],
         [-0.7098, -0.6768],
         [-0.7098, -0.6768],
         [-0.7098, -0.6768]],
        [[-0.7189, -0.6680],
         [-0.7189, -0.6680],
         [-0.7189, -0.6680],
         [-0.7189, -0.6680],
         [-0.7189, -0.6680],
         [-0.7189, -0.6680],
         [-0.7189, -0.6680],
         [-0.7189, -0.6680],
         [-0.7189, -0.6680],
         [-0.7189, -0.6680]],
        [[-0.7166, -0.6702],
         [-0.7166, -0.6702],
         [-0.7166, -0.6702],
         [-0.7166, -0.6702],
         [-0.7166, -0.6702],
         [-0.7166, -0.6702],
         [-0.7166, -0.6702],
         [-0.7166, -0.6702],
         [-0.7166, -0.6702],
         [-0.7166, -0.6702]],
        [[-0.7176, -0.6693],
         [-0.7176, -0.6693],
         [-0.7176, -0.6693],
         [-0.7176, -0.6693],
         [-0.7176, -0.6693],
         [-0.7176, -0.6693],
         [-0.7176, -0.6693],
         [-0.7176, -0.6693],
         [-0.7176, -0.6693],
         [-0.7176, -0.6693]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7072, -0.6793],
         [-0.7072, -0.6793],
         [-0.7072, -0.6793],
         [-0.7072, -0.6793],
         [-0.7072, -0.6793],
         [-0.7072, -0.6793],
         [-0.7072, -0.6793],
         [-0.7072, -0.6793],
         [-0.7072, -0.6793],
         [-0.7072, -0.6793]],
        [[-0.7160, -0.6708],
         [-0.7160, -0.6708],
         [-0.7160, -0.6708],
         [-0.7160, -0.6708],
         [-0.7160, -0.6708],
         [-0.7160, -0.6708],
         [-0.7160, -0.6708],
         [-0.7160, -0.6708],
         [-0.7160, -0.6708],
         [-0.7160, -0.6708]],
        [[-0.7078, -0.6787],
         [-0.7078, -0.6787],
         [-0.7078, -0.6787],
         [-0.7078, -0.6787],
         [-0.7078, -0.6787],
         [-0.7078, -0.6787],
         [-0.7078, -0.6787],
         [-0.7078, -0.6787],
         [-0.7078, -0.6787],
         [-0.7078, -0.6787]],
        [[-0.7185, -0.6684],
         [-0.7185, -0.6684],
         [-0.7185, -0.6684],
         [-0.7185, -0.6684],
         [-0.7185, -0.6684],
         [-0.7185, -0.6684],
         [-0.7185, -0.6684],
         [-0.7185, -0.6684],
         [-0.7185, -0.6684],
         [-0.7185, -0.6684]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7083, -0.6782],
         [-0.7083, -0.6782],
         [-0.7083, -0.6782],
         [-0.7083, -0.6782],
         [-0.7083, -0.6782],
         [-0.7083, -0.6782],
         [-0.7083, -0.6782],
         [-0.7083, -0.6782],
         [-0.7083, -0.6782],
         [-0.7083, -0.6782]],
        [[-0.7179, -0.6690],
         [-0.7179, -0.6690],
         [-0.7179, -0.6690],
         [-0.7179, -0.6690],
         [-0.7179, -0.6690],
         [-0.7179, -0.6690],
         [-0.7179, -0.6690],
         [-0.7179, -0.6690],
         [-0.7179, -0.6690],
         [-0.7179, -0.6690]],
        [[-0.7068, -0.6797],
         [-0.7068, -0.6797],
         [-0.7068, -0.6797],
         [-0.7068, -0.6797],
         [-0.7068, -0.6797],
         [-0.7068, -0.6797],
         [-0.7068, -0.6797],
         [-0.7068, -0.6797],
         [-0.7068, -0.6797],
         [-0.7068, -0.6797]],
        [[-0.7170, -0.6698],
         [-0.7170, -0.6698],
         [-0.7170, -0.6698],
         [-0.7170, -0.6698],
         [-0.7170, -0.6698],
         [-0.7170, -0.6698],
         [-0.7170, -0.6698],
         [-0.7170, -0.6698],
         [-0.7170, -0.6698],
         [-0.7170, -0.6698]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7104, -0.6762],
         [-0.7104, -0.6762],
         [-0.7104, -0.6762],
         [-0.7104, -0.6762],
         [-0.7104, -0.6762],
         [-0.7104, -0.6762],
         [-0.7104, -0.6762],
         [-0.7104, -0.6762],
         [-0.7104, -0.6762],
         [-0.7104, -0.6762]],
        [[-0.7168, -0.6700],
         [-0.7168, -0.6700],
         [-0.7168, -0.6700],
         [-0.7168, -0.6700],
         [-0.7168, -0.6700],
         [-0.7168, -0.6700],
         [-0.7168, -0.6700],
         [-0.7168, -0.6700],
         [-0.7168, -0.6700],
         [-0.7168, -0.6700]],
        [[-0.7090, -0.6776],
         [-0.7090, -0.6776],
         [-0.7090, -0.6776],
         [-0.7090, -0.6776],
         [-0.7090, -0.6776],
         [-0.7090, -0.6776],
         [-0.7090, -0.6776],
         [-0.7090, -0.6776],
         [-0.7090, -0.6776],
         [-0.7090, -0.6776]],
        [[-0.7156, -0.6712],
         [-0.7156, -0.6712],
         [-0.7156, -0.6712],
         [-0.7156, -0.6712],
         [-0.7156, -0.6712],
         [-0.7156, -0.6712],
         [-0.7156, -0.6712],
         [-0.7156, -0.6712],
         [-0.7156, -0.6712],
         [-0.7156, -0.6712]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7062, -0.6803],
         [-0.7062, -0.6803],
         [-0.7062, -0.6803],
         [-0.7062, -0.6803],
         [-0.7062, -0.6803],
         [-0.7062, -0.6803],
         [-0.7062, -0.6803],
         [-0.7062, -0.6803],
         [-0.7062, -0.6803],
         [-0.7062, -0.6803]],
        [[-0.7197, -0.6673],
         [-0.7197, -0.6673],
         [-0.7197, -0.6673],
         [-0.7197, -0.6673],
         [-0.7197, -0.6673],
         [-0.7197, -0.6673],
         [-0.7197, -0.6673],
         [-0.7197, -0.6673],
         [-0.7197, -0.6673],
         [-0.7197, -0.6673]],
        [[-0.7041, -0.6823],
         [-0.7041, -0.6823],
         [-0.7041, -0.6823],
         [-0.7041, -0.6823],
         [-0.7041, -0.6823],
         [-0.7041, -0.6823],
         [-0.7041, -0.6823],
         [-0.7041, -0.6823],
         [-0.7041, -0.6823],
         [-0.7041, -0.6823]],
        [[-0.7163, -0.6705],
         [-0.7163, -0.6705],
         [-0.7163, -0.6705],
         [-0.7163, -0.6705],
         [-0.7163, -0.6705],
         [-0.7163, -0.6705],
         [-0.7163, -0.6705],
         [-0.7163, -0.6705],
         [-0.7163, -0.6705],
         [-0.7163, -0.6705]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7073, -0.6792],
         [-0.7073, -0.6792],
         [-0.7073, -0.6792],
         [-0.7073, -0.6792],
         [-0.7073, -0.6792],
         [-0.7073, -0.6792],
         [-0.7073, -0.6792],
         [-0.7073, -0.6792],
         [-0.7073, -0.6792],
         [-0.7073, -0.6792]],
        [[-0.7127, -0.6740],
         [-0.7127, -0.6740],
         [-0.7127, -0.6740],
         [-0.7127, -0.6740],
         [-0.7127, -0.6740],
         [-0.7127, -0.6740],
         [-0.7127, -0.6740],
         [-0.7127, -0.6740],
         [-0.7127, -0.6740],
         [-0.7127, -0.6740]],
        [[-0.7038, -0.6826],
         [-0.7038, -0.6826],
         [-0.7038, -0.6826],
         [-0.7038, -0.6826],
         [-0.7038, -0.6826],
         [-0.7038, -0.6826],
         [-0.7038, -0.6826],
         [-0.7038, -0.6826],
         [-0.7038, -0.6826],
         [-0.7038, -0.6826]],
        [[-0.7128, -0.6738],
         [-0.7128, -0.6738],
         [-0.7128, -0.6738],
         [-0.7128, -0.6738],
         [-0.7128, -0.6738],
         [-0.7128, -0.6738],
         [-0.7128, -0.6738],
         [-0.7128, -0.6738],
         [-0.7128, -0.6738],
         [-0.7128, -0.6738]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7067, -0.6797],
         [-0.7067, -0.6797],
         [-0.7067, -0.6797],
         [-0.7067, -0.6797],
         [-0.7067, -0.6797],
         [-0.7067, -0.6797],
         [-0.7067, -0.6797],
         [-0.7067, -0.6797],
         [-0.7067, -0.6797],
         [-0.7067, -0.6797]],
        [[-0.7176, -0.6693],
         [-0.7176, -0.6693],
         [-0.7176, -0.6693],
         [-0.7176, -0.6693],
         [-0.7176, -0.6693],
         [-0.7176, -0.6693],
         [-0.7176, -0.6693],
         [-0.7176, -0.6693],
         [-0.7176, -0.6693],
         [-0.7176, -0.6693]],
        [[-0.7013, -0.6851],
         [-0.7013, -0.6851],
         [-0.7013, -0.6851],
         [-0.7013, -0.6851],
         [-0.7013, -0.6851],
         [-0.7013, -0.6851],
         [-0.7013, -0.6851],
         [-0.7013, -0.6851],
         [-0.7013, -0.6851],
         [-0.7013, -0.6851]],
        [[-0.7128, -0.6738],
         [-0.7128, -0.6738],
         [-0.7128, -0.6738],
         [-0.7128, -0.6738],
         [-0.7128, -0.6738],
         [-0.7128, -0.6738],
         [-0.7128, -0.6738],
         [-0.7128, -0.6738],
         [-0.7128, -0.6738],
         [-0.7128, -0.6738]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7046, -0.6818],
         [-0.7046, -0.6818],
         [-0.7046, -0.6818],
         [-0.7046, -0.6818],
         [-0.7046, -0.6818],
         [-0.7046, -0.6818],
         [-0.7046, -0.6818],
         [-0.7046, -0.6818],
         [-0.7046, -0.6818],
         [-0.7046, -0.6818]],
        [[-0.7126, -0.6741],
         [-0.7126, -0.6741],
         [-0.7126, -0.6741],
         [-0.7126, -0.6741],
         [-0.7126, -0.6741],
         [-0.7126, -0.6741],
         [-0.7126, -0.6741],
         [-0.7126, -0.6741],
         [-0.7126, -0.6741],
         [-0.7126, -0.6741]],
        [[-0.7069, -0.6795],
         [-0.7069, -0.6795],
         [-0.7069, -0.6795],
         [-0.7069, -0.6795],
         [-0.7069, -0.6795],
         [-0.7069, -0.6795],
         [-0.7069, -0.6795],
         [-0.7069, -0.6795],
         [-0.7069, -0.6795],
         [-0.7069, -0.6795]],
        [[-0.7152, -0.6716],
         [-0.7152, -0.6716],
         [-0.7152, -0.6716],
         [-0.7152, -0.6716],
         [-0.7152, -0.6716],
         [-0.7152, -0.6716],
         [-0.7152, -0.6716],
         [-0.7152, -0.6716],
         [-0.7152, -0.6716],
         [-0.7152, -0.6716]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7029, -0.6835],
         [-0.7029, -0.6835],
         [-0.7029, -0.6835],
         [-0.7029, -0.6835],
         [-0.7029, -0.6835],
         [-0.7029, -0.6835],
         [-0.7029, -0.6835],
         [-0.7029, -0.6835],
         [-0.7029, -0.6835],
         [-0.7029, -0.6835]],
        [[-0.7119, -0.6748],
         [-0.7119, -0.6748],
         [-0.7119, -0.6748],
         [-0.7119, -0.6748],
         [-0.7119, -0.6748],
         [-0.7119, -0.6748],
         [-0.7119, -0.6748],
         [-0.7119, -0.6748],
         [-0.7119, -0.6748],
         [-0.7119, -0.6748]],
        [[-0.7038, -0.6826],
         [-0.7038, -0.6826],
         [-0.7038, -0.6826],
         [-0.7038, -0.6826],
         [-0.7038, -0.6826],
         [-0.7038, -0.6826],
         [-0.7038, -0.6826],
         [-0.7038, -0.6826],
         [-0.7038, -0.6826],
         [-0.7038, -0.6826]],
        [[-0.7107, -0.6759],
         [-0.7107, -0.6759],
         [-0.7107, -0.6759],
         [-0.7107, -0.6759],
         [-0.7107, -0.6759],
         [-0.7107, -0.6759],
         [-0.7107, -0.6759],
         [-0.7107, -0.6759],
         [-0.7107, -0.6759],
         [-0.7107, -0.6759]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7027, -0.6837],
         [-0.7027, -0.6837],
         [-0.7027, -0.6837],
         [-0.7027, -0.6837],
         [-0.7027, -0.6837],
         [-0.7027, -0.6837],
         [-0.7027, -0.6837],
         [-0.7027, -0.6837],
         [-0.7027, -0.6837],
         [-0.7027, -0.6837]],
        [[-0.7115, -0.6752],
         [-0.7115, -0.6752],
         [-0.7115, -0.6752],
         [-0.7115, -0.6752],
         [-0.7115, -0.6752],
         [-0.7115, -0.6752],
         [-0.7115, -0.6752],
         [-0.7115, -0.6752],
         [-0.7115, -0.6752],
         [-0.7115, -0.6752]],
        [[-0.7070, -0.6795],
         [-0.7070, -0.6795],
         [-0.7070, -0.6795],
         [-0.7070, -0.6795],
         [-0.7070, -0.6795],
         [-0.7070, -0.6795],
         [-0.7070, -0.6795],
         [-0.7070, -0.6795],
         [-0.7070, -0.6795],
         [-0.7070, -0.6795]],
        [[-0.7116, -0.6751],
         [-0.7116, -0.6751],
         [-0.7116, -0.6751],
         [-0.7116, -0.6751],
         [-0.7116, -0.6751],
         [-0.7116, -0.6751],
         [-0.7116, -0.6751],
         [-0.7116, -0.6751],
         [-0.7116, -0.6751],
         [-0.7116, -0.6751]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7108, -0.6758],
         [-0.7108, -0.6758],
         [-0.7108, -0.6758],
         [-0.7108, -0.6758],
         [-0.7108, -0.6758],
         [-0.7108, -0.6758],
         [-0.7108, -0.6758],
         [-0.7108, -0.6758],
         [-0.7108, -0.6758],
         [-0.7108, -0.6758]],
        [[-0.7153, -0.6715],
         [-0.7153, -0.6715],
         [-0.7153, -0.6715],
         [-0.7153, -0.6715],
         [-0.7153, -0.6715],
         [-0.7153, -0.6715],
         [-0.7153, -0.6715],
         [-0.7153, -0.6715],
         [-0.7153, -0.6715],
         [-0.7153, -0.6715]],
        [[-0.7083, -0.6782],
         [-0.7083, -0.6782],
         [-0.7083, -0.6782],
         [-0.7083, -0.6782],
         [-0.7083, -0.6782],
         [-0.7083, -0.6782],
         [-0.7083, -0.6782],
         [-0.7083, -0.6782],
         [-0.7083, -0.6782],
         [-0.7083, -0.6782]],
        [[-0.7192, -0.6677],
         [-0.7192, -0.6677],
         [-0.7192, -0.6677],
         [-0.7192, -0.6677],
         [-0.7192, -0.6677],
         [-0.7192, -0.6677],
         [-0.7192, -0.6677],
         [-0.7192, -0.6677],
         [-0.7192, -0.6677],
         [-0.7192, -0.6677]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7041, -0.6824],
         [-0.7041, -0.6824],
         [-0.7041, -0.6824],
         [-0.7041, -0.6824],
         [-0.7041, -0.6824],
         [-0.7041, -0.6824],
         [-0.7041, -0.6824],
         [-0.7041, -0.6824],
         [-0.7041, -0.6824],
         [-0.7041, -0.6824]],
        [[-0.7162, -0.6706],
         [-0.7162, -0.6706],
         [-0.7162, -0.6706],
         [-0.7162, -0.6706],
         [-0.7162, -0.6706],
         [-0.7162, -0.6706],
         [-0.7162, -0.6706],
         [-0.7162, -0.6706],
         [-0.7162, -0.6706],
         [-0.7162, -0.6706]],
        [[-0.7059, -0.6805],
         [-0.7059, -0.6805],
         [-0.7059, -0.6805],
         [-0.7059, -0.6805],
         [-0.7059, -0.6805],
         [-0.7059, -0.6805],
         [-0.7059, -0.6805],
         [-0.7059, -0.6805],
         [-0.7059, -0.6805],
         [-0.7059, -0.6805]],
        [[-0.7146, -0.6722],
         [-0.7146, -0.6722],
         [-0.7146, -0.6722],
         [-0.7146, -0.6722],
         [-0.7146, -0.6722],
         [-0.7146, -0.6722],
         [-0.7146, -0.6722],
         [-0.7146, -0.6722],
         [-0.7146, -0.6722],
         [-0.7146, -0.6722]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7104, -0.6762],
         [-0.7104, -0.6762],
         [-0.7104, -0.6762],
         [-0.7104, -0.6762],
         [-0.7104, -0.6762],
         [-0.7104, -0.6762],
         [-0.7104, -0.6762],
         [-0.7104, -0.6762],
         [-0.7104, -0.6762],
         [-0.7104, -0.6762]],
        [[-0.7151, -0.6717],
         [-0.7151, -0.6717],
         [-0.7151, -0.6717],
         [-0.7151, -0.6717],
         [-0.7151, -0.6717],
         [-0.7151, -0.6717],
         [-0.7151, -0.6717],
         [-0.7151, -0.6717],
         [-0.7151, -0.6717],
         [-0.7151, -0.6717]],
        [[-0.7090, -0.6775],
         [-0.7090, -0.6775],
         [-0.7090, -0.6775],
         [-0.7090, -0.6775],
         [-0.7090, -0.6775],
         [-0.7090, -0.6775],
         [-0.7090, -0.6775],
         [-0.7090, -0.6775],
         [-0.7090, -0.6775],
         [-0.7090, -0.6775]],
        [[-0.7180, -0.6689],
         [-0.7180, -0.6689],
         [-0.7180, -0.6689],
         [-0.7180, -0.6689],
         [-0.7180, -0.6689],
         [-0.7180, -0.6689],
         [-0.7180, -0.6689],
         [-0.7180, -0.6689],
         [-0.7180, -0.6689],
         [-0.7180, -0.6689]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7093, -0.6773],
         [-0.7093, -0.6773],
         [-0.7093, -0.6773],
         [-0.7093, -0.6773],
         [-0.7093, -0.6773],
         [-0.7093, -0.6773],
         [-0.7093, -0.6773],
         [-0.7093, -0.6773],
         [-0.7093, -0.6773],
         [-0.7093, -0.6773]],
        [[-0.7186, -0.6684],
         [-0.7186, -0.6684],
         [-0.7186, -0.6684],
         [-0.7186, -0.6684],
         [-0.7186, -0.6684],
         [-0.7186, -0.6684],
         [-0.7186, -0.6684],
         [-0.7186, -0.6684],
         [-0.7186, -0.6684],
         [-0.7186, -0.6684]],
        [[-0.7137, -0.6730],
         [-0.7137, -0.6730],
         [-0.7137, -0.6730],
         [-0.7137, -0.6730],
         [-0.7137, -0.6730],
         [-0.7137, -0.6730],
         [-0.7137, -0.6730],
         [-0.7137, -0.6730],
         [-0.7137, -0.6730],
         [-0.7137, -0.6730]],
        [[-0.7165, -0.6703],
         [-0.7165, -0.6703],
         [-0.7165, -0.6703],
         [-0.7165, -0.6703],
         [-0.7165, -0.6703],
         [-0.7165, -0.6703],
         [-0.7165, -0.6703],
         [-0.7165, -0.6703],
         [-0.7165, -0.6703],
         [-0.7165, -0.6703]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7116, -0.6751],
         [-0.7116, -0.6751],
         [-0.7116, -0.6751],
         [-0.7116, -0.6751],
         [-0.7116, -0.6751],
         [-0.7116, -0.6751],
         [-0.7116, -0.6751],
         [-0.7116, -0.6751],
         [-0.7116, -0.6751],
         [-0.7116, -0.6751]],
        [[-0.7207, -0.6663],
         [-0.7207, -0.6663],
         [-0.7207, -0.6663],
         [-0.7207, -0.6663],
         [-0.7207, -0.6663],
         [-0.7207, -0.6663],
         [-0.7207, -0.6663],
         [-0.7207, -0.6663],
         [-0.7207, -0.6663],
         [-0.7207, -0.6663]],
        [[-0.7107, -0.6759],
         [-0.7107, -0.6759],
         [-0.7107, -0.6759],
         [-0.7107, -0.6759],
         [-0.7107, -0.6759],
         [-0.7107, -0.6759],
         [-0.7107, -0.6759],
         [-0.7107, -0.6759],
         [-0.7107, -0.6759],
         [-0.7107, -0.6759]],
        [[-0.7246, -0.6626],
         [-0.7246, -0.6626],
         [-0.7246, -0.6626],
         [-0.7246, -0.6626],
         [-0.7246, -0.6626],
         [-0.7246, -0.6626],
         [-0.7246, -0.6626],
         [-0.7246, -0.6626],
         [-0.7246, -0.6626],
         [-0.7246, -0.6626]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7219, -0.6652],
         [-0.7219, -0.6652],
         [-0.7219, -0.6652],
         [-0.7219, -0.6652],
         [-0.7219, -0.6652],
         [-0.7219, -0.6652],
         [-0.7219, -0.6652],
         [-0.7219, -0.6652],
         [-0.7219, -0.6652],
         [-0.7219, -0.6652]],
        [[-0.7266, -0.6608],
         [-0.7266, -0.6608],
         [-0.7266, -0.6608],
         [-0.7266, -0.6608],
         [-0.7266, -0.6608],
         [-0.7266, -0.6608],
         [-0.7266, -0.6608],
         [-0.7266, -0.6608],
         [-0.7266, -0.6608],
         [-0.7266, -0.6608]],
        [[-0.7191, -0.6679],
         [-0.7191, -0.6679],
         [-0.7191, -0.6679],
         [-0.7191, -0.6679],
         [-0.7191, -0.6679],
         [-0.7191, -0.6679],
         [-0.7191, -0.6679],
         [-0.7191, -0.6679],
         [-0.7191, -0.6679],
         [-0.7191, -0.6679]],
        [[-0.7258, -0.6615],
         [-0.7258, -0.6615],
         [-0.7258, -0.6615],
         [-0.7258, -0.6615],
         [-0.7258, -0.6615],
         [-0.7258, -0.6615],
         [-0.7258, -0.6615],
         [-0.7258, -0.6615],
         [-0.7258, -0.6615],
         [-0.7258, -0.6615]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7230, -0.6642],
         [-0.7230, -0.6642],
         [-0.7230, -0.6642],
         [-0.7230, -0.6642],
         [-0.7230, -0.6642],
         [-0.7230, -0.6642],
         [-0.7230, -0.6642],
         [-0.7230, -0.6642],
         [-0.7230, -0.6642],
         [-0.7230, -0.6642]],
        [[-0.7239, -0.6633],
         [-0.7239, -0.6633],
         [-0.7239, -0.6633],
         [-0.7239, -0.6633],
         [-0.7239, -0.6633],
         [-0.7239, -0.6633],
         [-0.7239, -0.6633],
         [-0.7239, -0.6633],
         [-0.7239, -0.6633],
         [-0.7239, -0.6633]],
        [[-0.7156, -0.6712],
         [-0.7156, -0.6712],
         [-0.7156, -0.6712],
         [-0.7156, -0.6712],
         [-0.7156, -0.6712],
         [-0.7156, -0.6712],
         [-0.7156, -0.6712],
         [-0.7156, -0.6712],
         [-0.7156, -0.6712],
         [-0.7156, -0.6712]],
        [[-0.7250, -0.6623],
         [-0.7250, -0.6623],
         [-0.7250, -0.6623],
         [-0.7250, -0.6623],
         [-0.7250, -0.6623],
         [-0.7250, -0.6623],
         [-0.7250, -0.6623],
         [-0.7250, -0.6623],
         [-0.7250, -0.6623],
         [-0.7250, -0.6623]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7139, -0.6728],
         [-0.7139, -0.6728],
         [-0.7139, -0.6728],
         [-0.7139, -0.6728],
         [-0.7139, -0.6728],
         [-0.7139, -0.6728],
         [-0.7139, -0.6728],
         [-0.7139, -0.6728],
         [-0.7139, -0.6728],
         [-0.7139, -0.6728]],
        [[-0.7251, -0.6622],
         [-0.7251, -0.6622],
         [-0.7251, -0.6622],
         [-0.7251, -0.6622],
         [-0.7251, -0.6622],
         [-0.7251, -0.6622],
         [-0.7251, -0.6622],
         [-0.7251, -0.6622],
         [-0.7251, -0.6622],
         [-0.7251, -0.6622]],
        [[-0.7150, -0.6717],
         [-0.7150, -0.6717],
         [-0.7150, -0.6717],
         [-0.7150, -0.6717],
         [-0.7150, -0.6717],
         [-0.7150, -0.6717],
         [-0.7150, -0.6717],
         [-0.7150, -0.6717],
         [-0.7150, -0.6717],
         [-0.7150, -0.6717]],
        [[-0.7339, -0.6540],
         [-0.7339, -0.6540],
         [-0.7339, -0.6540],
         [-0.7339, -0.6540],
         [-0.7339, -0.6540],
         [-0.7339, -0.6540],
         [-0.7339, -0.6540],
         [-0.7339, -0.6540],
         [-0.7339, -0.6540],
         [-0.7339, -0.6540]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7187, -0.6682],
         [-0.7187, -0.6682],
         [-0.7187, -0.6682],
         [-0.7187, -0.6682],
         [-0.7187, -0.6682],
         [-0.7187, -0.6682],
         [-0.7187, -0.6682],
         [-0.7187, -0.6682],
         [-0.7187, -0.6682],
         [-0.7187, -0.6682]],
        [[-0.7245, -0.6627],
         [-0.7245, -0.6627],
         [-0.7245, -0.6627],
         [-0.7245, -0.6627],
         [-0.7245, -0.6627],
         [-0.7245, -0.6627],
         [-0.7245, -0.6627],
         [-0.7245, -0.6627],
         [-0.7245, -0.6627],
         [-0.7245, -0.6627]],
        [[-0.7212, -0.6659],
         [-0.7212, -0.6659],
         [-0.7212, -0.6659],
         [-0.7212, -0.6659],
         [-0.7212, -0.6659],
         [-0.7212, -0.6659],
         [-0.7212, -0.6659],
         [-0.7212, -0.6659],
         [-0.7212, -0.6659],
         [-0.7212, -0.6659]],
        [[-0.7215, -0.6655],
         [-0.7215, -0.6655],
         [-0.7215, -0.6655],
         [-0.7215, -0.6655],
         [-0.7215, -0.6655],
         [-0.7215, -0.6655],
         [-0.7215, -0.6655],
         [-0.7215, -0.6655],
         [-0.7215, -0.6655],
         [-0.7215, -0.6655]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7147, -0.6720],
         [-0.7147, -0.6720],
         [-0.7147, -0.6720],
         [-0.7147, -0.6720],
         [-0.7147, -0.6720],
         [-0.7147, -0.6720],
         [-0.7147, -0.6720],
         [-0.7147, -0.6720],
         [-0.7147, -0.6720],
         [-0.7147, -0.6720]],
        [[-0.7330, -0.6548],
         [-0.7330, -0.6548],
         [-0.7330, -0.6548],
         [-0.7330, -0.6548],
         [-0.7330, -0.6548],
         [-0.7330, -0.6548],
         [-0.7330, -0.6548],
         [-0.7330, -0.6548],
         [-0.7330, -0.6548],
         [-0.7330, -0.6548]],
        [[-0.7109, -0.6757],
         [-0.7109, -0.6757],
         [-0.7109, -0.6757],
         [-0.7109, -0.6757],
         [-0.7109, -0.6757],
         [-0.7109, -0.6757],
         [-0.7109, -0.6757],
         [-0.7109, -0.6757],
         [-0.7109, -0.6757],
         [-0.7109, -0.6757]],
        [[-0.7226, -0.6646],
         [-0.7226, -0.6646],
         [-0.7226, -0.6646],
         [-0.7226, -0.6646],
         [-0.7226, -0.6646],
         [-0.7226, -0.6646],
         [-0.7226, -0.6646],
         [-0.7226, -0.6646],
         [-0.7226, -0.6646],
         [-0.7226, -0.6646]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7127, -0.6739],
         [-0.7127, -0.6739],
         [-0.7127, -0.6739],
         [-0.7127, -0.6739],
         [-0.7127, -0.6739],
         [-0.7127, -0.6739],
         [-0.7127, -0.6739],
         [-0.7127, -0.6739],
         [-0.7127, -0.6739],
         [-0.7127, -0.6739]],
        [[-0.7240, -0.6632],
         [-0.7240, -0.6632],
         [-0.7240, -0.6632],
         [-0.7240, -0.6632],
         [-0.7240, -0.6632],
         [-0.7240, -0.6632],
         [-0.7240, -0.6632],
         [-0.7240, -0.6632],
         [-0.7240, -0.6632],
         [-0.7240, -0.6632]],
        [[-0.7158, -0.6710],
         [-0.7158, -0.6710],
         [-0.7158, -0.6710],
         [-0.7158, -0.6710],
         [-0.7158, -0.6710],
         [-0.7158, -0.6710],
         [-0.7158, -0.6710],
         [-0.7158, -0.6710],
         [-0.7158, -0.6710],
         [-0.7158, -0.6710]],
        [[-0.7213, -0.6657],
         [-0.7213, -0.6657],
         [-0.7213, -0.6657],
         [-0.7213, -0.6657],
         [-0.7213, -0.6657],
         [-0.7213, -0.6657],
         [-0.7213, -0.6657],
         [-0.7213, -0.6657],
         [-0.7213, -0.6657],
         [-0.7213, -0.6657]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7172, -0.6697],
         [-0.7172, -0.6697],
         [-0.7172, -0.6697],
         [-0.7172, -0.6697],
         [-0.7172, -0.6697],
         [-0.7172, -0.6697],
         [-0.7172, -0.6697],
         [-0.7172, -0.6697],
         [-0.7172, -0.6697],
         [-0.7172, -0.6697]],
        [[-0.7273, -0.6601],
         [-0.7273, -0.6601],
         [-0.7273, -0.6601],
         [-0.7273, -0.6601],
         [-0.7273, -0.6601],
         [-0.7273, -0.6601],
         [-0.7273, -0.6601],
         [-0.7273, -0.6601],
         [-0.7273, -0.6601],
         [-0.7273, -0.6601]],
        [[-0.7156, -0.6712],
         [-0.7156, -0.6712],
         [-0.7156, -0.6712],
         [-0.7156, -0.6712],
         [-0.7156, -0.6712],
         [-0.7156, -0.6712],
         [-0.7156, -0.6712],
         [-0.7156, -0.6712],
         [-0.7156, -0.6712],
         [-0.7156, -0.6712]],
        [[-0.7193, -0.6677],
         [-0.7193, -0.6677],
         [-0.7193, -0.6677],
         [-0.7193, -0.6677],
         [-0.7193, -0.6677],
         [-0.7193, -0.6677],
         [-0.7193, -0.6677],
         [-0.7193, -0.6677],
         [-0.7193, -0.6677],
         [-0.7193, -0.6677]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7128, -0.6739],
         [-0.7128, -0.6739],
         [-0.7128, -0.6739],
         [-0.7128, -0.6739],
         [-0.7128, -0.6739],
         [-0.7128, -0.6739],
         [-0.7128, -0.6739],
         [-0.7128, -0.6739],
         [-0.7128, -0.6739],
         [-0.7128, -0.6739]],
        [[-0.7242, -0.6630],
         [-0.7242, -0.6630],
         [-0.7242, -0.6630],
         [-0.7242, -0.6630],
         [-0.7242, -0.6630],
         [-0.7242, -0.6630],
         [-0.7242, -0.6630],
         [-0.7242, -0.6630],
         [-0.7242, -0.6630],
         [-0.7242, -0.6630]],
        [[-0.7161, -0.6707],
         [-0.7161, -0.6707],
         [-0.7161, -0.6707],
         [-0.7161, -0.6707],
         [-0.7161, -0.6707],
         [-0.7161, -0.6707],
         [-0.7161, -0.6707],
         [-0.7161, -0.6707],
         [-0.7161, -0.6707],
         [-0.7161, -0.6707]],
        [[-0.7221, -0.6650],
         [-0.7221, -0.6650],
         [-0.7221, -0.6650],
         [-0.7221, -0.6650],
         [-0.7221, -0.6650],
         [-0.7221, -0.6650],
         [-0.7221, -0.6650],
         [-0.7221, -0.6650],
         [-0.7221, -0.6650],
         [-0.7221, -0.6650]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7044, -0.6820],
         [-0.7044, -0.6820],
         [-0.7044, -0.6820],
         [-0.7044, -0.6820],
         [-0.7044, -0.6820],
         [-0.7044, -0.6820],
         [-0.7044, -0.6820],
         [-0.7044, -0.6820],
         [-0.7044, -0.6820],
         [-0.7044, -0.6820]],
        [[-0.7132, -0.6735],
         [-0.7132, -0.6735],
         [-0.7132, -0.6735],
         [-0.7132, -0.6735],
         [-0.7132, -0.6735],
         [-0.7132, -0.6735],
         [-0.7132, -0.6735],
         [-0.7132, -0.6735],
         [-0.7132, -0.6735],
         [-0.7132, -0.6735]],
        [[-0.7105, -0.6761],
         [-0.7105, -0.6761],
         [-0.7105, -0.6761],
         [-0.7105, -0.6761],
         [-0.7105, -0.6761],
         [-0.7105, -0.6761],
         [-0.7105, -0.6761],
         [-0.7105, -0.6761],
         [-0.7105, -0.6761],
         [-0.7105, -0.6761]],
        [[-0.7257, -0.6616],
         [-0.7257, -0.6616],
         [-0.7257, -0.6616],
         [-0.7257, -0.6616],
         [-0.7257, -0.6616],
         [-0.7257, -0.6616],
         [-0.7257, -0.6616],
         [-0.7257, -0.6616],
         [-0.7257, -0.6616],
         [-0.7257, -0.6616]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6962, -0.6901],
         [-0.6962, -0.6901],
         [-0.6962, -0.6901],
         [-0.6962, -0.6901],
         [-0.6962, -0.6901],
         [-0.6962, -0.6901],
         [-0.6962, -0.6901],
         [-0.6962, -0.6901],
         [-0.6962, -0.6901],
         [-0.6962, -0.6901]],
        [[-0.7141, -0.6726],
         [-0.7141, -0.6726],
         [-0.7141, -0.6726],
         [-0.7141, -0.6726],
         [-0.7141, -0.6726],
         [-0.7141, -0.6726],
         [-0.7141, -0.6726],
         [-0.7141, -0.6726],
         [-0.7141, -0.6726],
         [-0.7141, -0.6726]],
        [[-0.7046, -0.6818],
         [-0.7046, -0.6818],
         [-0.7046, -0.6818],
         [-0.7046, -0.6818],
         [-0.7046, -0.6818],
         [-0.7046, -0.6818],
         [-0.7046, -0.6818],
         [-0.7046, -0.6818],
         [-0.7046, -0.6818],
         [-0.7046, -0.6818]],
        [[-0.7198, -0.6672],
         [-0.7198, -0.6672],
         [-0.7198, -0.6672],
         [-0.7198, -0.6672],
         [-0.7198, -0.6672],
         [-0.7198, -0.6672],
         [-0.7198, -0.6672],
         [-0.7198, -0.6672],
         [-0.7198, -0.6672],
         [-0.7198, -0.6672]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6999, -0.6864],
         [-0.6999, -0.6864],
         [-0.6999, -0.6864],
         [-0.6999, -0.6864],
         [-0.6999, -0.6864],
         [-0.6999, -0.6864],
         [-0.6999, -0.6864],
         [-0.6999, -0.6864],
         [-0.6999, -0.6864],
         [-0.6999, -0.6864]],
        [[-0.7252, -0.6621],
         [-0.7252, -0.6621],
         [-0.7252, -0.6621],
         [-0.7252, -0.6621],
         [-0.7252, -0.6621],
         [-0.7252, -0.6621],
         [-0.7252, -0.6621],
         [-0.7252, -0.6621],
         [-0.7252, -0.6621],
         [-0.7252, -0.6621]],
        [[-0.7026, -0.6838],
         [-0.7026, -0.6838],
         [-0.7026, -0.6838],
         [-0.7026, -0.6838],
         [-0.7026, -0.6838],
         [-0.7026, -0.6838],
         [-0.7026, -0.6838],
         [-0.7026, -0.6838],
         [-0.7026, -0.6838],
         [-0.7026, -0.6838]],
        [[-0.7054, -0.6810],
         [-0.7054, -0.6810],
         [-0.7054, -0.6810],
         [-0.7054, -0.6810],
         [-0.7054, -0.6810],
         [-0.7054, -0.6810],
         [-0.7054, -0.6810],
         [-0.7054, -0.6810],
         [-0.7054, -0.6810],
         [-0.7054, -0.6810]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6957, -0.6906],
         [-0.6957, -0.6906],
         [-0.6957, -0.6906],
         [-0.6957, -0.6906],
         [-0.6957, -0.6906],
         [-0.6957, -0.6906],
         [-0.6957, -0.6906],
         [-0.6957, -0.6906],
         [-0.6957, -0.6906],
         [-0.6957, -0.6906]],
        [[-0.7136, -0.6731],
         [-0.7136, -0.6731],
         [-0.7136, -0.6731],
         [-0.7136, -0.6731],
         [-0.7136, -0.6731],
         [-0.7136, -0.6731],
         [-0.7136, -0.6731],
         [-0.7136, -0.6731],
         [-0.7136, -0.6731],
         [-0.7136, -0.6731]],
        [[-0.6927, -0.6936],
         [-0.6927, -0.6936],
         [-0.6927, -0.6936],
         [-0.6927, -0.6936],
         [-0.6927, -0.6936],
         [-0.6927, -0.6936],
         [-0.6927, -0.6936],
         [-0.6927, -0.6936],
         [-0.6927, -0.6936],
         [-0.6927, -0.6936]],
        [[-0.7083, -0.6782],
         [-0.7083, -0.6782],
         [-0.7083, -0.6782],
         [-0.7083, -0.6782],
         [-0.7083, -0.6782],
         [-0.7083, -0.6782],
         [-0.7083, -0.6782],
         [-0.7083, -0.6782],
         [-0.7083, -0.6782],
         [-0.7083, -0.6782]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6926, -0.6937],
         [-0.6926, -0.6937],
         [-0.6926, -0.6937],
         [-0.6926, -0.6937],
         [-0.6926, -0.6937],
         [-0.6926, -0.6937],
         [-0.6926, -0.6937],
         [-0.6926, -0.6937],
         [-0.6926, -0.6937],
         [-0.6926, -0.6937]],
        [[-0.6993, -0.6870],
         [-0.6993, -0.6870],
         [-0.6993, -0.6870],
         [-0.6993, -0.6870],
         [-0.6993, -0.6870],
         [-0.6993, -0.6870],
         [-0.6993, -0.6870],
         [-0.6993, -0.6870],
         [-0.6993, -0.6870],
         [-0.6993, -0.6870]],
        [[-0.6873, -0.6990],
         [-0.6873, -0.6990],
         [-0.6873, -0.6990],
         [-0.6873, -0.6990],
         [-0.6873, -0.6990],
         [-0.6873, -0.6990],
         [-0.6873, -0.6990],
         [-0.6873, -0.6990],
         [-0.6873, -0.6990],
         [-0.6873, -0.6990]],
        [[-0.6909, -0.6954],
         [-0.6909, -0.6954],
         [-0.6909, -0.6954],
         [-0.6909, -0.6954],
         [-0.6909, -0.6954],
         [-0.6909, -0.6954],
         [-0.6909, -0.6954],
         [-0.6909, -0.6954],
         [-0.6909, -0.6954],
         [-0.6909, -0.6954]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6947, -0.6916],
         [-0.6947, -0.6916],
         [-0.6947, -0.6916],
         [-0.6947, -0.6916],
         [-0.6947, -0.6916],
         [-0.6947, -0.6916],
         [-0.6947, -0.6916],
         [-0.6947, -0.6916],
         [-0.6947, -0.6916],
         [-0.6947, -0.6916]],
        [[-0.7070, -0.6795],
         [-0.7070, -0.6795],
         [-0.7070, -0.6795],
         [-0.7070, -0.6795],
         [-0.7070, -0.6795],
         [-0.7070, -0.6795],
         [-0.7070, -0.6795],
         [-0.7070, -0.6795],
         [-0.7070, -0.6795],
         [-0.7070, -0.6795]],
        [[-0.6855, -0.7008],
         [-0.6855, -0.7008],
         [-0.6855, -0.7008],
         [-0.6855, -0.7008],
         [-0.6855, -0.7008],
         [-0.6855, -0.7008],
         [-0.6855, -0.7008],
         [-0.6855, -0.7008],
         [-0.6855, -0.7008],
         [-0.6855, -0.7008]],
        [[-0.7040, -0.6825],
         [-0.7040, -0.6825],
         [-0.7040, -0.6825],
         [-0.7040, -0.6825],
         [-0.7040, -0.6825],
         [-0.7040, -0.6825],
         [-0.7040, -0.6825],
         [-0.7040, -0.6825],
         [-0.7040, -0.6825],
         [-0.7040, -0.6825]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6796, -0.7069],
         [-0.6796, -0.7069],
         [-0.6796, -0.7069],
         [-0.6796, -0.7069],
         [-0.6796, -0.7069],
         [-0.6796, -0.7069],
         [-0.6796, -0.7069],
         [-0.6796, -0.7069],
         [-0.6796, -0.7069],
         [-0.6796, -0.7069]],
        [[-0.6831, -0.7033],
         [-0.6831, -0.7033],
         [-0.6831, -0.7033],
         [-0.6831, -0.7033],
         [-0.6831, -0.7033],
         [-0.6831, -0.7033],
         [-0.6831, -0.7033],
         [-0.6831, -0.7033],
         [-0.6831, -0.7033],
         [-0.6831, -0.7033]],
        [[-0.6694, -0.7175],
         [-0.6694, -0.7175],
         [-0.6694, -0.7175],
         [-0.6694, -0.7175],
         [-0.6694, -0.7175],
         [-0.6694, -0.7175],
         [-0.6694, -0.7175],
         [-0.6694, -0.7175],
         [-0.6694, -0.7175],
         [-0.6694, -0.7175]],
        [[-0.6978, -0.6885],
         [-0.6978, -0.6885],
         [-0.6978, -0.6885],
         [-0.6978, -0.6885],
         [-0.6978, -0.6885],
         [-0.6978, -0.6885],
         [-0.6978, -0.6885],
         [-0.6978, -0.6885],
         [-0.6978, -0.6885],
         [-0.6978, -0.6885]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6561, -0.7317],
         [-0.6561, -0.7317],
         [-0.6561, -0.7317],
         [-0.6561, -0.7317],
         [-0.6561, -0.7317],
         [-0.6561, -0.7317],
         [-0.6561, -0.7317],
         [-0.6561, -0.7317],
         [-0.6561, -0.7317],
         [-0.6561, -0.7317]],
        [[-0.6828, -0.7036],
         [-0.6828, -0.7036],
         [-0.6828, -0.7036],
         [-0.6828, -0.7036],
         [-0.6828, -0.7036],
         [-0.6828, -0.7036],
         [-0.6828, -0.7036],
         [-0.6828, -0.7036],
         [-0.6828, -0.7036],
         [-0.6828, -0.7036]],
        [[-0.6757, -0.7109],
         [-0.6757, -0.7109],
         [-0.6757, -0.7109],
         [-0.6757, -0.7109],
         [-0.6757, -0.7109],
         [-0.6757, -0.7109],
         [-0.6757, -0.7109],
         [-0.6757, -0.7109],
         [-0.6757, -0.7109],
         [-0.6757, -0.7109]],
        [[-0.6703, -0.7165],
         [-0.6703, -0.7165],
         [-0.6703, -0.7165],
         [-0.6703, -0.7165],
         [-0.6703, -0.7165],
         [-0.6703, -0.7165],
         [-0.6703, -0.7165],
         [-0.6703, -0.7165],
         [-0.6703, -0.7165],
         [-0.6703, -0.7165]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6611, -0.7262],
         [-0.6611, -0.7262],
         [-0.6611, -0.7262],
         [-0.6611, -0.7262],
         [-0.6611, -0.7262],
         [-0.6611, -0.7262],
         [-0.6611, -0.7262],
         [-0.6611, -0.7262],
         [-0.6611, -0.7262],
         [-0.6611, -0.7262]],
        [[-0.6730, -0.7137],
         [-0.6730, -0.7137],
         [-0.6730, -0.7137],
         [-0.6730, -0.7137],
         [-0.6730, -0.7137],
         [-0.6730, -0.7137],
         [-0.6730, -0.7137],
         [-0.6730, -0.7137],
         [-0.6730, -0.7137],
         [-0.6730, -0.7137]],
        [[-0.6536, -0.7343],
         [-0.6536, -0.7343],
         [-0.6536, -0.7343],
         [-0.6536, -0.7343],
         [-0.6536, -0.7343],
         [-0.6536, -0.7343],
         [-0.6536, -0.7343],
         [-0.6536, -0.7343],
         [-0.6536, -0.7343],
         [-0.6536, -0.7343]],
        [[-0.6689, -0.7180],
         [-0.6689, -0.7180],
         [-0.6689, -0.7180],
         [-0.6689, -0.7180],
         [-0.6689, -0.7180],
         [-0.6689, -0.7180],
         [-0.6689, -0.7180],
         [-0.6689, -0.7180],
         [-0.6689, -0.7180],
         [-0.6689, -0.7180]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6516, -0.7365],
         [-0.6516, -0.7365],
         [-0.6516, -0.7365],
         [-0.6516, -0.7365],
         [-0.6516, -0.7365],
         [-0.6516, -0.7365],
         [-0.6516, -0.7365],
         [-0.6516, -0.7365],
         [-0.6516, -0.7365],
         [-0.6516, -0.7365]],
        [[-0.6857, -0.7006],
         [-0.6857, -0.7006],
         [-0.6857, -0.7006],
         [-0.6857, -0.7006],
         [-0.6857, -0.7006],
         [-0.6857, -0.7006],
         [-0.6857, -0.7006],
         [-0.6857, -0.7006],
         [-0.6857, -0.7006],
         [-0.6857, -0.7006]],
        [[-0.6454, -0.7433],
         [-0.6454, -0.7433],
         [-0.6454, -0.7433],
         [-0.6454, -0.7433],
         [-0.6454, -0.7433],
         [-0.6454, -0.7433],
         [-0.6454, -0.7433],
         [-0.6454, -0.7433],
         [-0.6454, -0.7433],
         [-0.6454, -0.7433]],
        [[-0.6672, -0.7198],
         [-0.6672, -0.7198],
         [-0.6672, -0.7198],
         [-0.6672, -0.7198],
         [-0.6672, -0.7198],
         [-0.6672, -0.7198],
         [-0.6672, -0.7198],
         [-0.6672, -0.7198],
         [-0.6672, -0.7198],
         [-0.6672, -0.7198]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6572, -0.7305],
         [-0.6572, -0.7305],
         [-0.6572, -0.7305],
         [-0.6572, -0.7305],
         [-0.6572, -0.7305],
         [-0.6572, -0.7305],
         [-0.6572, -0.7305],
         [-0.6572, -0.7305],
         [-0.6572, -0.7305],
         [-0.6572, -0.7305]],
        [[-0.6528, -0.7352],
         [-0.6528, -0.7352],
         [-0.6528, -0.7352],
         [-0.6528, -0.7352],
         [-0.6528, -0.7352],
         [-0.6528, -0.7352],
         [-0.6528, -0.7352],
         [-0.6528, -0.7352],
         [-0.6528, -0.7352],
         [-0.6528, -0.7352]],
        [[-0.6431, -0.7458],
         [-0.6431, -0.7458],
         [-0.6431, -0.7458],
         [-0.6431, -0.7458],
         [-0.6431, -0.7458],
         [-0.6431, -0.7458],
         [-0.6431, -0.7458],
         [-0.6431, -0.7458],
         [-0.6431, -0.7458],
         [-0.6431, -0.7458]],
        [[-0.6620, -0.7253],
         [-0.6620, -0.7253],
         [-0.6620, -0.7253],
         [-0.6620, -0.7253],
         [-0.6620, -0.7253],
         [-0.6620, -0.7253],
         [-0.6620, -0.7253],
         [-0.6620, -0.7253],
         [-0.6620, -0.7253],
         [-0.6620, -0.7253]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6458, -0.7428],
         [-0.6458, -0.7428],
         [-0.6458, -0.7428],
         [-0.6458, -0.7428],
         [-0.6458, -0.7428],
         [-0.6458, -0.7428],
         [-0.6458, -0.7428],
         [-0.6458, -0.7428],
         [-0.6458, -0.7428],
         [-0.6458, -0.7428]],
        [[-0.6453, -0.7434],
         [-0.6453, -0.7434],
         [-0.6453, -0.7434],
         [-0.6453, -0.7434],
         [-0.6453, -0.7434],
         [-0.6453, -0.7434],
         [-0.6453, -0.7434],
         [-0.6453, -0.7434],
         [-0.6453, -0.7434],
         [-0.6453, -0.7434]],
        [[-0.6345, -0.7555],
         [-0.6345, -0.7555],
         [-0.6345, -0.7555],
         [-0.6345, -0.7555],
         [-0.6345, -0.7555],
         [-0.6345, -0.7555],
         [-0.6345, -0.7555],
         [-0.6345, -0.7555],
         [-0.6345, -0.7555],
         [-0.6345, -0.7555]],
        [[-0.6447, -0.7441],
         [-0.6447, -0.7441],
         [-0.6447, -0.7441],
         [-0.6447, -0.7441],
         [-0.6447, -0.7441],
         [-0.6447, -0.7441],
         [-0.6447, -0.7441],
         [-0.6447, -0.7441],
         [-0.6447, -0.7441],
         [-0.6447, -0.7441]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6407, -0.7485],
         [-0.6407, -0.7485],
         [-0.6407, -0.7485],
         [-0.6407, -0.7485],
         [-0.6407, -0.7485],
         [-0.6407, -0.7485],
         [-0.6407, -0.7485],
         [-0.6407, -0.7485],
         [-0.6407, -0.7485],
         [-0.6407, -0.7485]],
        [[-0.6351, -0.7547],
         [-0.6351, -0.7547],
         [-0.6351, -0.7547],
         [-0.6351, -0.7547],
         [-0.6351, -0.7547],
         [-0.6351, -0.7547],
         [-0.6351, -0.7547],
         [-0.6351, -0.7547],
         [-0.6351, -0.7547],
         [-0.6351, -0.7547]],
        [[-0.6205, -0.7715],
         [-0.6205, -0.7715],
         [-0.6205, -0.7715],
         [-0.6205, -0.7715],
         [-0.6205, -0.7715],
         [-0.6205, -0.7715],
         [-0.6205, -0.7715],
         [-0.6205, -0.7715],
         [-0.6205, -0.7715],
         [-0.6205, -0.7715]],
        [[-0.6302, -0.7604],
         [-0.6302, -0.7604],
         [-0.6302, -0.7604],
         [-0.6302, -0.7604],
         [-0.6302, -0.7604],
         [-0.6302, -0.7604],
         [-0.6302, -0.7604],
         [-0.6302, -0.7604],
         [-0.6302, -0.7604],
         [-0.6302, -0.7604]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6318, -0.7585],
         [-0.6318, -0.7585],
         [-0.6318, -0.7585],
         [-0.6318, -0.7585],
         [-0.6318, -0.7585],
         [-0.6318, -0.7585],
         [-0.6318, -0.7585],
         [-0.6318, -0.7585],
         [-0.6318, -0.7585],
         [-0.6318, -0.7585]],
        [[-0.6394, -0.7499],
         [-0.6394, -0.7499],
         [-0.6394, -0.7499],
         [-0.6394, -0.7499],
         [-0.6394, -0.7499],
         [-0.6394, -0.7499],
         [-0.6394, -0.7499],
         [-0.6394, -0.7499],
         [-0.6394, -0.7499],
         [-0.6394, -0.7499]],
        [[-0.6336, -0.7564],
         [-0.6336, -0.7564],
         [-0.6336, -0.7564],
         [-0.6336, -0.7564],
         [-0.6336, -0.7564],
         [-0.6336, -0.7564],
         [-0.6336, -0.7564],
         [-0.6336, -0.7564],
         [-0.6336, -0.7564],
         [-0.6336, -0.7564]],
        [[-0.6348, -0.7551],
         [-0.6348, -0.7551],
         [-0.6348, -0.7551],
         [-0.6348, -0.7551],
         [-0.6348, -0.7551],
         [-0.6348, -0.7551],
         [-0.6348, -0.7551],
         [-0.6348, -0.7551],
         [-0.6348, -0.7551],
         [-0.6348, -0.7551]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6339, -0.7562],
         [-0.6339, -0.7562],
         [-0.6339, -0.7562],
         [-0.6339, -0.7562],
         [-0.6339, -0.7562],
         [-0.6339, -0.7562],
         [-0.6339, -0.7562],
         [-0.6339, -0.7562],
         [-0.6339, -0.7562],
         [-0.6339, -0.7562]],
        [[-0.6378, -0.7518],
         [-0.6378, -0.7518],
         [-0.6378, -0.7518],
         [-0.6378, -0.7518],
         [-0.6378, -0.7518],
         [-0.6378, -0.7518],
         [-0.6378, -0.7518],
         [-0.6378, -0.7518],
         [-0.6378, -0.7518],
         [-0.6378, -0.7518]],
        [[-0.6190, -0.7732],
         [-0.6190, -0.7732],
         [-0.6190, -0.7732],
         [-0.6190, -0.7732],
         [-0.6190, -0.7732],
         [-0.6190, -0.7732],
         [-0.6190, -0.7732],
         [-0.6190, -0.7732],
         [-0.6190, -0.7732],
         [-0.6190, -0.7732]],
        [[-0.6695, -0.7174],
         [-0.6695, -0.7174],
         [-0.6695, -0.7174],
         [-0.6695, -0.7174],
         [-0.6695, -0.7174],
         [-0.6695, -0.7174],
         [-0.6695, -0.7174],
         [-0.6695, -0.7174],
         [-0.6695, -0.7174],
         [-0.6695, -0.7174]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6304, -0.7601],
         [-0.6304, -0.7601],
         [-0.6304, -0.7601],
         [-0.6304, -0.7601],
         [-0.6304, -0.7601],
         [-0.6304, -0.7601],
         [-0.6304, -0.7601],
         [-0.6304, -0.7601],
         [-0.6304, -0.7601],
         [-0.6304, -0.7601]],
        [[-0.6219, -0.7699],
         [-0.6219, -0.7699],
         [-0.6219, -0.7699],
         [-0.6219, -0.7699],
         [-0.6219, -0.7699],
         [-0.6219, -0.7699],
         [-0.6219, -0.7699],
         [-0.6219, -0.7699],
         [-0.6219, -0.7699],
         [-0.6219, -0.7699]],
        [[-0.6129, -0.7803],
         [-0.6129, -0.7803],
         [-0.6129, -0.7803],
         [-0.6129, -0.7803],
         [-0.6129, -0.7803],
         [-0.6129, -0.7803],
         [-0.6129, -0.7803],
         [-0.6129, -0.7803],
         [-0.6129, -0.7803],
         [-0.6129, -0.7803]],
        [[-0.6232, -0.7684],
         [-0.6232, -0.7684],
         [-0.6232, -0.7684],
         [-0.6232, -0.7684],
         [-0.6232, -0.7684],
         [-0.6232, -0.7684],
         [-0.6232, -0.7684],
         [-0.6232, -0.7684],
         [-0.6232, -0.7684],
         [-0.6232, -0.7684]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6302, -0.7604],
         [-0.6302, -0.7604],
         [-0.6302, -0.7604],
         [-0.6302, -0.7604],
         [-0.6302, -0.7604],
         [-0.6302, -0.7604],
         [-0.6302, -0.7604],
         [-0.6302, -0.7604],
         [-0.6302, -0.7604],
         [-0.6302, -0.7604]],
        [[-0.6162, -0.7765],
         [-0.6162, -0.7765],
         [-0.6162, -0.7765],
         [-0.6162, -0.7765],
         [-0.6162, -0.7765],
         [-0.6162, -0.7765],
         [-0.6162, -0.7765],
         [-0.6162, -0.7765],
         [-0.6162, -0.7765],
         [-0.6162, -0.7765]],
        [[-0.6189, -0.7733],
         [-0.6189, -0.7733],
         [-0.6189, -0.7733],
         [-0.6189, -0.7733],
         [-0.6189, -0.7733],
         [-0.6189, -0.7733],
         [-0.6189, -0.7733],
         [-0.6189, -0.7733],
         [-0.6189, -0.7733],
         [-0.6189, -0.7733]],
        [[-0.6195, -0.7727],
         [-0.6195, -0.7727],
         [-0.6195, -0.7727],
         [-0.6195, -0.7727],
         [-0.6195, -0.7727],
         [-0.6195, -0.7727],
         [-0.6195, -0.7727],
         [-0.6195, -0.7727],
         [-0.6195, -0.7727],
         [-0.6195, -0.7727]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6271, -0.7638],
         [-0.6271, -0.7638],
         [-0.6271, -0.7638],
         [-0.6271, -0.7638],
         [-0.6271, -0.7638],
         [-0.6271, -0.7638],
         [-0.6271, -0.7638],
         [-0.6271, -0.7638],
         [-0.6271, -0.7638],
         [-0.6271, -0.7638]],
        [[-0.6696, -0.7173],
         [-0.6696, -0.7173],
         [-0.6696, -0.7173],
         [-0.6696, -0.7173],
         [-0.6696, -0.7173],
         [-0.6696, -0.7173],
         [-0.6696, -0.7173],
         [-0.6696, -0.7173],
         [-0.6696, -0.7173],
         [-0.6696, -0.7173]],
        [[-0.6601, -0.7274],
         [-0.6601, -0.7274],
         [-0.6601, -0.7274],
         [-0.6601, -0.7274],
         [-0.6601, -0.7274],
         [-0.6601, -0.7274],
         [-0.6601, -0.7274],
         [-0.6601, -0.7274],
         [-0.6601, -0.7274],
         [-0.6601, -0.7274]],
        [[-0.6203, -0.7717],
         [-0.6203, -0.7717],
         [-0.6203, -0.7717],
         [-0.6203, -0.7717],
         [-0.6203, -0.7717],
         [-0.6203, -0.7717],
         [-0.6203, -0.7717],
         [-0.6203, -0.7717],
         [-0.6203, -0.7717],
         [-0.6203, -0.7717]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6311, -0.7593],
         [-0.6311, -0.7593],
         [-0.6311, -0.7593],
         [-0.6311, -0.7593],
         [-0.6311, -0.7593],
         [-0.6311, -0.7593],
         [-0.6311, -0.7593],
         [-0.6311, -0.7593],
         [-0.6311, -0.7593],
         [-0.6311, -0.7593]],
        [[-0.6413, -0.7478],
         [-0.6413, -0.7478],
         [-0.6413, -0.7478],
         [-0.6413, -0.7478],
         [-0.6413, -0.7478],
         [-0.6413, -0.7478],
         [-0.6413, -0.7478],

Online Simulation:   2%|▏         | 150/9306 [00:05<05:42, 26.72it/s]
         [-0.7514, -0.6381],
         [-0.7514, -0.6381],
         [-0.7514, -0.6381],
         [-0.7514, -0.6381]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6452, -0.7435],
         [-0.6452, -0.7435],
         [-0.6452, -0.7435],
         [-0.6452, -0.7435],
         [-0.6452, -0.7435],
         [-0.6452, -0.7435],
         [-0.6452, -0.7435],
         [-0.6452, -0.7435],
         [-0.6452, -0.7435],
         [-0.6452, -0.7435]],
        [[-0.7504, -0.6390],
         [-0.7504, -0.6390],
         [-0.7504, -0.6390],
         [-0.7504, -0.6390],
         [-0.7504, -0.6390],
         [-0.7504, -0.6390],
         [-0.7504, -0.6390],
         [-0.7504, -0.6390],
         [-0.7504, -0.6390],
         [-0.7504, -0.6390]],
        [[-0.7566, -0.6335],
         [-0.7566, -0.6335],
         [-0.7566, -0.6335],
         [-0.7566, -0.6335],
         [-0.7566, -0.6335],
         [-0.7566, -0.6335],
         [-0.7566, -0.6335],
         [-0.7566, -0.6335],
         [-0.7566, -0.6335],
         [-0.7566, -0.6335]],
        [[-0.7480, -0.6411],
         [-0.7480, -0.6411],
         [-0.7480, -0.6411],
         [-0.7480, -0.6411],
         [-0.7480, -0.6411],
         [-0.7480, -0.6411],
         [-0.7480, -0.6411],
         [-0.7480, -0.6411],
         [-0.7480, -0.6411],
         [-0.7480, -0.6411]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6069, -0.7875],
         [-0.6069, -0.7875],
         [-0.6069, -0.7875],
         [-0.6069, -0.7875],
         [-0.6069, -0.7875],
         [-0.6069, -0.7875],
         [-0.6069, -0.7875],
         [-0.6069, -0.7875],
         [-0.6069, -0.7875],
         [-0.6069, -0.7875]],
        [[-0.6466, -0.7419],
         [-0.6466, -0.7419],
         [-0.6466, -0.7419],
         [-0.6466, -0.7419],
         [-0.6466, -0.7419],
         [-0.6466, -0.7419],
         [-0.6466, -0.7419],
         [-0.6466, -0.7419],
         [-0.6466, -0.7419],
         [-0.6466, -0.7419]],
        [[-0.5816, -0.8188],
         [-0.5816, -0.8188],
         [-0.5816, -0.8188],
         [-0.5816, -0.8188],
         [-0.5816, -0.8188],
         [-0.5816, -0.8188],
         [-0.5816, -0.8188],
         [-0.5816, -0.8188],
         [-0.5816, -0.8188],
         [-0.5816, -0.8188]],
        [[-0.6249, -0.7664],
         [-0.6249, -0.7664],
         [-0.6249, -0.7664],
         [-0.6249, -0.7664],
         [-0.6249, -0.7664],
         [-0.6249, -0.7664],
         [-0.6249, -0.7664],
         [-0.6249, -0.7664],
         [-0.6249, -0.7664],
         [-0.6249, -0.7664]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6229, -0.7687],
         [-0.6229, -0.7687],
         [-0.6229, -0.7687],
         [-0.6229, -0.7687],
         [-0.6229, -0.7687],
         [-0.6229, -0.7687],
         [-0.6229, -0.7687],
         [-0.6229, -0.7687],
         [-0.6229, -0.7687],
         [-0.6229, -0.7687]],
        [[-0.6257, -0.7655],
         [-0.6257, -0.7655],
         [-0.6257, -0.7655],
         [-0.6257, -0.7655],
         [-0.6257, -0.7655],
         [-0.6257, -0.7655],
         [-0.6257, -0.7655],
         [-0.6257, -0.7655],
         [-0.6257, -0.7655],
         [-0.6257, -0.7655]],
        [[-0.8057, -0.5920],
         [-0.8057, -0.5920],
         [-0.8057, -0.5920],
         [-0.8057, -0.5920],
         [-0.8057, -0.5920],
         [-0.8057, -0.5920],
         [-0.8057, -0.5920],
         [-0.8057, -0.5920],
         [-0.8057, -0.5920],
         [-0.8057, -0.5920]],
        [[-0.7422, -0.6464],
         [-0.7422, -0.6464],
         [-0.7422, -0.6464],
         [-0.7422, -0.6464],
         [-0.7422, -0.6464],
         [-0.7422, -0.6464],
         [-0.7422, -0.6464],
         [-0.7422, -0.6464],
         [-0.7422, -0.6464],
         [-0.7422, -0.6464]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7439, -0.6448],
         [-0.7439, -0.6448],
         [-0.7439, -0.6448],
         [-0.7439, -0.6448],
         [-0.7439, -0.6448],
         [-0.7439, -0.6448],
         [-0.7439, -0.6448],
         [-0.7439, -0.6448],
         [-0.7439, -0.6448],
         [-0.7439, -0.6448]],
        [[-0.7891, -0.6056],
         [-0.7891, -0.6056],
         [-0.7891, -0.6056],
         [-0.7891, -0.6056],
         [-0.7891, -0.6056],
         [-0.7891, -0.6056],
         [-0.7891, -0.6056],
         [-0.7891, -0.6056],
         [-0.7891, -0.6056],
         [-0.7891, -0.6056]],
        [[-0.6462, -0.7424],
         [-0.6462, -0.7424],
         [-0.6462, -0.7424],
         [-0.6462, -0.7424],
         [-0.6462, -0.7424],
         [-0.6462, -0.7424],
         [-0.6462, -0.7424],
         [-0.6462, -0.7424],
         [-0.6462, -0.7424],
         [-0.6462, -0.7424]],
        [[-0.6549, -0.7329],
         [-0.6549, -0.7329],
         [-0.6549, -0.7329],
         [-0.6549, -0.7329],
         [-0.6549, -0.7329],
         [-0.6549, -0.7329],
         [-0.6549, -0.7329],
         [-0.6549, -0.7329],
         [-0.6549, -0.7329],
         [-0.6549, -0.7329]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6444, -0.7444],
         [-0.6444, -0.7444],
         [-0.6444, -0.7444],
         [-0.6444, -0.7444],
         [-0.6444, -0.7444],
         [-0.6444, -0.7444],
         [-0.6444, -0.7444],
         [-0.6444, -0.7444],
         [-0.6444, -0.7444],
         [-0.6444, -0.7444]],
        [[-0.7804, -0.6129],
         [-0.7804, -0.6129],
         [-0.7804, -0.6129],
         [-0.7804, -0.6129],
         [-0.7804, -0.6129],
         [-0.7804, -0.6129],
         [-0.7804, -0.6129],
         [-0.7804, -0.6129],
         [-0.7804, -0.6129],
         [-0.7804, -0.6129]],
        [[-0.8409, -0.5644],
         [-0.8409, -0.5644],
         [-0.8409, -0.5644],
         [-0.8409, -0.5644],
         [-0.8409, -0.5644],
         [-0.8409, -0.5644],
         [-0.8409, -0.5644],
         [-0.8409, -0.5644],
         [-0.8409, -0.5644],
         [-0.8409, -0.5644]],
        [[-0.6616, -0.7257],
         [-0.6616, -0.7257],
         [-0.6616, -0.7257],
         [-0.6616, -0.7257],
         [-0.6616, -0.7257],
         [-0.6616, -0.7257],
         [-0.6616, -0.7257],
         [-0.6616, -0.7257],
         [-0.6616, -0.7257],
         [-0.6616, -0.7257]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6387, -0.7507],
         [-0.6387, -0.7507],
         [-0.6387, -0.7507],
         [-0.6387, -0.7507],
         [-0.6387, -0.7507],
         [-0.6387, -0.7507],
         [-0.6387, -0.7507],
         [-0.6387, -0.7507],
         [-0.6387, -0.7507],
         [-0.6387, -0.7507]],
        [[-0.8198, -0.5808],
         [-0.8198, -0.5808],
         [-0.8198, -0.5808],
         [-0.8198, -0.5808],
         [-0.8198, -0.5808],
         [-0.8198, -0.5808],
         [-0.8198, -0.5808],
         [-0.8198, -0.5808],
         [-0.8198, -0.5808],
         [-0.8198, -0.5808]],
        [[-0.7389, -0.6494],
         [-0.7389, -0.6494],
         [-0.7389, -0.6494],
         [-0.7389, -0.6494],
         [-0.7389, -0.6494],
         [-0.7389, -0.6494],
         [-0.7389, -0.6494],
         [-0.7389, -0.6494],
         [-0.7389, -0.6494],
         [-0.7389, -0.6494]],
        [[-0.6897, -0.6966],
         [-0.6897, -0.6966],
         [-0.6897, -0.6966],
         [-0.6897, -0.6966],
         [-0.6897, -0.6966],
         [-0.6897, -0.6966],
         [-0.6897, -0.6966],
         [-0.6897, -0.6966],
         [-0.6897, -0.6966],
         [-0.6897, -0.6966]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7440, -0.6447],
         [-0.7440, -0.6447],
         [-0.7440, -0.6447],
         [-0.7440, -0.6447],
         [-0.7440, -0.6447],
         [-0.7440, -0.6447],
         [-0.7440, -0.6447],
         [-0.7440, -0.6447],
         [-0.7440, -0.6447],
         [-0.7440, -0.6447]],
        [[-0.6197, -0.7724],
         [-0.6197, -0.7724],
         [-0.6197, -0.7724],
         [-0.6197, -0.7724],
         [-0.6197, -0.7724],
         [-0.6197, -0.7724],
         [-0.6197, -0.7724],
         [-0.6197, -0.7724],
         [-0.6197, -0.7724],
         [-0.6197, -0.7724]],
        [[-0.8485, -0.5587],
         [-0.8485, -0.5587],
         [-0.8485, -0.5587],
         [-0.8485, -0.5587],
         [-0.8485, -0.5587],
         [-0.8485, -0.5587],
         [-0.8485, -0.5587],
         [-0.8485, -0.5587],
         [-0.8485, -0.5587],
         [-0.8485, -0.5587]],
        [[-0.6501, -0.7381],
         [-0.6501, -0.7381],
         [-0.6501, -0.7381],
         [-0.6501, -0.7381],
         [-0.6501, -0.7381],
         [-0.6501, -0.7381],
         [-0.6501, -0.7381],
         [-0.6501, -0.7381],
         [-0.6501, -0.7381],
         [-0.6501, -0.7381]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6374, -0.7522],
         [-0.6374, -0.7522],
         [-0.6374, -0.7522],
         [-0.6374, -0.7522],
         [-0.6374, -0.7522],
         [-0.6374, -0.7522],
         [-0.6374, -0.7522],
         [-0.6374, -0.7522],
         [-0.6374, -0.7522],
         [-0.6374, -0.7522]],
        [[-0.6221, -0.7697],
         [-0.6221, -0.7697],
         [-0.6221, -0.7697],
         [-0.6221, -0.7697],
         [-0.6221, -0.7697],
         [-0.6221, -0.7697],
         [-0.6221, -0.7697],
         [-0.6221, -0.7697],
         [-0.6221, -0.7697],
         [-0.6221, -0.7697]],
        [[-0.7089, -0.6776],
         [-0.7089, -0.6776],
         [-0.7089, -0.6776],
         [-0.7089, -0.6776],
         [-0.7089, -0.6776],
         [-0.7089, -0.6776],
         [-0.7089, -0.6776],
         [-0.7089, -0.6776],
         [-0.7089, -0.6776],
         [-0.7089, -0.6776]],
        [[-0.5578, -0.8497],
         [-0.5578, -0.8497],
         [-0.5578, -0.8497],
         [-0.5578, -0.8497],
         [-0.5578, -0.8497],
         [-0.5578, -0.8497],
         [-0.5578, -0.8497],
         [-0.5578, -0.8497],
         [-0.5578, -0.8497],
         [-0.5578, -0.8497]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6744, -0.7123],
         [-0.6744, -0.7123],
         [-0.6744, -0.7123],
         [-0.6744, -0.7123],
         [-0.6744, -0.7123],
         [-0.6744, -0.7123],
         [-0.6744, -0.7123],
         [-0.6744, -0.7123],
         [-0.6744, -0.7123],
         [-0.6744, -0.7123]],
        [[-0.8433, -0.5626],
         [-0.8433, -0.5626],
         [-0.8433, -0.5626],
         [-0.8433, -0.5626],
         [-0.8433, -0.5626],
         [-0.8433, -0.5626],
         [-0.8433, -0.5626],
         [-0.8433, -0.5626],
         [-0.8433, -0.5626],
         [-0.8433, -0.5626]],
        [[-0.6700, -0.7169],
         [-0.6700, -0.7169],
         [-0.6700, -0.7169],
         [-0.6700, -0.7169],
         [-0.6700, -0.7169],
         [-0.6700, -0.7169],
         [-0.6700, -0.7169],
         [-0.6700, -0.7169],
         [-0.6700, -0.7169],
         [-0.6700, -0.7169]],
        [[-0.7341, -0.6538],
         [-0.7341, -0.6538],
         [-0.7341, -0.6538],
         [-0.7341, -0.6538],
         [-0.7341, -0.6538],
         [-0.7341, -0.6538],
         [-0.7341, -0.6538],
         [-0.7341, -0.6538],
         [-0.7341, -0.6538],
         [-0.7341, -0.6538]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.8019, -0.5951],
         [-0.8019, -0.5951],
         [-0.8019, -0.5951],
         [-0.8019, -0.5951],
         [-0.8019, -0.5951],
         [-0.8019, -0.5951],
         [-0.8019, -0.5951],
         [-0.8019, -0.5951],
         [-0.8019, -0.5951],
         [-0.8019, -0.5951]],
        [[-0.8181, -0.5821],
         [-0.8181, -0.5821],
         [-0.8181, -0.5821],
         [-0.8181, -0.5821],
         [-0.8181, -0.5821],
         [-0.8181, -0.5821],
         [-0.8181, -0.5821],
         [-0.8181, -0.5821],
         [-0.8181, -0.5821],
         [-0.8181, -0.5821]],
        [[-0.7029, -0.6835],
         [-0.7029, -0.6835],
         [-0.7029, -0.6835],
         [-0.7029, -0.6835],
         [-0.7029, -0.6835],
         [-0.7029, -0.6835],
         [-0.7029, -0.6835],
         [-0.7029, -0.6835],
         [-0.7029, -0.6835],
         [-0.7029, -0.6835]],
        [[-0.7370, -0.6512],
         [-0.7370, -0.6512],
         [-0.7370, -0.6512],
         [-0.7370, -0.6512],
         [-0.7370, -0.6512],
         [-0.7370, -0.6512],
         [-0.7370, -0.6512],
         [-0.7370, -0.6512],
         [-0.7370, -0.6512],
         [-0.7370, -0.6512]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.8055, -0.5922],
         [-0.8055, -0.5922],
         [-0.8055, -0.5922],
         [-0.8055, -0.5922],
         [-0.8055, -0.5922],
         [-0.8055, -0.5922],
         [-0.8055, -0.5922],
         [-0.8055, -0.5922],
         [-0.8055, -0.5922],
         [-0.8055, -0.5922]],
        [[-0.8604, -0.5499],
         [-0.8604, -0.5499],
         [-0.8604, -0.5499],
         [-0.8604, -0.5499],
         [-0.8604, -0.5499],
         [-0.8604, -0.5499],
         [-0.8604, -0.5499],
         [-0.8604, -0.5499],
         [-0.8604, -0.5499],
         [-0.8604, -0.5499]],
        [[-0.8673, -0.5448],
         [-0.8673, -0.5448],
         [-0.8673, -0.5448],
         [-0.8673, -0.5448],
         [-0.8673, -0.5448],
         [-0.8673, -0.5448],
         [-0.8673, -0.5448],
         [-0.8673, -0.5448],
         [-0.8673, -0.5448],
         [-0.8673, -0.5448]],
        [[-0.8474, -0.5595],
         [-0.8474, -0.5595],
         [-0.8474, -0.5595],
         [-0.8474, -0.5595],
         [-0.8474, -0.5595],
         [-0.8474, -0.5595],
         [-0.8474, -0.5595],
         [-0.8474, -0.5595],
         [-0.8474, -0.5595],
         [-0.8474, -0.5595]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6963, -0.6900],
         [-0.6963, -0.6900],
         [-0.6963, -0.6900],
         [-0.6963, -0.6900],
         [-0.6963, -0.6900],
         [-0.6963, -0.6900],
         [-0.6963, -0.6900],
         [-0.6963, -0.6900],
         [-0.6963, -0.6900],
         [-0.6963, -0.6900]],
        [[-0.7577, -0.6325],
         [-0.7577, -0.6325],
         [-0.7577, -0.6325],
         [-0.7577, -0.6325],
         [-0.7577, -0.6325],
         [-0.7577, -0.6325],
         [-0.7577, -0.6325],
         [-0.7577, -0.6325],
         [-0.7577, -0.6325],
         [-0.7577, -0.6325]],
        [[-0.8677, -0.5446],
         [-0.8677, -0.5446],
         [-0.8677, -0.5446],
         [-0.8677, -0.5446],
         [-0.8677, -0.5446],
         [-0.8677, -0.5446],
         [-0.8677, -0.5446],
         [-0.8677, -0.5446],
         [-0.8677, -0.5446],
         [-0.8677, -0.5446]],
        [[-0.6439, -0.7449],
         [-0.6439, -0.7449],
         [-0.6439, -0.7449],
         [-0.6439, -0.7449],
         [-0.6439, -0.7449],
         [-0.6439, -0.7449],
         [-0.6439, -0.7449],
         [-0.6439, -0.7449],
         [-0.6439, -0.7449],
         [-0.6439, -0.7449]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6378, -0.7517],
         [-0.6378, -0.7517],
         [-0.6378, -0.7517],
         [-0.6378, -0.7517],
         [-0.6378, -0.7517],
         [-0.6378, -0.7517],
         [-0.6378, -0.7517],
         [-0.6378, -0.7517],
         [-0.6378, -0.7517],
         [-0.6378, -0.7517]],
        [[-0.8475, -0.5594],
         [-0.8475, -0.5594],
         [-0.8475, -0.5594],
         [-0.8475, -0.5594],
         [-0.8475, -0.5594],
         [-0.8475, -0.5594],
         [-0.8475, -0.5594],
         [-0.8475, -0.5594],
         [-0.8475, -0.5594],
         [-0.8475, -0.5594]],
        [[-0.7632, -0.6277],
         [-0.7632, -0.6277],
         [-0.7632, -0.6277],
         [-0.7632, -0.6277],
         [-0.7632, -0.6277],
         [-0.7632, -0.6277],
         [-0.7632, -0.6277],
         [-0.7632, -0.6277],
         [-0.7632, -0.6277],
         [-0.7632, -0.6277]],
        [[-0.6323, -0.7579],
         [-0.6323, -0.7579],
         [-0.6323, -0.7579],
         [-0.6323, -0.7579],
         [-0.6323, -0.7579],
         [-0.6323, -0.7579],
         [-0.6323, -0.7579],
         [-0.6323, -0.7579],
         [-0.6323, -0.7579],
         [-0.6323, -0.7579]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6851, -0.7013],
         [-0.6851, -0.7013],
         [-0.6851, -0.7013],
         [-0.6851, -0.7013],
         [-0.6851, -0.7013],
         [-0.6851, -0.7013],
         [-0.6851, -0.7013],
         [-0.6851, -0.7013],
         [-0.6851, -0.7013],
         [-0.6851, -0.7013]],
        [[-0.7048, -0.6816],
         [-0.7048, -0.6816],
         [-0.7048, -0.6816],
         [-0.7048, -0.6816],
         [-0.7048, -0.6816],
         [-0.7048, -0.6816],
         [-0.7048, -0.6816],
         [-0.7048, -0.6816],
         [-0.7048, -0.6816],
         [-0.7048, -0.6816]],
        [[-0.5273, -0.8920],
         [-0.5273, -0.8920],
         [-0.5273, -0.8920],
         [-0.5273, -0.8920],
         [-0.5273, -0.8920],
         [-0.5273, -0.8920],
         [-0.5273, -0.8920],
         [-0.5273, -0.8920],
         [-0.5273, -0.8920],
         [-0.5273, -0.8920]],
        [[-0.8162, -0.5836],
         [-0.8162, -0.5836],
         [-0.8162, -0.5836],
         [-0.8162, -0.5836],
         [-0.8162, -0.5836],
         [-0.8162, -0.5836],
         [-0.8162, -0.5836],
         [-0.8162, -0.5836],
         [-0.8162, -0.5836],
         [-0.8162, -0.5836]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5999, -0.7960],
         [-0.5999, -0.7960],
         [-0.5999, -0.7960],
         [-0.5999, -0.7960],
         [-0.5999, -0.7960],
         [-0.5999, -0.7960],
         [-0.5999, -0.7960],
         [-0.5999, -0.7960],
         [-0.5999, -0.7960],
         [-0.5999, -0.7960]],
        [[-0.6550, -0.7328],
         [-0.6550, -0.7328],
         [-0.6550, -0.7328],
         [-0.6550, -0.7328],
         [-0.6550, -0.7328],
         [-0.6550, -0.7328],
         [-0.6550, -0.7328],
         [-0.6550, -0.7328],
         [-0.6550, -0.7328],
         [-0.6550, -0.7328]],
        [[-0.7890, -0.6057],
         [-0.7890, -0.6057],
         [-0.7890, -0.6057],
         [-0.7890, -0.6057],
         [-0.7890, -0.6057],
         [-0.7890, -0.6057],
         [-0.7890, -0.6057],
         [-0.7890, -0.6057],
         [-0.7890, -0.6057],
         [-0.7890, -0.6057]],
        [[-0.5845, -0.8150],
         [-0.5845, -0.8150],
         [-0.5845, -0.8150],
         [-0.5845, -0.8150],
         [-0.5845, -0.8150],
         [-0.5845, -0.8150],
         [-0.5845, -0.8150],
         [-0.5845, -0.8150],
         [-0.5845, -0.8150],
         [-0.5845, -0.8150]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6745, -0.7122],
         [-0.6745, -0.7122],
         [-0.6745, -0.7122],
         [-0.6745, -0.7122],
         [-0.6745, -0.7122],
         [-0.6745, -0.7122],
         [-0.6745, -0.7122],
         [-0.6745, -0.7122],
         [-0.6745, -0.7122],
         [-0.6745, -0.7122]],
        [[-0.5135, -0.9123],
         [-0.5135, -0.9123],
         [-0.5135, -0.9123],
         [-0.5135, -0.9123],
         [-0.5135, -0.9123],
         [-0.5135, -0.9123],
         [-0.5135, -0.9123],
         [-0.5135, -0.9123],
         [-0.5135, -0.9123],
         [-0.5135, -0.9123]],
        [[-0.5460, -0.8657],
         [-0.5460, -0.8657],
         [-0.5460, -0.8657],
         [-0.5460, -0.8657],
         [-0.5460, -0.8657],
         [-0.5460, -0.8657],
         [-0.5460, -0.8657],
         [-0.5460, -0.8657],
         [-0.5460, -0.8657],
         [-0.5460, -0.8657]],
        [[-0.5365, -0.8790],
         [-0.5365, -0.8790],
         [-0.5365, -0.8790],
         [-0.5365, -0.8790],
         [-0.5365, -0.8790],
         [-0.5365, -0.8790],
         [-0.5365, -0.8790],
         [-0.5365, -0.8790],
         [-0.5365, -0.8790],
         [-0.5365, -0.8790]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6097, -0.7842],
         [-0.6097, -0.7842],
         [-0.6097, -0.7842],
         [-0.6097, -0.7842],
         [-0.6097, -0.7842],
         [-0.6097, -0.7842],
         [-0.6097, -0.7842],
         [-0.6097, -0.7842],
         [-0.6097, -0.7842],
         [-0.6097, -0.7842]],
        [[-0.5488, -0.8618],
         [-0.5488, -0.8618],
         [-0.5488, -0.8618],
         [-0.5488, -0.8618],
         [-0.5488, -0.8618],
         [-0.5488, -0.8618],
         [-0.5488, -0.8618],
         [-0.5488, -0.8618],
         [-0.5488, -0.8618],
         [-0.5488, -0.8618]],
        [[-0.6522, -0.7359],
         [-0.6522, -0.7359],
         [-0.6522, -0.7359],
         [-0.6522, -0.7359],
         [-0.6522, -0.7359],
         [-0.6522, -0.7359],
         [-0.6522, -0.7359],
         [-0.6522, -0.7359],
         [-0.6522, -0.7359],
         [-0.6522, -0.7359]],
        [[-0.5218, -0.9000],
         [-0.5218, -0.9000],
         [-0.5218, -0.9000],
         [-0.5218, -0.9000],
         [-0.5218, -0.9000],
         [-0.5218, -0.9000],
         [-0.5218, -0.9000],
         [-0.5218, -0.9000],
         [-0.5218, -0.9000],
         [-0.5218, -0.9000]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5646, -0.8407],
         [-0.5646, -0.8407],
         [-0.5646, -0.8407],
         [-0.5646, -0.8407],
         [-0.5646, -0.8407],
         [-0.5646, -0.8407],
         [-0.5646, -0.8407],
         [-0.5646, -0.8407],
         [-0.5646, -0.8407],
         [-0.5646, -0.8407]],
        [[-0.7226, -0.6646],
         [-0.7226, -0.6646],
         [-0.7226, -0.6646],
         [-0.7226, -0.6646],
         [-0.7226, -0.6646],
         [-0.7226, -0.6646],
         [-0.7226, -0.6646],
         [-0.7226, -0.6646],
         [-0.7226, -0.6646],
         [-0.7226, -0.6646]],
        [[-0.5499, -0.8604],
         [-0.5499, -0.8604],
         [-0.5499, -0.8604],
         [-0.5499, -0.8604],
         [-0.5499, -0.8604],
         [-0.5499, -0.8604],
         [-0.5499, -0.8604],
         [-0.5499, -0.8604],
         [-0.5499, -0.8604],
         [-0.5499, -0.8604]],
        [[-0.5044, -0.9260],
         [-0.5044, -0.9260],
         [-0.5044, -0.9260],
         [-0.5044, -0.9260],
         [-0.5044, -0.9260],
         [-0.5044, -0.9260],
         [-0.5044, -0.9260],
         [-0.5044, -0.9260],
         [-0.5044, -0.9260],
         [-0.5044, -0.9260]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5259, -0.8941],
         [-0.5259, -0.8941],
         [-0.5259, -0.8941],
         [-0.5259, -0.8941],
         [-0.5259, -0.8941],
         [-0.5259, -0.8941],
         [-0.5259, -0.8941],
         [-0.5259, -0.8941],
         [-0.5259, -0.8941],
         [-0.5259, -0.8941]],
        [[-0.6157, -0.7771],
         [-0.6157, -0.7771],
         [-0.6157, -0.7771],
         [-0.6157, -0.7771],
         [-0.6157, -0.7771],
         [-0.6157, -0.7771],
         [-0.6157, -0.7771],
         [-0.6157, -0.7771],
         [-0.6157, -0.7771],
         [-0.6157, -0.7771]],
        [[-0.6617, -0.7256],
         [-0.6617, -0.7256],
         [-0.6617, -0.7256],
         [-0.6617, -0.7256],
         [-0.6617, -0.7256],
         [-0.6617, -0.7256],
         [-0.6617, -0.7256],
         [-0.6617, -0.7256],
         [-0.6617, -0.7256],
         [-0.6617, -0.7256]],
        [[-0.5707, -0.8327],
         [-0.5707, -0.8327],
         [-0.5707, -0.8327],
         [-0.5707, -0.8327],
         [-0.5707, -0.8327],
         [-0.5707, -0.8327],
         [-0.5707, -0.8327],
         [-0.5707, -0.8327],
         [-0.5707, -0.8327],
         [-0.5707, -0.8327]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6826, -0.7039],
         [-0.6826, -0.7039],
         [-0.6826, -0.7039],
         [-0.6826, -0.7039],
         [-0.6826, -0.7039],
         [-0.6826, -0.7039],
         [-0.6826, -0.7039],
         [-0.6826, -0.7039],
         [-0.6826, -0.7039],
         [-0.6826, -0.7039]],
        [[-0.6958, -0.6905],
         [-0.6958, -0.6905],
         [-0.6958, -0.6905],
         [-0.6958, -0.6905],
         [-0.6958, -0.6905],
         [-0.6958, -0.6905],
         [-0.6958, -0.6905],
         [-0.6958, -0.6905],
         [-0.6958, -0.6905],
         [-0.6958, -0.6905]],
        [[-0.5144, -0.9109],
         [-0.5144, -0.9109],
         [-0.5144, -0.9109],
         [-0.5144, -0.9109],
         [-0.5144, -0.9109],
         [-0.5144, -0.9109],
         [-0.5144, -0.9109],
         [-0.5144, -0.9109],
         [-0.5144, -0.9109],
         [-0.5144, -0.9109]],
        [[-0.7528, -0.6368],
         [-0.7528, -0.6368],
         [-0.7528, -0.6368],
         [-0.7528, -0.6368],
         [-0.7528, -0.6368],
         [-0.7528, -0.6368],
         [-0.7528, -0.6368],
         [-0.7528, -0.6368],
         [-0.7528, -0.6368],
         [-0.7528, -0.6368]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5081, -0.9204],
         [-0.5081, -0.9204],
         [-0.5081, -0.9204],
         [-0.5081, -0.9204],
         [-0.5081, -0.9204],
         [-0.5081, -0.9204],
         [-0.5081, -0.9204],
         [-0.5081, -0.9204],
         [-0.5081, -0.9204],
         [-0.5081, -0.9204]],
        [[-0.7110, -0.6756],
         [-0.7110, -0.6756],
         [-0.7110, -0.6756],
         [-0.7110, -0.6756],
         [-0.7110, -0.6756],
         [-0.7110, -0.6756],
         [-0.7110, -0.6756],
         [-0.7110, -0.6756],
         [-0.7110, -0.6756],
         [-0.7110, -0.6756]],
        [[-0.8606, -0.5497],
         [-0.8606, -0.5497],
         [-0.8606, -0.5497],
         [-0.8606, -0.5497],
         [-0.8606, -0.5497],
         [-0.8606, -0.5497],
         [-0.8606, -0.5497],
         [-0.8606, -0.5497],
         [-0.8606, -0.5497],
         [-0.8606, -0.5497]],
        [[-0.8734, -0.5404],
         [-0.8734, -0.5404],
         [-0.8734, -0.5404],
         [-0.8734, -0.5404],
         [-0.8734, -0.5404],
         [-0.8734, -0.5404],
         [-0.8734, -0.5404],
         [-0.8734, -0.5404],
         [-0.8734, -0.5404],
         [-0.8734, -0.5404]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.8380, -0.5667],
         [-0.8380, -0.5667],
         [-0.8380, -0.5667],
         [-0.8380, -0.5667],
         [-0.8380, -0.5667],
         [-0.8380, -0.5667],
         [-0.8380, -0.5667],
         [-0.8380, -0.5667],
         [-0.8380, -0.5667],
         [-0.8380, -0.5667]],
        [[-0.6105, -0.7832],
         [-0.6105, -0.7832],
         [-0.6105, -0.7832],
         [-0.6105, -0.7832],
         [-0.6105, -0.7832],
         [-0.6105, -0.7832],
         [-0.6105, -0.7832],
         [-0.6105, -0.7832],
         [-0.6105, -0.7832],
         [-0.6105, -0.7832]],
        [[-0.5042, -0.9264],
         [-0.5042, -0.9264],
         [-0.5042, -0.9264],
         [-0.5042, -0.9264],
         [-0.5042, -0.9264],
         [-0.5042, -0.9264],
         [-0.5042, -0.9264],
         [-0.5042, -0.9264],
         [-0.5042, -0.9264],
         [-0.5042, -0.9264]],
        [[-0.6888, -0.6975],
         [-0.6888, -0.6975],
         [-0.6888, -0.6975],
         [-0.6888, -0.6975],
         [-0.6888, -0.6975],
         [-0.6888, -0.6975],
         [-0.6888, -0.6975],
         [-0.6888, -0.6975],
         [-0.6888, -0.6975],
         [-0.6888, -0.6975]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5494, -0.8611],
         [-0.5494, -0.8611],
         [-0.5494, -0.8611],
         [-0.5494, -0.8611],
         [-0.5494, -0.8611],
         [-0.5494, -0.8611],
         [-0.5494, -0.8611],
         [-0.5494, -0.8611],
         [-0.5494, -0.8611],
         [-0.5494, -0.8611]],
        [[-0.4932, -0.9433],
         [-0.4932, -0.9433],
         [-0.4932, -0.9433],
         [-0.4932, -0.9433],
         [-0.4932, -0.9433],
         [-0.4932, -0.9433],
         [-0.4932, -0.9433],
         [-0.4932, -0.9433],
         [-0.4932, -0.9433],
         [-0.4932, -0.9433]],
        [[-0.6347, -0.7552],
         [-0.6347, -0.7552],
         [-0.6347, -0.7552],
         [-0.6347, -0.7552],
         [-0.6347, -0.7552],
         [-0.6347, -0.7552],
         [-0.6347, -0.7552],
         [-0.6347, -0.7552],
         [-0.6347, -0.7552],
         [-0.6347, -0.7552]],
        [[-0.6933, -0.6930],
         [-0.6933, -0.6930],
         [-0.6933, -0.6930],
         [-0.6933, -0.6930],
         [-0.6933, -0.6930],
         [-0.6933, -0.6930],
         [-0.6933, -0.6930],
         [-0.6933, -0.6930],
         [-0.6933, -0.6930],
         [-0.6933, -0.6930]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6480, -0.7405],
         [-0.6480, -0.7405],
         [-0.6480, -0.7405],
         [-0.6480, -0.7405],
         [-0.6480, -0.7405],
         [-0.6480, -0.7405],
         [-0.6480, -0.7405],
         [-0.6480, -0.7405],
         [-0.6480, -0.7405],
         [-0.6480, -0.7405]],
        [[-0.5411, -0.8726],
         [-0.5411, -0.8726],
         [-0.5411, -0.8726],
         [-0.5411, -0.8726],
         [-0.5411, -0.8726],
         [-0.5411, -0.8726],
         [-0.5411, -0.8726],
         [-0.5411, -0.8726],
         [-0.5411, -0.8726],
         [-0.5411, -0.8726]],
        [[-0.5300, -0.8883],
         [-0.5300, -0.8883],
         [-0.5300, -0.8883],
         [-0.5300, -0.8883],
         [-0.5300, -0.8883],
         [-0.5300, -0.8883],
         [-0.5300, -0.8883],
         [-0.5300, -0.8883],
         [-0.5300, -0.8883],
         [-0.5300, -0.8883]],
        [[-0.4972, -0.9370],
         [-0.4972, -0.9370],
         [-0.4972, -0.9370],
         [-0.4972, -0.9370],
         [-0.4972, -0.9370],
         [-0.4972, -0.9370],
         [-0.4972, -0.9370],
         [-0.4972, -0.9370],
         [-0.4972, -0.9370],
         [-0.4972, -0.9370]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.8849, -0.5323],
         [-0.8849, -0.5323],
         [-0.8849, -0.5323],
         [-0.8849, -0.5323],
         [-0.8849, -0.5323],
         [-0.8849, -0.5323],
         [-0.8849, -0.5323],
         [-0.8849, -0.5323],
         [-0.8849, -0.5323],
         [-0.8849, -0.5323]],
        [[-0.5473, -0.8639],
         [-0.5473, -0.8639],
         [-0.5473, -0.8639],
         [-0.5473, -0.8639],
         [-0.5473, -0.8639],
         [-0.5473, -0.8639],
         [-0.5473, -0.8639],
         [-0.5473, -0.8639],
         [-0.5473, -0.8639],
         [-0.5473, -0.8639]],
        [[-0.8820, -0.5343],
         [-0.8820, -0.5343],
         [-0.8820, -0.5343],
         [-0.8820, -0.5343],
         [-0.8820, -0.5343],
         [-0.8820, -0.5343],
         [-0.8820, -0.5343],
         [-0.8820, -0.5343],
         [-0.8820, -0.5343],
         [-0.8820, -0.5343]],
        [[-0.7057, -0.6807],
         [-0.7057, -0.6807],
         [-0.7057, -0.6807],
         [-0.7057, -0.6807],
         [-0.7057, -0.6807],
         [-0.7057, -0.6807],
         [-0.7057, -0.6807],
         [-0.7057, -0.6807],
         [-0.7057, -0.6807],
         [-0.7057, -0.6807]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.8115, -0.5873],
         [-0.8115, -0.5873],
         [-0.8115, -0.5873],
         [-0.8115, -0.5873],
         [-0.8115, -0.5873],
         [-0.8115, -0.5873],
         [-0.8115, -0.5873],
         [-0.8115, -0.5873],
         [-0.8115, -0.5873],
         [-0.8115, -0.5873]],
        [[-0.6213, -0.7706],
         [-0.6213, -0.7706],
         [-0.6213, -0.7706],
         [-0.6213, -0.7706],
         [-0.6213, -0.7706],
         [-0.6213, -0.7706],
         [-0.6213, -0.7706],
         [-0.6213, -0.7706],
         [-0.6213, -0.7706],
         [-0.6213, -0.7706]],
        [[-0.6814, -0.7050],
         [-0.6814, -0.7050],
         [-0.6814, -0.7050],
         [-0.6814, -0.7050],
         [-0.6814, -0.7050],
         [-0.6814, -0.7050],
         [-0.6814, -0.7050],
         [-0.6814, -0.7050],
         [-0.6814, -0.7050],
         [-0.6814, -0.7050]],
        [[-0.8800, -0.5358],
         [-0.8800, -0.5358],
         [-0.8800, -0.5358],
         [-0.8800, -0.5358],
         [-0.8800, -0.5358],
         [-0.8800, -0.5358],
         [-0.8800, -0.5358],
         [-0.8800, -0.5358],
         [-0.8800, -0.5358],
         [-0.8800, -0.5358]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.8884, -0.5299],
         [-0.8884, -0.5299],
         [-0.8884, -0.5299],
         [-0.8884, -0.5299],
         [-0.8884, -0.5299],
         [-0.8884, -0.5299],
         [-0.8884, -0.5299],
         [-0.8884, -0.5299],
         [-0.8884, -0.5299],
         [-0.8884, -0.5299]],
        [[-0.5736, -0.8290],
         [-0.5736, -0.8290],
         [-0.5736, -0.8290],
         [-0.5736, -0.8290],
         [-0.5736, -0.8290],
         [-0.5736, -0.8290],
         [-0.5736, -0.8290],
         [-0.5736, -0.8290],
         [-0.5736, -0.8290],
         [-0.5736, -0.8290]],
        [[-0.8826, -0.5339],
         [-0.8826, -0.5339],
         [-0.8826, -0.5339],
         [-0.8826, -0.5339],
         [-0.8826, -0.5339],
         [-0.8826, -0.5339],
         [-0.8826, -0.5339],
         [-0.8826, -0.5339],
         [-0.8826, -0.5339],
         [-0.8826, -0.5339]],
        [[-0.8240, -0.5774],
         [-0.8240, -0.5774],
         [-0.8240, -0.5774],
         [-0.8240, -0.5774],
         [-0.8240, -0.5774],
         [-0.8240, -0.5774],
         [-0.8240, -0.5774],
         [-0.8240, -0.5774],
         [-0.8240, -0.5774],
         [-0.8240, -0.5774]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5047, -0.9255],
         [-0.5047, -0.9255],
         [-0.5047, -0.9255],
         [-0.5047, -0.9255],
         [-0.5047, -0.9255],
         [-0.5047, -0.9255],
         [-0.5047, -0.9255],
         [-0.5047, -0.9255],
         [-0.5047, -0.9255],
         [-0.5047, -0.9255]],
        [[-0.7136, -0.6731],
         [-0.7136, -0.6731],
         [-0.7136, -0.6731],
         [-0.7136, -0.6731],
         [-0.7136, -0.6731],
         [-0.7136, -0.6731],
         [-0.7136, -0.6731],
         [-0.7136, -0.6731],
         [-0.7136, -0.6731],
         [-0.7136, -0.6731]],
        [[-0.7782, -0.6147],
         [-0.7782, -0.6147],
         [-0.7782, -0.6147],
         [-0.7782, -0.6147],
         [-0.7782, -0.6147],
         [-0.7782, -0.6147],
         [-0.7782, -0.6147],
         [-0.7782, -0.6147],
         [-0.7782, -0.6147],
         [-0.7782, -0.6147]],
        [[-0.7144, -0.6723],
         [-0.7144, -0.6723],
         [-0.7144, -0.6723],
         [-0.7144, -0.6723],
         [-0.7144, -0.6723],
         [-0.7144, -0.6723],
         [-0.7144, -0.6723],
         [-0.7144, -0.6723],
         [-0.7144, -0.6723],
         [-0.7144, -0.6723]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4564, -1.0039],
         [-0.4564, -1.0039],
         [-0.4564, -1.0039],
         [-0.4564, -1.0039],
         [-0.4564, -1.0039],
         [-0.4564, -1.0039],
         [-0.4564, -1.0039],
         [-0.4564, -1.0039],
         [-0.4564, -1.0039],
         [-0.4564, -1.0039]],
        [[-0.6568, -0.7308],
         [-0.6568, -0.7308],
         [-0.6568, -0.7308],
         [-0.6568, -0.7308],
         [-0.6568, -0.7308],
         [-0.6568, -0.7308],
         [-0.6568, -0.7308],
         [-0.6568, -0.7308],
         [-0.6568, -0.7308],
         [-0.6568, -0.7308]],
        [[-0.8904, -0.5285],
         [-0.8904, -0.5285],
         [-0.8904, -0.5285],
         [-0.8904, -0.5285],
         [-0.8904, -0.5285],
         [-0.8904, -0.5285],
         [-0.8904, -0.5285],
         [-0.8904, -0.5285],
         [-0.8904, -0.5285],
         [-0.8904, -0.5285]],
        [[-0.7787, -0.6144],
         [-0.7787, -0.6144],
         [-0.7787, -0.6144],
         [-0.7787, -0.6144],
         [-0.7787, -0.6144],
         [-0.7787, -0.6144],
         [-0.7787, -0.6144],
         [-0.7787, -0.6144],
         [-0.7787, -0.6144],
         [-0.7787, -0.6144]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6352, -0.7546],
         [-0.6352, -0.7546],
         [-0.6352, -0.7546],
         [-0.6352, -0.7546],
         [-0.6352, -0.7546],
         [-0.6352, -0.7546],
         [-0.6352, -0.7546],
         [-0.6352, -0.7546],
         [-0.6352, -0.7546],
         [-0.6352, -0.7546]],
        [[-0.5440, -0.8686],
         [-0.5440, -0.8686],
         [-0.5440, -0.8686],
         [-0.5440, -0.8686],
         [-0.5440, -0.8686],
         [-0.5440, -0.8686],
         [-0.5440, -0.8686],
         [-0.5440, -0.8686],
         [-0.5440, -0.8686],
         [-0.5440, -0.8686]],
        [[-0.5495, -0.8610],
         [-0.5495, -0.8610],
         [-0.5495, -0.8610],
         [-0.5495, -0.8610],
         [-0.5495, -0.8610],
         [-0.5495, -0.8610],
         [-0.5495, -0.8610],
         [-0.5495, -0.8610],
         [-0.5495, -0.8610],
         [-0.5495, -0.8610]],
        [[-0.7425, -0.6461],
         [-0.7425, -0.6461],
         [-0.7425, -0.6461],
         [-0.7425, -0.6461],
         [-0.7425, -0.6461],
         [-0.7425, -0.6461],
         [-0.7425, -0.6461],
         [-0.7425, -0.6461],
         [-0.7425, -0.6461],
         [-0.7425, -0.6461]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.8968, -0.5241],
         [-0.8968, -0.5241],
         [-0.8968, -0.5241],
         [-0.8968, -0.5241],
         [-0.8968, -0.5241],
         [-0.8968, -0.5241],
         [-0.8968, -0.5241],
         [-0.8968, -0.5241],
         [-0.8968, -0.5241],
         [-0.8968, -0.5241]],
        [[-0.5960, -0.8008],
         [-0.5960, -0.8008],
         [-0.5960, -0.8008],
         [-0.5960, -0.8008],
         [-0.5960, -0.8008],
         [-0.5960, -0.8008],
         [-0.5960, -0.8008],
         [-0.5960, -0.8008],
         [-0.5960, -0.8008],
         [-0.5960, -0.8008]],
        [[-0.5069, -0.9221],
         [-0.5069, -0.9221],
         [-0.5069, -0.9221],
         [-0.5069, -0.9221],
         [-0.5069, -0.9221],
         [-0.5069, -0.9221],
         [-0.5069, -0.9221],
         [-0.5069, -0.9221],
         [-0.5069, -0.9221],
         [-0.5069, -0.9221]],
        [[-0.4770, -0.9693],
         [-0.4770, -0.9693],
         [-0.4770, -0.9693],
         [-0.4770, -0.9693],
         [-0.4770, -0.9693],
         [-0.4770, -0.9693],
         [-0.4770, -0.9693],
         [-0.4770, -0.9693],
         [-0.4770, -0.9693],
         [-0.4770, -0.9693]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.8957, -0.5248],
         [-0.8957, -0.5248],
         [-0.8957, -0.5248],
         [-0.8957, -0.5248],
         [-0.8957, -0.5248],
         [-0.8957, -0.5248],
         [-0.8957, -0.5248],
         [-0.8957, -0.5248],
         [-0.8957, -0.5248],
         [-0.8957, -0.5248]],
        [[-0.5312, -0.8864],
         [-0.5312, -0.8864],
         [-0.5312, -0.8864],
         [-0.5312, -0.8864],
         [-0.5312, -0.8864],
         [-0.5312, -0.8864],
         [-0.5312, -0.8864],
         [-0.5312, -0.8864],
         [-0.5312, -0.8864],
         [-0.5312, -0.8864]],
        [[-0.4166, -1.0767],
         [-0.4166, -1.0767],
         [-0.4166, -1.0767],
         [-0.4166, -1.0767],
         [-0.4166, -1.0767],
         [-0.4166, -1.0767],
         [-0.4166, -1.0767],
         [-0.4166, -1.0767],
         [-0.4166, -1.0767],
         [-0.4166, -1.0767]],
        [[-0.4343, -1.0433],
         [-0.4343, -1.0433],
         [-0.4343, -1.0433],
         [-0.4343, -1.0433],
         [-0.4343, -1.0433],
         [-0.4343, -1.0433],
         [-0.4343, -1.0433],
         [-0.4343, -1.0433],
         [-0.4343, -1.0433],
         [-0.4343, -1.0433]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.8722, -0.5414],
         [-0.8722, -0.5414],
         [-0.8722, -0.5414],
         [-0.8722, -0.5414],
         [-0.8722, -0.5414],
         [-0.8722, -0.5414],
         [-0.8722, -0.5414],
         [-0.8722, -0.5414],
         [-0.8722, -0.5414],
         [-0.8722, -0.5414]],
        [[-0.5852, -0.8141],
         [-0.5852, -0.8141],
         [-0.5852, -0.8141],
         [-0.5852, -0.8141],
         [-0.5852, -0.8141],
         [-0.5852, -0.8141],
         [-0.5852, -0.8141],
         [-0.5852, -0.8141],
         [-0.5852, -0.8141],
         [-0.5852, -0.8141]],
        [[-0.4634, -0.9920],
         [-0.4634, -0.9920],
         [-0.4634, -0.9920],
         [-0.4634, -0.9920],
         [-0.4634, -0.9920],
         [-0.4634, -0.9920],
         [-0.4634, -0.9920],
         [-0.4634, -0.9920],
         [-0.4634, -0.9920],
         [-0.4634, -0.9920]],
        [[-0.4722, -0.9772],
         [-0.4722, -0.9772],
         [-0.4722, -0.9772],
         [-0.4722, -0.9772],
         [-0.4722, -0.9772],
         [-0.4722, -0.9772],
         [-0.4722, -0.9772],
         [-0.4722, -0.9772],
         [-0.4722, -0.9772],
         [-0.4722, -0.9772]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4848, -0.9566],
         [-0.4848, -0.9566],
         [-0.4848, -0.9566],
         [-0.4848, -0.9566],
         [-0.4848, -0.9566],
         [-0.4848, -0.9566],
         [-0.4848, -0.9566],
         [-0.4848, -0.9566],
         [-0.4848, -0.9566],
         [-0.4848, -0.9566]],
        [[-0.7065, -0.6800],
         [-0.7065, -0.6800],
         [-0.7065, -0.6800],
         [-0.7065, -0.6800],
         [-0.7065, -0.6800],
         [-0.7065, -0.6800],
         [-0.7065, -0.6800],
         [-0.7065, -0.6800],
         [-0.7065, -0.6800],
         [-0.7065, -0.6800]],
        [[-0.4768, -0.9696],
         [-0.4768, -0.9696],
         [-0.4768, -0.9696],
         [-0.4768, -0.9696],
         [-0.4768, -0.9696],
         [-0.4768, -0.9696],
         [-0.4768, -0.9696],
         [-0.4768, -0.9696],
         [-0.4768, -0.9696],
         [-0.4768, -0.9696]],
        [[-0.7195, -0.6674],
         [-0.7195, -0.6674],
         [-0.7195, -0.6674],
         [-0.7195, -0.6674],
         [-0.7195, -0.6674],
         [-0.7195, -0.6674],
         [-0.7195, -0.6674],
         [-0.7195, -0.6674],
         [-0.7195, -0.6674],
         [-0.7195, -0.6674]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4314, -1.0488],
         [-0.4314, -1.0488],
         [-0.4314, -1.0488],
         [-0.4314, -1.0488],
         [-0.4314, -1.0488],
         [-0.4314, -1.0488],
         [-0.4314, -1.0488],
         [-0.4314, -1.0488],
         [-0.4314, -1.0488],
         [-0.4314, -1.0488]],
        [[-0.7987, -0.5977],
         [-0.7987, -0.5977],
         [-0.7987, -0.5977],
         [-0.7987, -0.5977],
         [-0.7987, -0.5977],
         [-0.7987, -0.5977],
         [-0.7987, -0.5977],
         [-0.7987, -0.5977],
         [-0.7987, -0.5977],
         [-0.7987, -0.5977]],
        [[-0.6439, -0.7449],
         [-0.6439, -0.7449],
         [-0.6439, -0.7449],
         [-0.6439, -0.7449],
         [-0.6439, -0.7449],
         [-0.6439, -0.7449],
         [-0.6439, -0.7449],
         [-0.6439, -0.7449],
         [-0.6439, -0.7449],
         [-0.6439, -0.7449]],
        [[-0.4443, -1.0252],
         [-0.4443, -1.0252],
         [-0.4443, -1.0252],
         [-0.4443, -1.0252],
         [-0.4443, -1.0252],
         [-0.4443, -1.0252],
         [-0.4443, -1.0252],
         [-0.4443, -1.0252],
         [-0.4443, -1.0252],
         [-0.4443, -1.0252]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7423, -0.6463],
         [-0.7423, -0.6463],
         [-0.7423, -0.6463],
         [-0.7423, -0.6463],
         [-0.7423, -0.6463],
         [-0.7423, -0.6463],
         [-0.7423, -0.6463],
         [-0.7423, -0.6463],
         [-0.7423, -0.6463],
         [-0.7423, -0.6463]],
        [[-0.4285, -1.0541],
         [-0.4285, -1.0541],
         [-0.4285, -1.0541],
         [-0.4285, -1.0541],
         [-0.4285, -1.0541],
         [-0.4285, -1.0541],
         [-0.4285, -1.0541],
         [-0.4285, -1.0541],
         [-0.4285, -1.0541],
         [-0.4285, -1.0541]],
        [[-0.4033, -1.1030],
         [-0.4033, -1.1030],
         [-0.4033, -1.1030],
         [-0.4033, -1.1030],
         [-0.4033, -1.1030],
         [-0.4033, -1.1030],
         [-0.4033, -1.1030],
         [-0.4033, -1.1030],
         [-0.4033, -1.1030],
         [-0.4033, -1.1030]],
        [[-0.3896, -1.1310],
         [-0.3896, -1.1310],
         [-0.3896, -1.1310],
         [-0.3896, -1.1310],
         [-0.3896, -1.1310],
         [-0.3896, -1.1310],
         [-0.3896, -1.1310],
         [-0.3896, -1.1310],
         [-0.3896, -1.1310],
         [-0.3896, -1.1310]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7528, -0.6369],
         [-0.7528, -0.6369],
         [-0.7528, -0.6369],
         [-0.7528, -0.6369],
         [-0.7528, -0.6369],
         [-0.7528, -0.6369],
         [-0.7528, -0.6369],
         [-0.7528, -0.6369],
         [-0.7528, -0.6369],
         [-0.7528, -0.6369]],
        [[-0.5012, -0.9309],
         [-0.5012, -0.9309],
         [-0.5012, -0.9309],
         [-0.5012, -0.9309],
         [-0.5012, -0.9309],
         [-0.5012, -0.9309],
         [-0.5012, -0.9309],
         [-0.5012, -0.9309],
         [-0.5012, -0.9309],
         [-0.5012, -0.9309]],
        [[-0.4606, -0.9968],
         [-0.4606, -0.9968],
         [-0.4606, -0.9968],
         [-0.4606, -0.9968],
         [-0.4606, -0.9968],
         [-0.4606, -0.9968],
         [-0.4606, -0.9968],
         [-0.4606, -0.9968],
         [-0.4606, -0.9968],
         [-0.4606, -0.9968]],
        [[-0.4158, -1.0782],
         [-0.4158, -1.0782],
         [-0.4158, -1.0782],
         [-0.4158, -1.0782],
         [-0.4158, -1.0782],
         [-0.4158, -1.0782],
         [-0.4158, -1.0782],
         [-0.4158, -1.0782],
         [-0.4158, -1.0782],
         [-0.4158, -1.0782]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.3776, -1.1568],
         [-0.3776, -1.1568],
         [-0.3776, -1.1568],
         [-0.3776, -1.1568],
         [-0.3776, -1.1568],
         [-0.3776, -1.1568],
         [-0.3776, -1.1568],
         [-0.3776, -1.1568],
         [-0.3776, -1.1568],
         [-0.3776, -1.1568]],
        [[-0.4428, -1.0278],
         [-0.4428, -1.0278],
         [-0.4428, -1.0278],
         [-0.4428, -1.0278],
         [-0.4428, -1.0278],
         [-0.4428, -1.0278],
         [-0.4428, -1.0278],
         [-0.4428, -1.0278],
         [-0.4428, -1.0278],
         [-0.4428, -1.0278]],
        [[-0.5776, -0.8239],
         [-0.5776, -0.8239],
         [-0.5776, -0.8239],
         [-0.5776, -0.8239],
         [-0.5776, -0.8239],
         [-0.5776, -0.8239],
         [-0.5776, -0.8239],
         [-0.5776, -0.8239],
         [-0.5776, -0.8239],
         [-0.5776, -0.8239]],
        [[-0.7090, -0.6775],
         [-0.7090, -0.6775],
         [-0.7090, -0.6775],
         [-0.7090, -0.6775],
         [-0.7090, -0.6775],
         [-0.7090, -0.6775],
         [-0.7090, -0.6775],
         [-0.7090, -0.6775],
         [-0.7090, -0.6775],
         [-0.7090, -0.6775]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.9341, -0.4991],
         [-0.9341, -0.4991],
         [-0.9341, -0.4991],
         [-0.9341, -0.4991],
         [-0.9341, -0.4991],
         [-0.9341, -0.4991],
         [-0.9341, -0.4991],
         [-0.9341, -0.4991],
         [-0.9341, -0.4991],
         [-0.9341, -0.4991]],
        [[-0.4152, -1.0795],
         [-0.4152, -1.0795],
         [-0.4152, -1.0795],
         [-0.4152, -1.0795],
         [-0.4152, -1.0795],
         [-0.4152, -1.0795],
         [-0.4152, -1.0795],
         [-0.4152, -1.0795],
         [-0.4152, -1.0795],
         [-0.4152, -1.0795]],
        [[-0.4507, -1.0138],
         [-0.4507, -1.0138],
         [-0.4507, -1.0138],
         [-0.4507, -1.0138],
         [-0.4507, -1.0138],
         [-0.4507, -1.0138],
         [-0.4507, -1.0138],
         [-0.4507, -1.0138],
         [-0.4507, -1.0138],
         [-0.4507, -1.0138]],
        [[-0.4540, -1.0081],
         [-0.4540, -1.0081],
         [-0.4540, -1.0081],
         [-0.4540, -1.0081],
         [-0.4540, -1.0081],
         [-0.4540, -1.0081],
         [-0.4540, -1.0081],
         [-0.4540, -1.0081],
         [-0.4540, -1.0081],
         [-0.4540, -1.0081]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6288, -0.7619],
         [-0.6288, -0.7619],
         [-0.6288, -0.7619],
         [-0.6288, -0.7619],
         [-0.6288, -0.7619],
         [-0.6288, -0.7619],
         [-0.6288, -0.7619],
         [-0.6288, -0.7619],
         [-0.6288, -0.7619],
         [-0.6288, -0.7619]],
        [[-0.6061, -0.7885],
         [-0.6061, -0.7885],
         [-0.6061, -0.7885],
         [-0.6061, -0.7885],
         [-0.6061, -0.7885],
         [-0.6061, -0.7885],
         [-0.6061, -0.7885],
         [-0.6061, -0.7885],
         [-0.6061, -0.7885],
         [-0.6061, -0.7885]],
        [[-0.3400, -1.2440],
         [-0.3400, -1.2440],
         [-0.3400, -1.2440],
         [-0.3400, -1.2440],
         [-0.3400, -1.2440],
         [-0.3400, -1.2440],
         [-0.3400, -1.2440],
         [-0.3400, -1.2440],
         [-0.3400, -1.2440],
         [-0.3400, -1.2440]],
        [[-0.5002, -0.9324],
         [-0.5002, -0.9324],
         [-0.5002, -0.9324],
         [-0.5002, -0.9324],
         [-0.5002, -0.9324],
         [-0.5002, -0.9324],
         [-0.5002, -0.9324],
         [-0.5002, -0.9324],
         [-0.5002, -0.9324],
         [-0.5002, -0.9324]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6204, -0.7716],
         [-0.6204, -0.7716],
         [-0.6204, -0.7716],
         [-0.6204, -0.7716],
         [-0.6204, -0.7716],
         [-0.6204, -0.7716],
         [-0.6204, -0.7716],
         [-0.6204, -0.7716],
         [-0.6204, -0.7716],
         [-0.6204, -0.7716]],
        [[-0.9207, -0.5079],
         [-0.9207, -0.5079],
         [-0.9207, -0.5079],
         [-0.9207, -0.5079],
         [-0.9207, -0.5079],
         [-0.9207, -0.5079],
         [-0.9207, -0.5079],
         [-0.9207, -0.5079],
         [-0.9207, -0.5079],
         [-0.9207, -0.5079]],
        [[-0.9211, -0.5077],
         [-0.9211, -0.5077],
         [-0.9211, -0.5077],
         [-0.9211, -0.5077],
         [-0.9211, -0.5077],
         [-0.9211, -0.5077],
         [-0.9211, -0.5077],
         [-0.9211, -0.5077],
         [-0.9211, -0.5077],
         [-0.9211, -0.5077]],
        [[-0.5723, -0.8307],
         [-0.5723, -0.8307],
         [-0.5723, -0.8307],
         [-0.5723, -0.8307],
         [-0.5723, -0.8307],
         [-0.5723, -0.8307],
         [-0.5723, -0.8307],
         [-0.5723, -0.8307],
         [-0.5723, -0.8307],
         [-0.5723, -0.8307]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6688, -0.7181],
         [-0.6688, -0.7181],
         [-0.6688, -0.7181],
         [-0.6688, -0.7181],
         [-0.6688, -0.7181],
         [-0.6688, -0.7181],
         [-0.6688, -0.7181],
         [-0.6688, -0.7181],
         [-0.6688, -0.7181],
         [-0.6688, -0.7181]],
        [[-0.6143, -0.7787],
         [-0.6143, -0.7787],
         [-0.6143, -0.7787],
         [-0.6143, -0.7787],
         [-0.6143, -0.7787],
         [-0.6143, -0.7787],
         [-0.6143, -0.7787],
         [-0.6143, -0.7787],
         [-0.6143, -0.7787],
         [-0.6143, -0.7787]],
        [[-0.9394, -0.4957],
         [-0.9394, -0.4957],
         [-0.9394, -0.4957],
         [-0.9394, -0.4957],
         [-0.9394, -0.4957],
         [-0.9394, -0.4957],
         [-0.9394, -0.4957],
         [-0.9394, -0.4957],
         [-0.9394, -0.4957],
         [-0.9394, -0.4957]],
        [[-0.6799, -0.7066],
         [-0.6799, -0.7066],
         [-0.6799, -0.7066],
         [-0.6799, -0.7066],
         [-0.6799, -0.7066],
         [-0.6799, -0.7066],
         [-0.6799, -0.7066],
         [-0.6799, -0.7066],
         [-0.6799, -0.7066],
         [-0.6799, -0.7066]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.9113, -0.5142],
         [-0.9113, -0.5142],
         [-0.9113, -0.5142],
         [-0.9113, -0.5142],
         [-0.9113, -0.5142],
         [-0.9113, -0.5142],
         [-0.9113, -0.5142],
         [-0.9113, -0.5142],
         [-0.9113, -0.5142],
         [-0.9113, -0.5142]],
        [[-0.4688, -0.9828],
         [-0.4688, -0.9828],
         [-0.4688, -0.9828],
         [-0.4688, -0.9828],
         [-0.4688, -0.9828],
         [-0.4688, -0.9828],
         [-0.4688, -0.9828],
         [-0.4688, -0.9828],
         [-0.4688, -0.9828],
         [-0.4688, -0.9828]],
        [[-0.5907, -0.8073],
         [-0.5907, -0.8073],
         [-0.5907, -0.8073],
         [-0.5907, -0.8073],
         [-0.5907, -0.8073],
         [-0.5907, -0.8073],
         [-0.5907, -0.8073],
         [-0.5907, -0.8073],
         [-0.5907, -0.8073],
         [-0.5907, -0.8073]],
        [[-0.4539, -1.0082],
         [-0.4539, -1.0082],
         [-0.4539, -1.0082],
         [-0.4539, -1.0082],
         [-0.4539, -1.0082],
         [-0.4539, -1.0082],
         [-0.4539, -1.0082],
         [-0.4539, -1.0082],
         [-0.4539, -1.0082],
         [-0.4539, -1.0082]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4666, -0.9865],
         [-0.4666, -0.9865],
         [-0.4666, -0.9865],
         [-0.4666, -0.9865],
         [-0.4666, -0.9865],
         [-0.4666, -0.9865],
         [-0.4666, -0.9865],
         [-0.4666, -0.9865],
         [-0.4666, -0.9865],
         [-0.4666, -0.9865]],
        [[-0.6118, -0.7817],
         [-0.6118, -0.7817],
         [-0.6118, -0.7817],
         [-0.6118, -0.7817],
         [-0.6118, -0.7817],
         [-0.6118, -0.7817],
         [-0.6118, -0.7817],
         [-0.6118, -0.7817],
         [-0.6118, -0.7817],
         [-0.6118, -0.7817]],
        [[-0.7588, -0.6316],
         [-0.7588, -0.6316],
         [-0.7588, -0.6316],
         [-0.7588, -0.6316],
         [-0.7588, -0.6316],
         [-0.7588, -0.6316],
         [-0.7588, -0.6316],
         [-0.7588, -0.6316],
         [-0.7588, -0.6316],
         [-0.7588, -0.6316]],
        [[-0.6773, -0.7092],
         [-0.6773, -0.7092],
         [-0.6773, -0.7092],
         [-0.6773, -0.7092],
         [-0.6773, -0.7092],
         [-0.6773, -0.7092],
         [-0.6773, -0.7092],
         [-0.6773, -0.7092],
         [-0.6773, -0.7092],
         [-0.6773, -0.7092]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5128, -0.9133],
         [-0.5128, -0.9133],
         [-0.5128, -0.9133],
         [-0.5128, -0.9133],
         [-0.5128, -0.9133],
         [-0.5128, -0.9133],
         [-0.5128, -0.9133],
         [-0.5128, -0.9133],
         [-0.5128, -0.9133],
         [-0.5128, -0.9133]],
        [[-0.9321, -0.5005],
         [-0.9321, -0.5005],
         [-0.9321, -0.5005],
         [-0.9321, -0.5005],
         [-0.9321, -0.5005],
         [-0.9321, -0.5005],
         [-0.9321, -0.5005],
         [-0.9321, -0.5005],
         [-0.9321, -0.5005],
         [-0.9321, -0.5005]],
        [[-0.5948, -0.8022],
         [-0.5948, -0.8022],
         [-0.5948, -0.8022],
         [-0.5948, -0.8022],
         [-0.5948, -0.8022],
         [-0.5948, -0.8022],
         [-0.5948, -0.8022],
         [-0.5948, -0.8022],
         [-0.5948, -0.8022],
         [-0.5948, -0.8022]],
        [[-0.4644, -0.9902],
         [-0.4644, -0.9902],
         [-0.4644, -0.9902],
         [-0.4644, -0.9902],
         [-0.4644, -0.9902],
         [-0.4644, -0.9902],
         [-0.4644, -0.9902],
         [-0.4644, -0.9902],
         [-0.4644, -0.9902],
         [-0.4644, -0.9902]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.9154, -0.5114],
         [-0.9154, -0.5114],
         [-0.9154, -0.5114],
         [-0.9154, -0.5114],
         [-0.9154, -0.5114],
         [-0.9154, -0.5114],
         [-0.9154, -0.5114],
         [-0.9154, -0.5114],
         [-0.9154, -0.5114],
         [-0.9154, -0.5114]],
        [[-0.8001, -0.5965],
         [-0.8001, -0.5965],
         [-0.8001, -0.5965],
         [-0.8001, -0.5965],
         [-0.8001, -0.5965],
         [-0.8001, -0.5965],
         [-0.8001, -0.5965],
         [-0.8001, -0.5965],
         [-0.8001, -0.5965],
         [-0.8001, -0.5965]],
        [[-0.8360, -0.5682],
         [-0.8360, -0.5682],
         [-0.8360, -0.5682],
         [-0.8360, -0.5682],
         [-0.8360, -0.5682],
         [-0.8360, -0.5682],
         [-0.8360, -0.5682],
         [-0.8360, -0.5682],
         [-0.8360, -0.5682],
         [-0.8360, -0.5682]],
        [[-0.9292, -0.5023],
         [-0.9292, -0.5023],
         [-0.9292, -0.5023],
         [-0.9292, -0.5023],
         [-0.9292, -0.5023],
         [-0.9292, -0.5023],
         [-0.9292, -0.5023],
         [-0.9292, -0.5023],
         [-0.9292, -0.5023],
         [-0.9292, -0.5023]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7624, -0.6283],
         [-0.7624, -0.6283],
         [-0.7624, -0.6283],
         [-0.7624, -0.6283],
         [-0.7624, -0.6283],
         [-0.7624, -0.6283],
         [-0.7624, -0.6283],
         [-0.7624, -0.6283],
         [-0.7624, -0.6283],
         [-0.7624, -0.6283]],
        [[-0.5540, -0.8548],
         [-0.5540, -0.8548],
         [-0.5540, -0.8548],
         [-0.5540, -0.8548],
         [-0.5540, -0.8548],
         [-0.5540, -0.8548],
         [-0.5540, -0.8548],
         [-0.5540, -0.8548],
         [-0.5540, -0.8548],
         [-0.5540, -0.8548]],
        [[-0.8917, -0.5276],
         [-0.8917, -0.5276],
         [-0.8917, -0.5276],
         [-0.8917, -0.5276],
         [-0.8917, -0.5276],
         [-0.8917, -0.5276],
         [-0.8917, -0.5276],
         [-0.8917, -0.5276],
         [-0.8917, -0.5276],
         [-0.8917, -0.5276]],
        [[-0.8007, -0.5961],
         [-0.8007, -0.5961],
         [-0.8007, -0.5961],
         [-0.8007, -0.5961],
         [-0.8007, -0.5961],
         [-0.8007, -0.5961],
         [-0.8007, -0.5961],
         [-0.8007, -0.5961],
         [-0.8007, -0.5961],
         [-0.8007, -0.5961]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6931, -0.6932],
         [-0.6931, -0.6932],
         [-0.6931, -0.6932],
         [-0.6931, -0.6932],
         [-0.6931, -0.6932],
         [-0.6931, -0.6932],
         [-0.6931, -0.6932],
         [-0.6931, -0.6932],
         [-0.6931, -0.6932],
         [-0.6931, -0.6932]],
        [[-0.8162, -0.5836],
         [-0.8162, -0.5836],
         [-0.8162, -0.5836],
         [-0.8162, -0.5836],
         [-0.8162, -0.5836],
         [-0.8162, -0.5836],
         [-0.8162, -0.5836],
         [-0.8162, -0.5836],
         [-0.8162, -0.5836],
         [-0.8162, -0.5836]],
        [[-0.9316, -0.5008],
         [-0.9316, -0.5008],
         [-0.9316, -0.5008],
         [-0.9316, -0.5008],
         [-0.9316, -0.5008],
         [-0.9316, -0.5008],
         [-0.9316, -0.5008],
         [-0.9316, -0.5008],
         [-0.9316, -0.5008],
         [-0.9316, -0.5008]],
        [[-0.6327, -0.7575],
         [-0.6327, -0.7575],
         [-0.6327, -0.7575],
         [-0.6327, -0.7575],
         [-0.6327, -0.7575],
         [-0.6327, -0.7575],
         [-0.6327, -0.7575],
         [-0.6327, -0.7575],
         [-0.6327, -0.7575],
         [-0.6327, -0.7575]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4843, -0.9574],
         [-0.4843, -0.9574],
         [-0.4843, -0.9574],
         [-0.4843, -0.9574],
         [-0.4843, -0.9574],
         [-0.4843, -0.9574],
         [-0.4843, -0.9574],
         [-0.4843, -0.9574],
         [-0.4843, -0.9574],
         [-0.4843, -0.9574]],
        [[-0.7883, -0.6063],
         [-0.7883, -0.6063],
         [-0.7883, -0.6063],
         [-0.7883, -0.6063],
         [-0.7883, -0.6063],
         [-0.7883, -0.6063],
         [-0.7883, -0.6063],
         [-0.7883, -0.6063],
         [-0.7883, -0.6063],
         [-0.7883, -0.6063]],
        [[-0.8709, -0.5423],
         [-0.8709, -0.5423],
         [-0.8709, -0.5423],
         [-0.8709, -0.5423],
         [-0.8709, -0.5423],
         [-0.8709, -0.5423],
         [-0.8709, -0.5423],
         [-0.8709, -0.5423],
         [-0.8709, -0.5423],
         [-0.8709, -0.5423]],
        [[-0.6442, -0.7447],
         [-0.6442, -0.7447],
         [-0.6442, -0.7447],
         [-0.6442, -0.7447],
         [-0.6442, -0.7447],
         [-0.6442, -0.7447],
         [-0.6442, -0.7447],
         [-0.6442, -0.7447],
         [-0.6442, -0.7447],
         [-0.6442, -0.7447]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7969, -0.5991],
         [-0.7969, -0.5991],
         [-0.7969, -0.5991],
         [-0.7969, -0.5991],
         [-0.7969, -0.5991],
         [-0.7969, -0.5991],
         [-0.7969, -0.5991],
         [-0.7969, -0.5991],
         [-0.7969, -0.5991],
         [-0.7969, -0.5991]],
        [[-0.9335, -0.4995],
         [-0.9335, -0.4995],
         [-0.9335, -0.4995],
         [-0.9335, -0.4995],
         [-0.9335, -0.4995],
         [-0.9335, -0.4995],
         [-0.9335, -0.4995],
         [-0.9335, -0.4995],
         [-0.9335, -0.4995],
         [-0.9335, -0.4995]],
        [[-0.9389, -0.4960],
         [-0.9389, -0.4960],
         [-0.9389, -0.4960],
         [-0.9389, -0.4960],
         [-0.9389, -0.4960],
         [-0.9389, -0.4960],
         [-0.9389, -0.4960],
         [-0.9389, -0.4960],
         [-0.9389, -0.4960],
         [-0.9389, -0.4960]],
        [[-0.7627, -0.6282],
         [-0.7627, -0.6282],
         [-0.7627, -0.6282],
         [-0.7627, -0.6282],
         [-0.7627, -0.6282],
         [-0.7627, -0.6282],
         [-0.7627, -0.6282],
         [-0.7627, -0.6282],
         [-0.7627, -0.6282],
         [-0.7627, -0.6282]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.9589, -0.4834],
         [-0.9589, -0.4834],
         [-0.9589, -0.4834],
         [-0.9589, -0.4834],
         [-0.9589, -0.4834],
         [-0.9589, -0.4834],
         [-0.9589, -0.4834],
         [-0.9589, -0.4834],
         [-0.9589, -0.4834],
         [-0.9589, -0.4834]],
        [[-0.6893, -0.6970],
         [-0.6893, -0.6970],
         [-0.6893, -0.6970],
         [-0.6893, -0.6970],
         [-0.6893, -0.6970],
         [-0.6893, -0.6970],
         [-0.6893, -0.6970],
         [-0.6893, -0.6970],
         [-0.6893, -0.6970],
         [-0.6893, -0.6970]],
        [[-0.9107, -0.5145],
         [-0.9107, -0.5145],
         [-0.9107, -0.5145],
         [-0.9107, -0.5145],
         [-0.9107, -0.5145],
         [-0.9107, -0.5145],
         [-0.9107, -0.5145],
         [-0.9107, -0.5145],
         [-0.9107, -0.5145],
         [-0.9107, -0.5145]],
        [[-0.6284, -0.7623],
         [-0.6284, -0.7623],
         [-0.6284, -0.7623],
         [-0.6284, -0.7623],
         [-0.6284, -0.7623],
         [-0.6284, -0.7623],
         [-0.6284, -0.7623],
         [-0.6284, -0.7623],
         [-0.6284, -0.7623],
         [-0.6284, -0.7623]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5369, -0.8784],
         [-0.5369, -0.8784],
         [-0.5369, -0.8784],
         [-0.5369, -0.8784],
         [-0.5369, -0.8784],
         [-0.5369, -0.8784],
         [-0.5369, -0.8784],
         [-0.5369, -0.8784],
         [-0.5369, -0.8784],
         [-0.5369, -0.8784]],
        [[-0.9512, -0.4882],
         [-0.9512, -0.4882],
         [-0.9512, -0.4882],
         [-0.9512, -0.4882],
         [-0.9512, -0.4882],
         [-0.9512, -0.4882],
         [-0.9512, -0.4882],
         [-0.9512, -0.4882],
         [-0.9512, -0.4882],
         [-0.9512, -0.4882]],
        [[-0.8184, -0.5818],
         [-0.8184, -0.5818],
         [-0.8184, -0.5818],
         [-0.8184, -0.5818],
         [-0.8184, -0.5818],
         [-0.8184, -0.5818],
         [-0.8184, -0.5818],
         [-0.8184, -0.5818],
         [-0.8184, -0.5818],
         [-0.8184, -0.5818]],
        [[-0.7118, -0.6748],
         [-0.7118, -0.6748],
         [-0.7118, -0.6748],
         [-0.7118, -0.6748],
         [-0.7118, -0.6748],
         [-0.7118, -0.6748],
         [-0.7118, -0.6748],
         [-0.7118, -0.6748],
         [-0.7118, -0.6748],
         [-0.7118, -0.6748]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5523, -0.8572],
         [-0.5523, -0.8572],
         [-0.5523, -0.8572],
         [-0.5523, -0.8572],
         [-0.5523, -0.8572],
         [-0.5523, -0.8572],
         [-0.5523, -0.8572],
         [-0.5523, -0.8572],
         [-0.5523, -0.8572],
         [-0.5523, -0.8572]],
        [[-0.9256, -0.5046],
         [-0.9256, -0.5046],
         [-0.9256, -0.5046],
         [-0.9256, -0.5046],
         [-0.9256, -0.5046],
         [-0.9256, -0.5046],
         [-0.9256, -0.5046],
         [-0.9256, -0.5046],
         [-0.9256, -0.5046],
         [-0.9256, -0.5046]],
        [[-0.5629, -0.8429],
         [-0.5629, -0.8429],
         [-0.5629, -0.8429],
         [-0.5629, -0.8429],
         [-0.5629, -0.8429],
         [-0.5629, -0.8429],
         [-0.5629, -0.8429],
         [-0.5629, -0.8429],
         [-0.5629, -0.8429],
         [-0.5629, -0.8429]],
        [[-0.6225, -0.7692],
         [-0.6225, -0.7692],
         [-0.6225, -0.7692],
         [-0.6225, -0.7692],
         [-0.6225, -0.7692],
         [-0.6225, -0.7692],
         [-0.6225, -0.7692],
         [-0.6225, -0.7692],
         [-0.6225, -0.7692],
         [-0.6225, -0.7692]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7173, -0.6696],
         [-0.7173, -0.6696],
         [-0.7173, -0.6696],
         [-0.7173, -0.6696],
         [-0.7173, -0.6696],
         [-0.7173, -0.6696],
         [-0.7173, -0.6696],
         [-0.7173, -0.6696],
         [-0.7173, -0.6696],
         [-0.7173, -0.6696]],
        [[-0.5056, -0.9241],
         [-0.5056, -0.9241],
         [-0.5056, -0.9241],
         [-0.5056, -0.9241],
         [-0.5056, -0.9241],
         [-0.5056, -0.9241],
         [-0.5056, -0.9241],
         [-0.5056, -0.9241],
         [-0.5056, -0.9241],
         [-0.5056, -0.9241]],
        [[-0.9655, -0.4793],
         [-0.9655, -0.4793],
         [-0.9655, -0.4793],
         [-0.9655, -0.4793],
         [-0.9655, -0.4793],
         [-0.9655, -0.4793],
         [-0.9655, -0.4793],
         [-0.9655, -0.4793],
         [-0.9655, -0.4793],
         [-0.9655, -0.4793]],
        [[-0.9763, -0.4727],
         [-0.9763, -0.4727],
         [-0.9763, -0.4727],
         [-0.9763, -0.4727],
         [-0.9763, -0.4727],
         [-0.9763, -0.4727],
         [-0.9763, -0.4727],
         [-0.9763, -0.4727],
         [-0.9763, -0.4727],
         [-0.9763, -0.4727]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4319, -1.0477],
         [-0.4319, -1.0477],
         [-0.4319, -1.0477],
         [-0.4319, -1.0477],
         [-0.4319, -1.0477],
         [-0.4319, -1.0477],
         [-0.4319, -1.0477],
         [-0.4319, -1.0477],
         [-0.4319, -1.0477],
         [-0.4319, -1.0477]],
        [[-0.9741, -0.4741],
         [-0.9741, -0.4741],
         [-0.9741, -0.4741],
         [-0.9741, -0.4741],
         [-0.9741, -0.4741],
         [-0.9741, -0.4741],
         [-0.9741, -0.4741],
         [-0.9741, -0.4741],
         [-0.9741, -0.4741],
         [-0.9741, -0.4741]],
        [[-0.4689, -0.9827],
         [-0.4689, -0.9827],
         [-0.4689, -0.9827],
         [-0.4689, -0.9827],
         [-0.4689, -0.9827],
         [-0.4689, -0.9827],
         [-0.4689, -0.9827],
         [-0.4689, -0.9827],
         [-0.4689, -0.9827],
         [-0.4689, -0.9827]],
        [[-0.7897, -0.6051],
         [-0.7897, -0.6051],
         [-0.7897, -0.6051],
         [-0.7897, -0.6051],
         [-0.7897, -0.6051],
         [-0.7897, -0.6051],
         [-0.7897, -0.6051],
         [-0.7897, -0.6051],
         [-0.7897, -0.6051],
         [-0.7897, -0.6051]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.8474, -0.5595],
         [-0.8474, -0.5595],
         [-0.8474, -0.5595],
         [-0.8474, -0.5595],
         [-0.8474, -0.5595],
         [-0.8474, -0.5595],
         [-0.8474, -0.5595],
         [-0.8474, -0.5595],
         [-0.8474, -0.5595],
         [-0.8474, -0.5595]],
        [[-0.8358, -0.5684],
         [-0.8358, -0.5684],
         [-0.8358, -0.5684],
         [-0.8358, -0.5684],
         [-0.8358, -0.5684],
         [-0.8358, -0.5684],
         [-0.8358, -0.5684],
         [-0.8358, -0.5684],
         [-0.8358, -0.5684],
         [-0.8358, -0.5684]],
        [[-0.8554, -0.5536],
         [-0.8554, -0.5536],
         [-0.8554, -0.5536],
         [-0.8554, -0.5536],
         [-0.8554, -0.5536],
         [-0.8554, -0.5536],
         [-0.8554, -0.5536],
         [-0.8554, -0.5536],
         [-0.8554, -0.5536],
         [-0.8554, -0.5536]],
        [[-0.9659, -0.4791],
         [-0.9659, -0.4791],
         [-0.9659, -0.4791],
         [-0.9659, -0.4791],
         [-0.9659, -0.4791],
         [-0.9659, -0.4791],
         [-0.9659, -0.4791],
         [-0.9659, -0.4791],
         [-0.9659, -0.4791],
         [-0.9659, -0.4791]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.0039, -0.4564],
         [-1.0039, -0.4564],
         [-1.0039, -0.4564],
         [-1.0039, -0.4564],
         [-1.0039, -0.4564],
         [-1.0039, -0.4564],
         [-1.0039, -0.4564],
         [-1.0039, -0.4564],
         [-1.0039, -0.4564],
         [-1.0039, -0.4564]],
        [[-0.3575, -1.2021],
         [-0.3575, -1.2021],
         [-0.3575, -1.2021],
         [-0.3575, -1.2021],
         [-0.3575, -1.2021],
         [-0.3575, -1.2021],
         [-0.3575, -1.2021],
         [-0.3575, -1.2021],
         [-0.3575, -1.2021],
         [-0.3575, -1.2021]],
        [[-0.5637, -0.8418],
         [-0.5637, -0.8418],
         [-0.5637, -0.8418],
         [-0.5637, -0.8418],
         [-0.5637, -0.8418],
         [-0.5637, -0.8418],
         [-0.5637, -0.8418],
         [-0.5637, -0.8418],
         [-0.5637, -0.8418],
         [-0.5637, -0.8418]],
        [[-0.9689, -0.4772],
         [-0.9689, -0.4772],
         [-0.9689, -0.4772],
         [-0.9689, -0.4772],
         [-0.9689, -0.4772],
         [-0.9689, -0.4772],
         [-0.9689, -0.4772],
         [-0.9689, -0.4772],
         [-0.9689, -0.4772],
         [-0.9689, -0.4772]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4774, -0.9686],
         [-0.4774, -0.9686],
         [-0.4774, -0.9686],
         [-0.4774, -0.9686],
         [-0.4774, -0.9686],
         [-0.4774, -0.9686],
         [-0.4774, -0.9686],
         [-0.4774, -0.9686],
         [-0.4774, -0.9686],
         [-0.4774, -0.9686]],
        [[-0.4622, -0.9940],
         [-0.4622, -0.9940],
         [-0.4622, -0.9940],
         [-0.4622, -0.9940],
         [-0.4622, -0.9940],
         [-0.4622, -0.9940],
         [-0.4622, -0.9940],
         [-0.4622, -0.9940],
         [-0.4622, -0.9940],
         [-0.4622, -0.9940]],
        [[-0.8207, -0.5801],
         [-0.8207, -0.5801],
         [-0.8207, -0.5801],
         [-0.8207, -0.5801],
         [-0.8207, -0.5801],
         [-0.8207, -0.5801],
         [-0.8207, -0.5801],
         [-0.8207, -0.5801],
         [-0.8207, -0.5801],
         [-0.8207, -0.5801]],
        [[-0.5558, -0.8524],
         [-0.5558, -0.8524],
         [-0.5558, -0.8524],
         [-0.5558, -0.8524],
         [-0.5558, -0.8524],
         [-0.5558, -0.8524],
         [-0.5558, -0.8524],
         [-0.5558, -0.8524],
         [-0.5558, -0.8524],
         [-0.5558, -0.8524]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7542, -0.6356],
         [-0.7542, -0.6356],
         [-0.7542, -0.6356],
         [-0.7542, -0.6356],
         [-0.7542, -0.6356],
         [-0.7542, -0.6356],
         [-0.7542, -0.6356],
         [-0.7542, -0.6356],
         [-0.7542, -0.6356],
         [-0.7542, -0.6356]],
        [[-0.7572, -0.6330],
         [-0.7572, -0.6330],
         [-0.7572, -0.6330],
         [-0.7572, -0.6330],
         [-0.7572, -0.6330],
         [-0.7572, -0.6330],
         [-0.7572, -0.6330],
         [-0.7572, -0.6330],
         [-0.7572, -0.6330],
         [-0.7572, -0.6330]],
        [[-1.0054, -0.4555],
         [-1.0054, -0.4555],
         [-1.0054, -0.4555],
         [-1.0054, -0.4555],
         [-1.0054, -0.4555],
         [-1.0054, -0.4555],
         [-1.0054, -0.4555],
         [-1.0054, -0.4555],
         [-1.0054, -0.4555],
         [-1.0054, -0.4555]],
        [[-0.6098, -0.7840],
         [-0.6098, -0.7840],
         [-0.6098, -0.7840],
         [-0.6098, -0.7840],
         [-0.6098, -0.7840],
         [-0.6098, -0.7840],
         [-0.6098, -0.7840],
         [-0.6098, -0.7840],
         [-0.6098, -0.7840],
         [-0.6098, -0.7840]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5757, -0.8262],
         [-0.5757, -0.8262],
         [-0.5757, -0.8262],
         [-0.5757, -0.8262],
         [-0.5757, -0.8262],
         [-0.5757, -0.8262],
         [-0.5757, -0.8262],
         [-0.5757, -0.8262],
         [-0.5757, -0.8262],
         [-0.5757, -0.8262]],
        [[-0.3370, -1.2515],
         [-0.3370, -1.2515],
         [-0.3370, -1.2515],
         [-0.3370, -1.2515],
         [-0.3370, -1.2515],
         [-0.3370, -1.2515],
         [-0.3370, -1.2515],
         [-0.3370, -1.2515],
         [-0.3370, -1.2515],
         [-0.3370, -1.2515]],
        [[-0.4722, -0.9772],
         [-0.4722, -0.9772],
         [-0.4722, -0.9772],
         [-0.4722, -0.9772],
         [-0.4722, -0.9772],
         [-0.4722, -0.9772],
         [-0.4722, -0.9772],
         [-0.4722, -0.9772],
         [-0.4722, -0.9772],


Online Simulation:   3%|▎         | 250/9306 [00:09<05:09, 29.26it/s]
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5258, -0.8942],
         [-0.5258, -0.8942],
         [-0.5258, -0.8942],
         [-0.5258, -0.8942],
         [-0.5258, -0.8942],
         [-0.5258, -0.8942],
         [-0.5258, -0.8942],
         [-0.5258, -0.8942],
         [-0.5258, -0.8942],
         [-0.5258, -0.8942]],
        [[-0.5330, -0.8839],
         [-0.5330, -0.8839],
         [-0.5330, -0.8839],
         [-0.5330, -0.8839],
         [-0.5330, -0.8839],
         [-0.5330, -0.8839],
         [-0.5330, -0.8839],
         [-0.5330, -0.8839],
         [-0.5330, -0.8839],
         [-0.5330, -0.8839]],
        [[-1.1211, -0.3944],
         [-1.1211, -0.3944],
         [-1.1211, -0.3944],
         [-1.1211, -0.3944],
         [-1.1211, -0.3944],
         [-1.1211, -0.3944],
         [-1.1211, -0.3944],
         [-1.1211, -0.3944],
         [-1.1211, -0.3944],
         [-1.1211, -0.3944]],
        [[-0.8289, -0.5736],
         [-0.8289, -0.5736],
         [-0.8289, -0.5736],
         [-0.8289, -0.5736],
         [-0.8289, -0.5736],
         [-0.8289, -0.5736],
         [-0.8289, -0.5736],
         [-0.8289, -0.5736],
         [-0.8289, -0.5736],
         [-0.8289, -0.5736]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7943, -0.6013],
         [-0.7943, -0.6013],
         [-0.7943, -0.6013],
         [-0.7943, -0.6013],
         [-0.7943, -0.6013],
         [-0.7943, -0.6013],
         [-0.7943, -0.6013],
         [-0.7943, -0.6013],
         [-0.7943, -0.6013],
         [-0.7943, -0.6013]],
        [[-0.3372, -1.2511],
         [-0.3372, -1.2511],
         [-0.3372, -1.2511],
         [-0.3372, -1.2511],
         [-0.3372, -1.2511],
         [-0.3372, -1.2511],
         [-0.3372, -1.2511],
         [-0.3372, -1.2511],
         [-0.3372, -1.2511],
         [-0.3372, -1.2511]],
        [[-0.4221, -1.0662],
         [-0.4221, -1.0662],
         [-0.4221, -1.0662],
         [-0.4221, -1.0662],
         [-0.4221, -1.0662],
         [-0.4221, -1.0662],
         [-0.4221, -1.0662],
         [-0.4221, -1.0662],
         [-0.4221, -1.0662],
         [-0.4221, -1.0662]],
        [[-0.6269, -0.7641],
         [-0.6269, -0.7641],
         [-0.6269, -0.7641],
         [-0.6269, -0.7641],
         [-0.6269, -0.7641],
         [-0.6269, -0.7641],
         [-0.6269, -0.7641],
         [-0.6269, -0.7641],
         [-0.6269, -0.7641],
         [-0.6269, -0.7641]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7483, -0.6409],
         [-0.7483, -0.6409],
         [-0.7483, -0.6409],
         [-0.7483, -0.6409],
         [-0.7483, -0.6409],
         [-0.7483, -0.6409],
         [-0.7483, -0.6409],
         [-0.7483, -0.6409],
         [-0.7483, -0.6409],
         [-0.7483, -0.6409]],
        [[-0.6021, -0.7933],
         [-0.6021, -0.7933],
         [-0.6021, -0.7933],
         [-0.6021, -0.7933],
         [-0.6021, -0.7933],
         [-0.6021, -0.7933],
         [-0.6021, -0.7933],
         [-0.6021, -0.7933],
         [-0.6021, -0.7933],
         [-0.6021, -0.7933]],
        [[-0.3691, -1.1756],
         [-0.3691, -1.1756],
         [-0.3691, -1.1756],
         [-0.3691, -1.1756],
         [-0.3691, -1.1756],
         [-0.3691, -1.1756],
         [-0.3691, -1.1756],
         [-0.3691, -1.1756],
         [-0.3691, -1.1756],
         [-0.3691, -1.1756]],
        [[-0.2983, -1.3551],
         [-0.2983, -1.3551],
         [-0.2983, -1.3551],
         [-0.2983, -1.3551],
         [-0.2983, -1.3551],
         [-0.2983, -1.3551],
         [-0.2983, -1.3551],
         [-0.2983, -1.3551],
         [-0.2983, -1.3551],
         [-0.2983, -1.3551]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4675, -0.9849],
         [-0.4675, -0.9849],
         [-0.4675, -0.9849],
         [-0.4675, -0.9849],
         [-0.4675, -0.9849],
         [-0.4675, -0.9849],
         [-0.4675, -0.9849],
         [-0.4675, -0.9849],
         [-0.4675, -0.9849],
         [-0.4675, -0.9849]],
        [[-0.6879, -0.6985],
         [-0.6879, -0.6985],
         [-0.6879, -0.6985],
         [-0.6879, -0.6985],
         [-0.6879, -0.6985],
         [-0.6879, -0.6985],
         [-0.6879, -0.6985],
         [-0.6879, -0.6985],
         [-0.6879, -0.6985],
         [-0.6879, -0.6985]],
        [[-1.1856, -0.3647],
         [-1.1856, -0.3647],
         [-1.1856, -0.3647],
         [-1.1856, -0.3647],
         [-1.1856, -0.3647],
         [-1.1856, -0.3647],
         [-1.1856, -0.3647],
         [-1.1856, -0.3647],
         [-1.1856, -0.3647],
         [-1.1856, -0.3647]],
        [[-0.4242, -1.0622],
         [-0.4242, -1.0622],
         [-0.4242, -1.0622],
         [-0.4242, -1.0622],
         [-0.4242, -1.0622],
         [-0.4242, -1.0622],
         [-0.4242, -1.0622],
         [-0.4242, -1.0622],
         [-0.4242, -1.0622],
         [-0.4242, -1.0622]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5254, -0.8949],
         [-0.5254, -0.8949],
         [-0.5254, -0.8949],
         [-0.5254, -0.8949],
         [-0.5254, -0.8949],
         [-0.5254, -0.8949],
         [-0.5254, -0.8949],
         [-0.5254, -0.8949],
         [-0.5254, -0.8949],
         [-0.5254, -0.8949]],
        [[-1.0525, -0.4293],
         [-1.0525, -0.4293],
         [-1.0525, -0.4293],
         [-1.0525, -0.4293],
         [-1.0525, -0.4293],
         [-1.0525, -0.4293],
         [-1.0525, -0.4293],
         [-1.0525, -0.4293],
         [-1.0525, -0.4293],
         [-1.0525, -0.4293]],
        [[-0.5796, -0.8213],
         [-0.5796, -0.8213],
         [-0.5796, -0.8213],
         [-0.5796, -0.8213],
         [-0.5796, -0.8213],
         [-0.5796, -0.8213],
         [-0.5796, -0.8213],
         [-0.5796, -0.8213],
         [-0.5796, -0.8213],
         [-0.5796, -0.8213]],
        [[-0.6331, -0.7570],
         [-0.6331, -0.7570],
         [-0.6331, -0.7570],
         [-0.6331, -0.7570],
         [-0.6331, -0.7570],
         [-0.6331, -0.7570],
         [-0.6331, -0.7570],
         [-0.6331, -0.7570],
         [-0.6331, -0.7570],
         [-0.6331, -0.7570]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.9891, -0.4651],
         [-0.9891, -0.4651],
         [-0.9891, -0.4651],
         [-0.9891, -0.4651],
         [-0.9891, -0.4651],
         [-0.9891, -0.4651],
         [-0.9891, -0.4651],
         [-0.9891, -0.4651],
         [-0.9891, -0.4651],
         [-0.9891, -0.4651]],
        [[-0.5370, -0.8783],
         [-0.5370, -0.8783],
         [-0.5370, -0.8783],
         [-0.5370, -0.8783],
         [-0.5370, -0.8783],
         [-0.5370, -0.8783],
         [-0.5370, -0.8783],
         [-0.5370, -0.8783],
         [-0.5370, -0.8783],
         [-0.5370, -0.8783]],
        [[-0.4485, -1.0178],
         [-0.4485, -1.0178],
         [-0.4485, -1.0178],
         [-0.4485, -1.0178],
         [-0.4485, -1.0178],
         [-0.4485, -1.0178],
         [-0.4485, -1.0178],
         [-0.4485, -1.0178],
         [-0.4485, -1.0178],
         [-0.4485, -1.0178]],
        [[-1.1643, -0.3742],
         [-1.1643, -0.3742],
         [-1.1643, -0.3742],
         [-1.1643, -0.3742],
         [-1.1643, -0.3742],
         [-1.1643, -0.3742],
         [-1.1643, -0.3742],
         [-1.1643, -0.3742],
         [-1.1643, -0.3742],
         [-1.1643, -0.3742]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5524, -0.8570],
         [-0.5524, -0.8570],
         [-0.5524, -0.8570],
         [-0.5524, -0.8570],
         [-0.5524, -0.8570],
         [-0.5524, -0.8570],
         [-0.5524, -0.8570],
         [-0.5524, -0.8570],
         [-0.5524, -0.8570],
         [-0.5524, -0.8570]],
        [[-0.3004, -1.3490],
         [-0.3004, -1.3490],
         [-0.3004, -1.3490],
         [-0.3004, -1.3490],
         [-0.3004, -1.3490],
         [-0.3004, -1.3490],
         [-0.3004, -1.3490],
         [-0.3004, -1.3490],
         [-0.3004, -1.3490],
         [-0.3004, -1.3490]],
        [[-0.6881, -0.6983],
         [-0.6881, -0.6983],
         [-0.6881, -0.6983],
         [-0.6881, -0.6983],
         [-0.6881, -0.6983],
         [-0.6881, -0.6983],
         [-0.6881, -0.6983],
         [-0.6881, -0.6983],
         [-0.6881, -0.6983],
         [-0.6881, -0.6983]],
        [[-1.1682, -0.3724],
         [-1.1682, -0.3724],
         [-1.1682, -0.3724],
         [-1.1682, -0.3724],
         [-1.1682, -0.3724],
         [-1.1682, -0.3724],
         [-1.1682, -0.3724],
         [-1.1682, -0.3724],
         [-1.1682, -0.3724],
         [-1.1682, -0.3724]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.9191, -0.5089],
         [-0.9191, -0.5089],
         [-0.9191, -0.5089],
         [-0.9191, -0.5089],
         [-0.9191, -0.5089],
         [-0.9191, -0.5089],
         [-0.9191, -0.5089],
         [-0.9191, -0.5089],
         [-0.9191, -0.5089],
         [-0.9191, -0.5089]],
        [[-0.8900, -0.5287],
         [-0.8900, -0.5287],
         [-0.8900, -0.5287],
         [-0.8900, -0.5287],
         [-0.8900, -0.5287],
         [-0.8900, -0.5287],
         [-0.8900, -0.5287],
         [-0.8900, -0.5287],
         [-0.8900, -0.5287],
         [-0.8900, -0.5287]],
        [[-0.3269, -1.2772],
         [-0.3269, -1.2772],
         [-0.3269, -1.2772],
         [-0.3269, -1.2772],
         [-0.3269, -1.2772],
         [-0.3269, -1.2772],
         [-0.3269, -1.2772],
         [-0.3269, -1.2772],
         [-0.3269, -1.2772],
         [-0.3269, -1.2772]],
        [[-0.8547, -0.5541],
         [-0.8547, -0.5541],
         [-0.8547, -0.5541],
         [-0.8547, -0.5541],
         [-0.8547, -0.5541],
         [-0.8547, -0.5541],
         [-0.8547, -0.5541],
         [-0.8547, -0.5541],
         [-0.8547, -0.5541],
         [-0.8547, -0.5541]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5981, -0.7982],
         [-0.5981, -0.7982],
         [-0.5981, -0.7982],
         [-0.5981, -0.7982],
         [-0.5981, -0.7982],
         [-0.5981, -0.7982],
         [-0.5981, -0.7982],
         [-0.5981, -0.7982],
         [-0.5981, -0.7982],
         [-0.5981, -0.7982]],
        [[-0.3390, -1.2465],
         [-0.3390, -1.2465],
         [-0.3390, -1.2465],
         [-0.3390, -1.2465],
         [-0.3390, -1.2465],
         [-0.3390, -1.2465],
         [-0.3390, -1.2465],
         [-0.3390, -1.2465],
         [-0.3390, -1.2465],
         [-0.3390, -1.2465]],
        [[-0.6371, -0.7526],
         [-0.6371, -0.7526],
         [-0.6371, -0.7526],
         [-0.6371, -0.7526],
         [-0.6371, -0.7526],
         [-0.6371, -0.7526],
         [-0.6371, -0.7526],
         [-0.6371, -0.7526],
         [-0.6371, -0.7526],
         [-0.6371, -0.7526]],
        [[-0.4980, -0.9358],
         [-0.4980, -0.9358],
         [-0.4980, -0.9358],
         [-0.4980, -0.9358],
         [-0.4980, -0.9358],
         [-0.4980, -0.9358],
         [-0.4980, -0.9358],
         [-0.4980, -0.9358],
         [-0.4980, -0.9358],
         [-0.4980, -0.9358]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6487, -0.7396],
         [-0.6487, -0.7396],
         [-0.6487, -0.7396],
         [-0.6487, -0.7396],
         [-0.6487, -0.7396],
         [-0.6487, -0.7396],
         [-0.6487, -0.7396],
         [-0.6487, -0.7396],
         [-0.6487, -0.7396],
         [-0.6487, -0.7396]],
        [[-1.1894, -0.3630],
         [-1.1894, -0.3630],
         [-1.1894, -0.3630],
         [-1.1894, -0.3630],
         [-1.1894, -0.3630],
         [-1.1894, -0.3630],
         [-1.1894, -0.3630],
         [-1.1894, -0.3630],
         [-1.1894, -0.3630],
         [-1.1894, -0.3630]],
        [[-1.1708, -0.3712],
         [-1.1708, -0.3712],
         [-1.1708, -0.3712],
         [-1.1708, -0.3712],
         [-1.1708, -0.3712],
         [-1.1708, -0.3712],
         [-1.1708, -0.3712],
         [-1.1708, -0.3712],
         [-1.1708, -0.3712],
         [-1.1708, -0.3712]],
        [[-0.6139, -0.7792],
         [-0.6139, -0.7792],
         [-0.6139, -0.7792],
         [-0.6139, -0.7792],
         [-0.6139, -0.7792],
         [-0.6139, -0.7792],
         [-0.6139, -0.7792],
         [-0.6139, -0.7792],
         [-0.6139, -0.7792],
         [-0.6139, -0.7792]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5013, -0.9308],
         [-0.5013, -0.9308],
         [-0.5013, -0.9308],
         [-0.5013, -0.9308],
         [-0.5013, -0.9308],
         [-0.5013, -0.9308],
         [-0.5013, -0.9308],
         [-0.5013, -0.9308],
         [-0.5013, -0.9308],
         [-0.5013, -0.9308]],
        [[-0.8729, -0.5408],
         [-0.8729, -0.5408],
         [-0.8729, -0.5408],
         [-0.8729, -0.5408],
         [-0.8729, -0.5408],
         [-0.8729, -0.5408],
         [-0.8729, -0.5408],
         [-0.8729, -0.5408],
         [-0.8729, -0.5408],
         [-0.8729, -0.5408]],
        [[-0.4630, -0.9926],
         [-0.4630, -0.9926],
         [-0.4630, -0.9926],
         [-0.4630, -0.9926],
         [-0.4630, -0.9926],
         [-0.4630, -0.9926],
         [-0.4630, -0.9926],
         [-0.4630, -0.9926],
         [-0.4630, -0.9926],
         [-0.4630, -0.9926]],
        [[-1.1600, -0.3761],
         [-1.1600, -0.3761],
         [-1.1600, -0.3761],
         [-1.1600, -0.3761],
         [-1.1600, -0.3761],
         [-1.1600, -0.3761],
         [-1.1600, -0.3761],
         [-1.1600, -0.3761],
         [-1.1600, -0.3761],
         [-1.1600, -0.3761]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.2245, -0.3480],
         [-1.2245, -0.3480],
         [-1.2245, -0.3480],
         [-1.2245, -0.3480],
         [-1.2245, -0.3480],
         [-1.2245, -0.3480],
         [-1.2245, -0.3480],
         [-1.2245, -0.3480],
         [-1.2245, -0.3480],
         [-1.2245, -0.3480]],
        [[-0.3866, -1.1375],
         [-0.3866, -1.1375],
         [-0.3866, -1.1375],
         [-0.3866, -1.1375],
         [-0.3866, -1.1375],
         [-0.3866, -1.1375],
         [-0.3866, -1.1375],
         [-0.3866, -1.1375],
         [-0.3866, -1.1375],
         [-0.3866, -1.1375]],
        [[-0.4528, -1.0102],
         [-0.4528, -1.0102],
         [-0.4528, -1.0102],
         [-0.4528, -1.0102],
         [-0.4528, -1.0102],
         [-0.4528, -1.0102],
         [-0.4528, -1.0102],
         [-0.4528, -1.0102],
         [-0.4528, -1.0102],
         [-0.4528, -1.0102]],
        [[-0.9408, -0.4948],
         [-0.9408, -0.4948],
         [-0.9408, -0.4948],
         [-0.9408, -0.4948],
         [-0.9408, -0.4948],
         [-0.9408, -0.4948],
         [-0.9408, -0.4948],
         [-0.9408, -0.4948],
         [-0.9408, -0.4948],
         [-0.9408, -0.4948]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7554, -0.6345],
         [-0.7554, -0.6345],
         [-0.7554, -0.6345],
         [-0.7554, -0.6345],
         [-0.7554, -0.6345],
         [-0.7554, -0.6345],
         [-0.7554, -0.6345],
         [-0.7554, -0.6345],
         [-0.7554, -0.6345],
         [-0.7554, -0.6345]],
        [[-0.5237, -0.8973],
         [-0.5237, -0.8973],
         [-0.5237, -0.8973],
         [-0.5237, -0.8973],
         [-0.5237, -0.8973],
         [-0.5237, -0.8973],
         [-0.5237, -0.8973],
         [-0.5237, -0.8973],
         [-0.5237, -0.8973],
         [-0.5237, -0.8973]],
        [[-0.3555, -1.2067],
         [-0.3555, -1.2067],
         [-0.3555, -1.2067],
         [-0.3555, -1.2067],
         [-0.3555, -1.2067],
         [-0.3555, -1.2067],
         [-0.3555, -1.2067],
         [-0.3555, -1.2067],
         [-0.3555, -1.2067],
         [-0.3555, -1.2067]],
        [[-0.4762, -0.9705],
         [-0.4762, -0.9705],
         [-0.4762, -0.9705],
         [-0.4762, -0.9705],
         [-0.4762, -0.9705],
         [-0.4762, -0.9705],
         [-0.4762, -0.9705],
         [-0.4762, -0.9705],
         [-0.4762, -0.9705],
         [-0.4762, -0.9705]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4137, -1.0823],
         [-0.4137, -1.0823],
         [-0.4137, -1.0823],
         [-0.4137, -1.0823],
         [-0.4137, -1.0823],
         [-0.4137, -1.0823],
         [-0.4137, -1.0823],
         [-0.4137, -1.0823],
         [-0.4137, -1.0823],
         [-0.4137, -1.0823]],
        [[-0.6005, -0.7953],
         [-0.6005, -0.7953],
         [-0.6005, -0.7953],
         [-0.6005, -0.7953],
         [-0.6005, -0.7953],
         [-0.6005, -0.7953],
         [-0.6005, -0.7953],
         [-0.6005, -0.7953],
         [-0.6005, -0.7953],
         [-0.6005, -0.7953]],
        [[-0.9954, -0.4613],
         [-0.9954, -0.4613],
         [-0.9954, -0.4613],
         [-0.9954, -0.4613],
         [-0.9954, -0.4613],
         [-0.9954, -0.4613],
         [-0.9954, -0.4613],
         [-0.9954, -0.4613],
         [-0.9954, -0.4613],
         [-0.9954, -0.4613]],
        [[-0.5890, -0.8094],
         [-0.5890, -0.8094],
         [-0.5890, -0.8094],
         [-0.5890, -0.8094],
         [-0.5890, -0.8094],
         [-0.5890, -0.8094],
         [-0.5890, -0.8094],
         [-0.5890, -0.8094],
         [-0.5890, -0.8094],
         [-0.5890, -0.8094]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.3778, -1.1562],
         [-0.3778, -1.1562],
         [-0.3778, -1.1562],
         [-0.3778, -1.1562],
         [-0.3778, -1.1562],
         [-0.3778, -1.1562],
         [-0.3778, -1.1562],
         [-0.3778, -1.1562],
         [-0.3778, -1.1562],
         [-0.3778, -1.1562]],
        [[-0.4197, -1.0708],
         [-0.4197, -1.0708],
         [-0.4197, -1.0708],
         [-0.4197, -1.0708],
         [-0.4197, -1.0708],
         [-0.4197, -1.0708],
         [-0.4197, -1.0708],
         [-0.4197, -1.0708],
         [-0.4197, -1.0708],
         [-0.4197, -1.0708]],
        [[-0.4103, -1.0889],
         [-0.4103, -1.0889],
         [-0.4103, -1.0889],
         [-0.4103, -1.0889],
         [-0.4103, -1.0889],
         [-0.4103, -1.0889],
         [-0.4103, -1.0889],
         [-0.4103, -1.0889],
         [-0.4103, -1.0889],
         [-0.4103, -1.0889]],
        [[-0.9532, -0.4870],
         [-0.9532, -0.4870],
         [-0.9532, -0.4870],
         [-0.9532, -0.4870],
         [-0.9532, -0.4870],
         [-0.9532, -0.4870],
         [-0.9532, -0.4870],
         [-0.9532, -0.4870],
         [-0.9532, -0.4870],
         [-0.9532, -0.4870]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4980, -0.9359],
         [-0.4980, -0.9359],
         [-0.4980, -0.9359],
         [-0.4980, -0.9359],
         [-0.4980, -0.9359],
         [-0.4980, -0.9359],
         [-0.4980, -0.9359],
         [-0.4980, -0.9359],
         [-0.4980, -0.9359],
         [-0.4980, -0.9359]],
        [[-0.4578, -1.0015],
         [-0.4578, -1.0015],
         [-0.4578, -1.0015],
         [-0.4578, -1.0015],
         [-0.4578, -1.0015],
         [-0.4578, -1.0015],
         [-0.4578, -1.0015],
         [-0.4578, -1.0015],
         [-0.4578, -1.0015],
         [-0.4578, -1.0015]],
        [[-0.6002, -0.7956],
         [-0.6002, -0.7956],
         [-0.6002, -0.7956],
         [-0.6002, -0.7956],
         [-0.6002, -0.7956],
         [-0.6002, -0.7956],
         [-0.6002, -0.7956],
         [-0.6002, -0.7956],
         [-0.6002, -0.7956],
         [-0.6002, -0.7956]],
        [[-0.7459, -0.6430],
         [-0.7459, -0.6430],
         [-0.7459, -0.6430],
         [-0.7459, -0.6430],
         [-0.7459, -0.6430],
         [-0.7459, -0.6430],
         [-0.7459, -0.6430],
         [-0.7459, -0.6430],
         [-0.7459, -0.6430],
         [-0.7459, -0.6430]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4864, -0.9541],
         [-0.4864, -0.9541],
         [-0.4864, -0.9541],
         [-0.4864, -0.9541],
         [-0.4864, -0.9541],
         [-0.4864, -0.9541],
         [-0.4864, -0.9541],
         [-0.4864, -0.9541],
         [-0.4864, -0.9541],
         [-0.4864, -0.9541]],
        [[-0.3769, -1.1582],
         [-0.3769, -1.1582],
         [-0.3769, -1.1582],
         [-0.3769, -1.1582],
         [-0.3769, -1.1582],
         [-0.3769, -1.1582],
         [-0.3769, -1.1582],
         [-0.3769, -1.1582],
         [-0.3769, -1.1582],
         [-0.3769, -1.1582]],
        [[-0.8963, -0.5244],
         [-0.8963, -0.5244],
         [-0.8963, -0.5244],
         [-0.8963, -0.5244],
         [-0.8963, -0.5244],
         [-0.8963, -0.5244],
         [-0.8963, -0.5244],
         [-0.8963, -0.5244],
         [-0.8963, -0.5244],
         [-0.8963, -0.5244]],
        [[-0.5497, -0.8607],
         [-0.5497, -0.8607],
         [-0.5497, -0.8607],
         [-0.5497, -0.8607],
         [-0.5497, -0.8607],
         [-0.5497, -0.8607],
         [-0.5497, -0.8607],
         [-0.5497, -0.8607],
         [-0.5497, -0.8607],
         [-0.5497, -0.8607]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.3368, -1.2518],
         [-0.3368, -1.2518],
         [-0.3368, -1.2518],
         [-0.3368, -1.2518],
         [-0.3368, -1.2518],
         [-0.3368, -1.2518],
         [-0.3368, -1.2518],
         [-0.3368, -1.2518],
         [-0.3368, -1.2518],
         [-0.3368, -1.2518]],
        [[-0.9923, -0.4632],
         [-0.9923, -0.4632],
         [-0.9923, -0.4632],
         [-0.9923, -0.4632],
         [-0.9923, -0.4632],
         [-0.9923, -0.4632],
         [-0.9923, -0.4632],
         [-0.9923, -0.4632],
         [-0.9923, -0.4632],
         [-0.9923, -0.4632]],
        [[-0.4017, -1.1063],
         [-0.4017, -1.1063],
         [-0.4017, -1.1063],
         [-0.4017, -1.1063],
         [-0.4017, -1.1063],
         [-0.4017, -1.1063],
         [-0.4017, -1.1063],
         [-0.4017, -1.1063],
         [-0.4017, -1.1063],
         [-0.4017, -1.1063]],
        [[-1.0475, -0.4320],
         [-1.0475, -0.4320],
         [-1.0475, -0.4320],
         [-1.0475, -0.4320],
         [-1.0475, -0.4320],
         [-1.0475, -0.4320],
         [-1.0475, -0.4320],
         [-1.0475, -0.4320],
         [-1.0475, -0.4320],
         [-1.0475, -0.4320]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4151, -1.0797],
         [-0.4151, -1.0797],
         [-0.4151, -1.0797],
         [-0.4151, -1.0797],
         [-0.4151, -1.0797],
         [-0.4151, -1.0797],
         [-0.4151, -1.0797],
         [-0.4151, -1.0797],
         [-0.4151, -1.0797],
         [-0.4151, -1.0797]],
        [[-1.0231, -0.4454],
         [-1.0231, -0.4454],
         [-1.0231, -0.4454],
         [-1.0231, -0.4454],
         [-1.0231, -0.4454],
         [-1.0231, -0.4454],
         [-1.0231, -0.4454],
         [-1.0231, -0.4454],
         [-1.0231, -0.4454],
         [-1.0231, -0.4454]],
        [[-1.1499, -0.3808],
         [-1.1499, -0.3808],
         [-1.1499, -0.3808],
         [-1.1499, -0.3808],
         [-1.1499, -0.3808],
         [-1.1499, -0.3808],
         [-1.1499, -0.3808],
         [-1.1499, -0.3808],
         [-1.1499, -0.3808],
         [-1.1499, -0.3808]],
        [[-1.1907, -0.3624],
         [-1.1907, -0.3624],
         [-1.1907, -0.3624],
         [-1.1907, -0.3624],
         [-1.1907, -0.3624],
         [-1.1907, -0.3624],
         [-1.1907, -0.3624],
         [-1.1907, -0.3624],
         [-1.1907, -0.3624],
         [-1.1907, -0.3624]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.9194, -0.5087],
         [-0.9194, -0.5087],
         [-0.9194, -0.5087],
         [-0.9194, -0.5087],
         [-0.9194, -0.5087],
         [-0.9194, -0.5087],
         [-0.9194, -0.5087],
         [-0.9194, -0.5087],
         [-0.9194, -0.5087],
         [-0.9194, -0.5087]],
        [[-0.4750, -0.9725],
         [-0.4750, -0.9725],
         [-0.4750, -0.9725],
         [-0.4750, -0.9725],
         [-0.4750, -0.9725],
         [-0.4750, -0.9725],
         [-0.4750, -0.9725],
         [-0.4750, -0.9725],
         [-0.4750, -0.9725],
         [-0.4750, -0.9725]],
        [[-0.7041, -0.6824],
         [-0.7041, -0.6824],
         [-0.7041, -0.6824],
         [-0.7041, -0.6824],
         [-0.7041, -0.6824],
         [-0.7041, -0.6824],
         [-0.7041, -0.6824],
         [-0.7041, -0.6824],
         [-0.7041, -0.6824],
         [-0.7041, -0.6824]],
        [[-0.4126, -1.0845],
         [-0.4126, -1.0845],
         [-0.4126, -1.0845],
         [-0.4126, -1.0845],
         [-0.4126, -1.0845],
         [-0.4126, -1.0845],
         [-0.4126, -1.0845],
         [-0.4126, -1.0845],
         [-0.4126, -1.0845],
         [-0.4126, -1.0845]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4526, -1.0105],
         [-0.4526, -1.0105],
         [-0.4526, -1.0105],
         [-0.4526, -1.0105],
         [-0.4526, -1.0105],
         [-0.4526, -1.0105],
         [-0.4526, -1.0105],
         [-0.4526, -1.0105],
         [-0.4526, -1.0105],
         [-0.4526, -1.0105]],
        [[-0.4211, -1.0680],
         [-0.4211, -1.0680],
         [-0.4211, -1.0680],
         [-0.4211, -1.0680],
         [-0.4211, -1.0680],
         [-0.4211, -1.0680],
         [-0.4211, -1.0680],
         [-0.4211, -1.0680],
         [-0.4211, -1.0680],
         [-0.4211, -1.0680]],
        [[-0.8952, -0.5251],
         [-0.8952, -0.5251],
         [-0.8952, -0.5251],
         [-0.8952, -0.5251],
         [-0.8952, -0.5251],
         [-0.8952, -0.5251],
         [-0.8952, -0.5251],
         [-0.8952, -0.5251],
         [-0.8952, -0.5251],
         [-0.8952, -0.5251]],
        [[-0.4347, -1.0427],
         [-0.4347, -1.0427],
         [-0.4347, -1.0427],
         [-0.4347, -1.0427],
         [-0.4347, -1.0427],
         [-0.4347, -1.0427],
         [-0.4347, -1.0427],
         [-0.4347, -1.0427],
         [-0.4347, -1.0427],
         [-0.4347, -1.0427]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.8158, -0.5839],
         [-0.8158, -0.5839],
         [-0.8158, -0.5839],
         [-0.8158, -0.5839],
         [-0.8158, -0.5839],
         [-0.8158, -0.5839],
         [-0.8158, -0.5839],
         [-0.8158, -0.5839],
         [-0.8158, -0.5839],
         [-0.8158, -0.5839]],
        [[-0.5119, -0.9147],
         [-0.5119, -0.9147],
         [-0.5119, -0.9147],
         [-0.5119, -0.9147],
         [-0.5119, -0.9147],
         [-0.5119, -0.9147],
         [-0.5119, -0.9147],
         [-0.5119, -0.9147],
         [-0.5119, -0.9147],
         [-0.5119, -0.9147]],
        [[-1.2459, -0.3392],
         [-1.2459, -0.3392],
         [-1.2459, -0.3392],
         [-1.2459, -0.3392],
         [-1.2459, -0.3392],
         [-1.2459, -0.3392],
         [-1.2459, -0.3392],
         [-1.2459, -0.3392],
         [-1.2459, -0.3392],
         [-1.2459, -0.3392]],
        [[-0.4713, -0.9788],
         [-0.4713, -0.9788],
         [-0.4713, -0.9788],
         [-0.4713, -0.9788],
         [-0.4713, -0.9788],
         [-0.4713, -0.9788],
         [-0.4713, -0.9788],
         [-0.4713, -0.9788],
         [-0.4713, -0.9788],
         [-0.4713, -0.9788]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.9353, -0.4983],
         [-0.9353, -0.4983],
         [-0.9353, -0.4983],
         [-0.9353, -0.4983],
         [-0.9353, -0.4983],
         [-0.9353, -0.4983],
         [-0.9353, -0.4983],
         [-0.9353, -0.4983],
         [-0.9353, -0.4983],
         [-0.9353, -0.4983]],
        [[-0.4621, -0.9941],
         [-0.4621, -0.9941],
         [-0.4621, -0.9941],
         [-0.4621, -0.9941],
         [-0.4621, -0.9941],
         [-0.4621, -0.9941],
         [-0.4621, -0.9941],
         [-0.4621, -0.9941],
         [-0.4621, -0.9941],
         [-0.4621, -0.9941]],
        [[-0.3877, -1.1350],
         [-0.3877, -1.1350],
         [-0.3877, -1.1350],
         [-0.3877, -1.1350],
         [-0.3877, -1.1350],
         [-0.3877, -1.1350],
         [-0.3877, -1.1350],
         [-0.3877, -1.1350],
         [-0.3877, -1.1350],
         [-0.3877, -1.1350]],
        [[-1.0770, -0.4164],
         [-1.0770, -0.4164],
         [-1.0770, -0.4164],
         [-1.0770, -0.4164],
         [-1.0770, -0.4164],
         [-1.0770, -0.4164],
         [-1.0770, -0.4164],
         [-1.0770, -0.4164],
         [-1.0770, -0.4164],
         [-1.0770, -0.4164]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.9107, -0.5146],
         [-0.9107, -0.5146],
         [-0.9107, -0.5146],
         [-0.9107, -0.5146],
         [-0.9107, -0.5146],
         [-0.9107, -0.5146],
         [-0.9107, -0.5146],
         [-0.9107, -0.5146],
         [-0.9107, -0.5146],
         [-0.9107, -0.5146]],
        [[-1.2259, -0.3474],
         [-1.2259, -0.3474],
         [-1.2259, -0.3474],
         [-1.2259, -0.3474],
         [-1.2259, -0.3474],
         [-1.2259, -0.3474],
         [-1.2259, -0.3474],
         [-1.2259, -0.3474],
         [-1.2259, -0.3474],
         [-1.2259, -0.3474]],
        [[-0.7628, -0.6280],
         [-0.7628, -0.6280],
         [-0.7628, -0.6280],
         [-0.7628, -0.6280],
         [-0.7628, -0.6280],
         [-0.7628, -0.6280],
         [-0.7628, -0.6280],
         [-0.7628, -0.6280],
         [-0.7628, -0.6280],
         [-0.7628, -0.6280]],
        [[-1.1660, -0.3734],
         [-1.1660, -0.3734],
         [-1.1660, -0.3734],
         [-1.1660, -0.3734],
         [-1.1660, -0.3734],
         [-1.1660, -0.3734],
         [-1.1660, -0.3734],
         [-1.1660, -0.3734],
         [-1.1660, -0.3734],
         [-1.1660, -0.3734]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.3467, -0.3012],
         [-1.3467, -0.3012],
         [-1.3467, -0.3012],
         [-1.3467, -0.3012],
         [-1.3467, -0.3012],
         [-1.3467, -0.3012],
         [-1.3467, -0.3012],
         [-1.3467, -0.3012],
         [-1.3467, -0.3012],
         [-1.3467, -0.3012]],
        [[-0.6763, -0.7103],
         [-0.6763, -0.7103],
         [-0.6763, -0.7103],
         [-0.6763, -0.7103],
         [-0.6763, -0.7103],
         [-0.6763, -0.7103],
         [-0.6763, -0.7103],
         [-0.6763, -0.7103],
         [-0.6763, -0.7103],
         [-0.6763, -0.7103]],
        [[-1.2965, -0.3195],
         [-1.2965, -0.3195],
         [-1.2965, -0.3195],
         [-1.2965, -0.3195],
         [-1.2965, -0.3195],
         [-1.2965, -0.3195],
         [-1.2965, -0.3195],
         [-1.2965, -0.3195],
         [-1.2965, -0.3195],
         [-1.2965, -0.3195]],
        [[-1.0546, -0.4282],
         [-1.0546, -0.4282],
         [-1.0546, -0.4282],
         [-1.0546, -0.4282],
         [-1.0546, -0.4282],
         [-1.0546, -0.4282],
         [-1.0546, -0.4282],
         [-1.0546, -0.4282],
         [-1.0546, -0.4282],
         [-1.0546, -0.4282]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.3704, -1.1727],
         [-0.3704, -1.1727],
         [-0.3704, -1.1727],
         [-0.3704, -1.1727],
         [-0.3704, -1.1727],
         [-0.3704, -1.1727],
         [-0.3704, -1.1727],
         [-0.3704, -1.1727],
         [-0.3704, -1.1727],
         [-0.3704, -1.1727]],
        [[-0.3745, -1.1635],
         [-0.3745, -1.1635],
         [-0.3745, -1.1635],
         [-0.3745, -1.1635],
         [-0.3745, -1.1635],
         [-0.3745, -1.1635],
         [-0.3745, -1.1635],
         [-0.3745, -1.1635],
         [-0.3745, -1.1635],
         [-0.3745, -1.1635]],
        [[-1.0403, -0.4360],
         [-1.0403, -0.4360],
         [-1.0403, -0.4360],
         [-1.0403, -0.4360],
         [-1.0403, -0.4360],
         [-1.0403, -0.4360],
         [-1.0403, -0.4360],
         [-1.0403, -0.4360],
         [-1.0403, -0.4360],
         [-1.0403, -0.4360]],
        [[-1.0057, -0.4554],
         [-1.0057, -0.4554],
         [-1.0057, -0.4554],
         [-1.0057, -0.4554],
         [-1.0057, -0.4554],
         [-1.0057, -0.4554],
         [-1.0057, -0.4554],
         [-1.0057, -0.4554],
         [-1.0057, -0.4554],
         [-1.0057, -0.4554]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.9174, -0.5101],
         [-0.9174, -0.5101],
         [-0.9174, -0.5101],
         [-0.9174, -0.5101],
         [-0.9174, -0.5101],
         [-0.9174, -0.5101],
         [-0.9174, -0.5101],
         [-0.9174, -0.5101],
         [-0.9174, -0.5101],
         [-0.9174, -0.5101]],
        [[-0.8474, -0.5595],
         [-0.8474, -0.5595],
         [-0.8474, -0.5595],
         [-0.8474, -0.5595],
         [-0.8474, -0.5595],
         [-0.8474, -0.5595],
         [-0.8474, -0.5595],
         [-0.8474, -0.5595],
         [-0.8474, -0.5595],
         [-0.8474, -0.5595]],
        [[-0.7603, -0.6302],
         [-0.7603, -0.6302],
         [-0.7603, -0.6302],
         [-0.7603, -0.6302],
         [-0.7603, -0.6302],
         [-0.7603, -0.6302],
         [-0.7603, -0.6302],
         [-0.7603, -0.6302],
         [-0.7603, -0.6302],
         [-0.7603, -0.6302]],
        [[-0.8815, -0.5347],
         [-0.8815, -0.5347],
         [-0.8815, -0.5347],
         [-0.8815, -0.5347],
         [-0.8815, -0.5347],
         [-0.8815, -0.5347],
         [-0.8815, -0.5347],
         [-0.8815, -0.5347],
         [-0.8815, -0.5347],
         [-0.8815, -0.5347]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5574, -0.8503],
         [-0.5574, -0.8503],
         [-0.5574, -0.8503],
         [-0.5574, -0.8503],
         [-0.5574, -0.8503],
         [-0.5574, -0.8503],
         [-0.5574, -0.8503],
         [-0.5574, -0.8503],
         [-0.5574, -0.8503],
         [-0.5574, -0.8503]],
        [[-0.5431, -0.8697],
         [-0.5431, -0.8697],
         [-0.5431, -0.8697],
         [-0.5431, -0.8697],
         [-0.5431, -0.8697],
         [-0.5431, -0.8697],
         [-0.5431, -0.8697],
         [-0.5431, -0.8697],
         [-0.5431, -0.8697],
         [-0.5431, -0.8697]],
        [[-0.7051, -0.6813],
         [-0.7051, -0.6813],
         [-0.7051, -0.6813],
         [-0.7051, -0.6813],
         [-0.7051, -0.6813],
         [-0.7051, -0.6813],
         [-0.7051, -0.6813],
         [-0.7051, -0.6813],
         [-0.7051, -0.6813],
         [-0.7051, -0.6813]],
        [[-0.3154, -1.3076],
         [-0.3154, -1.3076],
         [-0.3154, -1.3076],
         [-0.3154, -1.3076],
         [-0.3154, -1.3076],
         [-0.3154, -1.3076],
         [-0.3154, -1.3076],
         [-0.3154, -1.3076],
         [-0.3154, -1.3076],
         [-0.3154, -1.3076]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4859, -0.9548],
         [-0.4859, -0.9548],
         [-0.4859, -0.9548],
         [-0.4859, -0.9548],
         [-0.4859, -0.9548],
         [-0.4859, -0.9548],
         [-0.4859, -0.9548],
         [-0.4859, -0.9548],
         [-0.4859, -0.9548],
         [-0.4859, -0.9548]],
        [[-1.0621, -0.4242],
         [-1.0621, -0.4242],
         [-1.0621, -0.4242],
         [-1.0621, -0.4242],
         [-1.0621, -0.4242],
         [-1.0621, -0.4242],
         [-1.0621, -0.4242],
         [-1.0621, -0.4242],
         [-1.0621, -0.4242],
         [-1.0621, -0.4242]],
        [[-0.5472, -0.8642],
         [-0.5472, -0.8642],
         [-0.5472, -0.8642],
         [-0.5472, -0.8642],
         [-0.5472, -0.8642],
         [-0.5472, -0.8642],
         [-0.5472, -0.8642],
         [-0.5472, -0.8642],
         [-0.5472, -0.8642],
         [-0.5472, -0.8642]],
        [[-0.6464, -0.7421],
         [-0.6464, -0.7421],
         [-0.6464, -0.7421],
         [-0.6464, -0.7421],
         [-0.6464, -0.7421],
         [-0.6464, -0.7421],
         [-0.6464, -0.7421],
         [-0.6464, -0.7421],
         [-0.6464, -0.7421],
         [-0.6464, -0.7421]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4414, -1.0305],
         [-0.4414, -1.0305],
         [-0.4414, -1.0305],
         [-0.4414, -1.0305],
         [-0.4414, -1.0305],
         [-0.4414, -1.0305],
         [-0.4414, -1.0305],
         [-0.4414, -1.0305],
         [-0.4414, -1.0305],
         [-0.4414, -1.0305]],
        [[-1.1149, -0.3974],
         [-1.1149, -0.3974],
         [-1.1149, -0.3974],
         [-1.1149, -0.3974],
         [-1.1149, -0.3974],
         [-1.1149, -0.3974],
         [-1.1149, -0.3974],
         [-1.1149, -0.3974],
         [-1.1149, -0.3974],
         [-1.1149, -0.3974]],
        [[-0.5962, -0.8005],
         [-0.5962, -0.8005],
         [-0.5962, -0.8005],
         [-0.5962, -0.8005],
         [-0.5962, -0.8005],
         [-0.5962, -0.8005],
         [-0.5962, -0.8005],
         [-0.5962, -0.8005],
         [-0.5962, -0.8005],
         [-0.5962, -0.8005]],
        [[-0.7186, -0.6683],
         [-0.7186, -0.6683],
         [-0.7186, -0.6683],
         [-0.7186, -0.6683],
         [-0.7186, -0.6683],
         [-0.7186, -0.6683],
         [-0.7186, -0.6683],
         [-0.7186, -0.6683],
         [-0.7186, -0.6683],
         [-0.7186, -0.6683]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4237, -1.0630],
         [-0.4237, -1.0630],
         [-0.4237, -1.0630],
         [-0.4237, -1.0630],
         [-0.4237, -1.0630],
         [-0.4237, -1.0630],
         [-0.4237, -1.0630],
         [-0.4237, -1.0630],
         [-0.4237, -1.0630],
         [-0.4237, -1.0630]],
        [[-1.0144, -0.4504],
         [-1.0144, -0.4504],
         [-1.0144, -0.4504],
         [-1.0144, -0.4504],
         [-1.0144, -0.4504],
         [-1.0144, -0.4504],
         [-1.0144, -0.4504],
         [-1.0144, -0.4504],
         [-1.0144, -0.4504],
         [-1.0144, -0.4504]],
        [[-0.8714, -0.5419],
         [-0.8714, -0.5419],
         [-0.8714, -0.5419],
         [-0.8714, -0.5419],
         [-0.8714, -0.5419],
         [-0.8714, -0.5419],
         [-0.8714, -0.5419],
         [-0.8714, -0.5419],
         [-0.8714, -0.5419],
         [-0.8714, -0.5419]],
        [[-0.4254, -1.0599],
         [-0.4254, -1.0599],
         [-0.4254, -1.0599],
         [-0.4254, -1.0599],
         [-0.4254, -1.0599],
         [-0.4254, -1.0599],
         [-0.4254, -1.0599],
         [-0.4254, -1.0599],
         [-0.4254, -1.0599],
         [-0.4254, -1.0599]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4076, -1.0943],
         [-0.4076, -1.0943],
         [-0.4076, -1.0943],
         [-0.4076, -1.0943],
         [-0.4076, -1.0943],
         [-0.4076, -1.0943],
         [-0.4076, -1.0943],
         [-0.4076, -1.0943],
         [-0.4076, -1.0943],
         [-0.4076, -1.0943]],
        [[-1.3279, -0.3079],
         [-1.3279, -0.3079],
         [-1.3279, -0.3079],
         [-1.3279, -0.3079],
         [-1.3279, -0.3079],
         [-1.3279, -0.3079],
         [-1.3279, -0.3079],
         [-1.3279, -0.3079],
         [-1.3279, -0.3079],
         [-1.3279, -0.3079]],
        [[-0.4392, -1.0344],
         [-0.4392, -1.0344],
         [-0.4392, -1.0344],
         [-0.4392, -1.0344],
         [-0.4392, -1.0344],
         [-0.4392, -1.0344],
         [-0.4392, -1.0344],
         [-0.4392, -1.0344],
         [-0.4392, -1.0344],
         [-0.4392, -1.0344]],
        [[-0.3628, -1.1899],
         [-0.3628, -1.1899],
         [-0.3628, -1.1899],
         [-0.3628, -1.1899],
         [-0.3628, -1.1899],
         [-0.3628, -1.1899],
         [-0.3628, -1.1899],
         [-0.3628, -1.1899],
         [-0.3628, -1.1899],
         [-0.3628, -1.1899]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.3581, -1.2006],
         [-0.3581, -1.2006],
         [-0.3581, -1.2006],
         [-0.3581, -1.2006],
         [-0.3581, -1.2006],
         [-0.3581, -1.2006],
         [-0.3581, -1.2006],
         [-0.3581, -1.2006],
         [-0.3581, -1.2006],
         [-0.3581, -1.2006]],
        [[-0.4498, -1.0154],
         [-0.4498, -1.0154],
         [-0.4498, -1.0154],
         [-0.4498, -1.0154],
         [-0.4498, -1.0154],
         [-0.4498, -1.0154],
         [-0.4498, -1.0154],
         [-0.4498, -1.0154],
         [-0.4498, -1.0154],
         [-0.4498, -1.0154]],
        [[-1.0094, -0.4533],
         [-1.0094, -0.4533],
         [-1.0094, -0.4533],
         [-1.0094, -0.4533],
         [-1.0094, -0.4533],
         [-1.0094, -0.4533],
         [-1.0094, -0.4533],
         [-1.0094, -0.4533],
         [-1.0094, -0.4533],
         [-1.0094, -0.4533]],
        [[-0.4991, -0.9341],
         [-0.4991, -0.9341],
         [-0.4991, -0.9341],
         [-0.4991, -0.9341],
         [-0.4991, -0.9341],
         [-0.4991, -0.9341],
         [-0.4991, -0.9341],
         [-0.4991, -0.9341],
         [-0.4991, -0.9341],
         [-0.4991, -0.9341]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.9110, -0.5144],
         [-0.9110, -0.5144],
         [-0.9110, -0.5144],
         [-0.9110, -0.5144],
         [-0.9110, -0.5144],
         [-0.9110, -0.5144],
         [-0.9110, -0.5144],
         [-0.9110, -0.5144],
         [-0.9110, -0.5144],
         [-0.9110, -0.5144]],
        [[-1.0667, -0.4218],
         [-1.0667, -0.4218],
         [-1.0667, -0.4218],
         [-1.0667, -0.4218],
         [-1.0667, -0.4218],
         [-1.0667, -0.4218],
         [-1.0667, -0.4218],
         [-1.0667, -0.4218],
         [-1.0667, -0.4218],
         [-1.0667, -0.4218]],
        [[-1.1170, -0.3964],
         [-1.1170, -0.3964],
         [-1.1170, -0.3964],
         [-1.1170, -0.3964],
         [-1.1170, -0.3964],
         [-1.1170, -0.3964],
         [-1.1170, -0.3964],
         [-1.1170, -0.3964],
         [-1.1170, -0.3964],
         [-1.1170, -0.3964]],
        [[-1.0433, -0.4343],
         [-1.0433, -0.4343],
         [-1.0433, -0.4343],
         [-1.0433, -0.4343],
         [-1.0433, -0.4343],
         [-1.0433, -0.4343],
         [-1.0433, -0.4343],
         [-1.0433, -0.4343],
         [-1.0433, -0.4343],
         [-1.0433, -0.4343]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5829, -0.8171],
         [-0.5829, -0.8171],
         [-0.5829, -0.8171],
         [-0.5829, -0.8171],
         [-0.5829, -0.8171],
         [-0.5829, -0.8171],
         [-0.5829, -0.8171],
         [-0.5829, -0.8171],
         [-0.5829, -0.8171],
         [-0.5829, -0.8171]],
        [[-0.4388, -1.0351],
         [-0.4388, -1.0351],
         [-0.4388, -1.0351],
         [-0.4388, -1.0351],
         [-0.4388, -1.0351],
         [-0.4388, -1.0351],
         [-0.4388, -1.0351],
         [-0.4388, -1.0351],
         [-0.4388, -1.0351],
         [-0.4388, -1.0351]],
        [[-1.1435, -0.3837],
         [-1.1435, -0.3837],
         [-1.1435, -0.3837],
         [-1.1435, -0.3837],
         [-1.1435, -0.3837],
         [-1.1435, -0.3837],
         [-1.1435, -0.3837],
         [-1.1435, -0.3837],
         [-1.1435, -0.3837],
         [-1.1435, -0.3837]],
        [[-0.9171, -0.5103],
         [-0.9171, -0.5103],
         [-0.9171, -0.5103],
         [-0.9171, -0.5103],
         [-0.9171, -0.5103],
         [-0.9171, -0.5103],
         [-0.9171, -0.5103],
         [-0.9171, -0.5103],
         [-0.9171, -0.5103],
         [-0.9171, -0.5103]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.0209, -0.4467],
         [-1.0209, -0.4467],
         [-1.0209, -0.4467],
         [-1.0209, -0.4467],
         [-1.0209, -0.4467],
         [-1.0209, -0.4467],
         [-1.0209, -0.4467],
         [-1.0209, -0.4467],
         [-1.0209, -0.4467],
         [-1.0209, -0.4467]],
        [[-0.9514, -0.4881],
         [-0.9514, -0.4881],
         [-0.9514, -0.4881],
         [-0.9514, -0.4881],
         [-0.9514, -0.4881],
         [-0.9514, -0.4881],
         [-0.9514, -0.4881],
         [-0.9514, -0.4881],
         [-0.9514, -0.4881],
         [-0.9514, -0.4881]],
        [[-0.8572, -0.5522],
         [-0.8572, -0.5522],
         [-0.8572, -0.5522],
         [-0.8572, -0.5522],
         [-0.8572, -0.5522],
         [-0.8572, -0.5522],
         [-0.8572, -0.5522],
         [-0.8572, -0.5522],
         [-0.8572, -0.5522],
         [-0.8572, -0.5522]],
        [[-0.5657, -0.8392],
         [-0.5657, -0.8392],
         [-0.5657, -0.8392],
         [-0.5657, -0.8392],
         [-0.5657, -0.8392],
         [-0.5657, -0.8392],
         [-0.5657, -0.8392],
         [-0.5657, -0.8392],
         [-0.5657, -0.8392],
         [-0.5657, -0.8392]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.3818, -0.2892],
         [-1.3818, -0.2892],
         [-1.3818, -0.2892],
         [-1.3818, -0.2892],
         [-1.3818, -0.2892],
         [-1.3818, -0.2892],
         [-1.3818, -0.2892],
         [-1.3818, -0.2892],
         [-1.3818, -0.2892],
         [-1.3818, -0.2892]],
        [[-0.6217, -0.7701],
         [-0.6217, -0.7701],
         [-0.6217, -0.7701],
         [-0.6217, -0.7701],
         [-0.6217, -0.7701],
         [-0.6217, -0.7701],
         [-0.6217, -0.7701],
         [-0.6217, -0.7701],
         [-0.6217, -0.7701],
         [-0.6217, -0.7701]],
        [[-1.4691, -0.2615],
         [-1.4691, -0.2615],
         [-1.4691, -0.2615],
         [-1.4691, -0.2615],
         [-1.4691, -0.2615],
         [-1.4691, -0.2615],
         [-1.4691, -0.2615],
         [-1.4691, -0.2615],
         [-1.4691, -0.2615],
         [-1.4691, -0.2615]],
        [[-0.7613, -0.6293],
         [-0.7613, -0.6293],
         [-0.7613, -0.6293],
         [-0.7613, -0.6293],
         [-0.7613, -0.6293],
         [-0.7613, -0.6293],
         [-0.7613, -0.6293],
         [-0.7613, -0.6293],
         [-0.7613, -0.6293],
         [-0.7613, -0.6293]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.9905, -0.4642],
         [-0.9905, -0.4642],
         [-0.9905, -0.4642],
         [-0.9905, -0.4642],
         [-0.9905, -0.4642],
         [-0.9905, -0.4642],
         [-0.9905, -0.4642],
         [-0.9905, -0.4642],
         [-0.9905, -0.4642],
         [-0.9905, -0.4642]],
        [[-1.2134, -0.3527],
         [-1.2134, -0.3527],
         [-1.2134, -0.3527],
         [-1.2134, -0.3527],
         [-1.2134, -0.3527],
         [-1.2134, -0.3527],
         [-1.2134, -0.3527],
         [-1.2134, -0.3527],
         [-1.2134, -0.3527],
         [-1.2134, -0.3527]],
        [[-1.2542, -0.3359],
         [-1.2542, -0.3359],
         [-1.2542, -0.3359],
         [-1.2542, -0.3359],
         [-1.2542, -0.3359],
         [-1.2542, -0.3359],
         [-1.2542, -0.3359],
         [-1.2542, -0.3359],
         [-1.2542, -0.3359],
         [-1.2542, -0.3359]],
        [[-0.3660, -1.1826],
         [-0.3660, -1.1826],
         [-0.3660, -1.1826],
         [-0.3660, -1.1826],
         [-0.3660, -1.1826],
         [-0.3660, -1.1826],
         [-0.3660, -1.1826],
         [-0.3660, -1.1826],
         [-0.3660, -1.1826],
         [-0.3660, -1.1826]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.3455, -1.2305],
         [-0.3455, -1.2305],
         [-0.3455, -1.2305],
         [-0.3455, -1.2305],
         [-0.3455, -1.2305],
         [-0.3455, -1.2305],
         [-0.3455, -1.2305],
         [-0.3455, -1.2305],
         [-0.3455, -1.2305],
         [-0.3455, -1.2305]],
        [[-0.5433, -0.8694],
         [-0.5433, -0.8694],
         [-0.5433, -0.8694],
         [-0.5433, -0.8694],
         [-0.5433, -0.8694],
         [-0.5433, -0.8694],
         [-0.5433, -0.8694],
         [-0.5433, -0.8694],
         [-0.5433, -0.8694],
         [-0.5433, -0.8694]],
        [[-0.2928, -1.3710],
         [-0.2928, -1.3710],
         [-0.2928, -1.3710],
         [-0.2928, -1.3710],
         [-0.2928, -1.3710],
         [-0.2928, -1.3710],
         [-0.2928, -1.3710],
         [-0.2928, -1.3710],
         [-0.2928, -1.3710],
         [-0.2928, -1.3710]],
        [[-1.1290, -0.3906],
         [-1.1290, -0.3906],
         [-1.1290, -0.3906],
         [-1.1290, -0.3906],
         [-1.1290, -0.3906],
         [-1.1290, -0.3906],
         [-1.1290, -0.3906],
         [-1.1290, -0.3906],
         [-1.1290, -0.3906],
         [-1.1290, -0.3906]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.3795, -0.2900],
         [-1.3795, -0.2900],
         [-1.3795, -0.2900],
         [-1.3795, -0.2900],
         [-1.3795, -0.2900],
         [-1.3795, -0.2900],
         [-1.3795, -0.2900],
         [-1.3795, -0.2900],
         [-1.3795, -0.2900],
         [-1.3795, -0.2900]],
        [[-0.7025, -0.6839],
         [-0.7025, -0.6839],
         [-0.7025, -0.6839],
         [-0.7025, -0.6839],
         [-0.7025, -0.6839],
         [-0.7025, -0.6839],
         [-0.7025, -0.6839],
         [-0.7025, -0.6839],
         [-0.7025, -0.6839],
         [-0.7025, -0.6839]],
        [[-0.4149, -1.0800],
         [-0.4149, -1.0800],
         [-0.4149, -1.0800],
         [-0.4149, -1.0800],
         [-0.4149, -1.0800],
         [-0.4149, -1.0800],
         [-0.4149, -1.0800],
         [-0.4149, -1.0800],
         [-0.4149, -1.0800],
         [-0.4149, -1.0800]],
        [[-0.5475, -0.8637],
         [-0.5475, -0.8637],
         [-0.5475, -0.8637],
         [-0.5475, -0.8637],
         [-0.5475, -0.8637],
         [-0.5475, -0.8637],
         [-0.5475, -0.8637],
         [-0.5475, -0.8637],
         [-0.5475, -0.8637],
         [-0.5475, -0.8637]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4009, -1.1079],
         [-0.4009, -1.1079],
         [-0.4009, -1.1079],
         [-0.4009, -1.1079],
         [-0.4009, -1.1079],
         [-0.4009, -1.1079],
         [-0.4009, -1.1079],
         [-0.4009, -1.1079],
         [-0.4009, -1.1079],
         [-0.4009, -1.1079]],
        [[-1.2137, -0.3525],
         [-1.2137, -0.3525],
         [-1.2137, -0.3525],
         [-1.2137, -0.3525],
         [-1.2137, -0.3525],
         [-1.2137, -0.3525],
         [-1.2137, -0.3525],
         [-1.2137, -0.3525],
         [-1.2137, -0.3525],
         [-1.2137, -0.3525]],
        [[-0.9724, -0.4751],
         [-0.9724, -0.4751],
         [-0.9724, -0.4751],
         [-0.9724, -0.4751],
         [-0.9724, -0.4751],
         [-0.9724, -0.4751],
         [-0.9724, -0.4751],
         [-0.9724, -0.4751],
         [-0.9724, -0.4751],
         [-0.9724, -0.4751]],
        [[-0.3252, -1.2816],
         [-0.3252, -1.2816],
         [-0.3252, -1.2816],
         [-0.3252, -1.2816],
         [-0.3252, -1.2816],
         [-0.3252, -1.2816],
         [-0.3252, -1.2816],
         [-0.3252, -1.2816],
         [-0.3252, -1.2816],
         [-0.3252, -1.2816]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.3552, -1.2074],
         [-0.3552, -1.2074],
         [-0.3552, -1.2074],
         [-0.3552, -1.2074],
         [-0.3552, -1.2074],
         [-0.3552, -1.2074],
         [-0.3552, -1.2074],
         [-0.3552, -1.2074],
         [-0.3552, -1.2074],
         [-0.3552, -1.2074]],
        [[-0.5907, -0.8073],
         [-0.5907, -0.8073],
         [-0.5907, -0.8073],
         [-0.5907, -0.8073],
         [-0.5907, -0.8073],
         [-0.5907, -0.8073],
         [-0.5907, -0.8073],
         [-0.5907, -0.8073],
         [-0.5907, -0.8073],
         [-0.5907, -0.8073]],
        [[-0.4946, -0.9412],
         [-0.4946, -0.9412],
         [-0.4946, -0.9412],
         [-0.4946, -0.9412],
         [-0.4946, -0.9412],
         [-0.4946, -0.9412],
         [-0.4946, -0.9412],
         [-0.4946, -0.9412],
         [-0.4946, -0.9412],
         [-0.4946, -0.9412]],
        [[-1.3017, -0.3176],
         [-1.3017, -0.3176],
         [-1.3017, -0.3176],
         [-1.3017, -0.3176],
         [-1.3017, -0.3176],
         [-1.3017, -0.3176],
         [-1.3017, -0.3176],
         [-1.3017, -0.3176],
         [-1.3017, -0.3176],
         [-1.3017, -0.3176]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.9788, -0.4712],
         [-0.9788, -0.4712],
         [-0.9788, -0.4712],
         [-0.9788, -0.4712],
         [-0.9788, -0.4712],
         [-0.9788, -0.4712],
         [-0.9788, -0.4712],
         [-0.9788, -0.4712],
         [-0.9788, -0.4712],
         [-0.9788, -0.4712]],
        [[-1.1822, -0.3662],
         [-1.1822, -0.3662],
         [-1.1822, -0.3662],
         [-1.1822, -0.3662],
         [-1.1822, -0.3662],
         [-1.1822, -0.3662],
         [-1.1822, -0.3662],
         [-1.1822, -0.3662],
         [-1.1822, -0.3662],
         [-1.1822, -0.3662]],
        [[-0.4117, -1.0862],
         [-0.4117, -1.0862],
         [-0.4117, -1.0862],
         [-0.4117, -1.0862],
         [-0.4117, -1.0862],
         [-0.4117, -1.0862],
         [-0.4117, -1.0862],
         [-0.4117, -1.0862],
         [-0.4117, -1.0862],
         [-0.4117, -1.0862]],
        [[-0.3987, -1.1123],
         [-0.3987, -1.1123],
         [-0.3987, -1.1123],
         [-0.3987, -1.1123],
         [-0.3987, -1.1123],
         [-0.3987, -1.1123],
         [-0.3987, -1.1123],
         [-0.3987, -1.1123],
         [-0.3987, -1.1123],
         [-0.3987, -1.1123]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.9693, -0.4770],
         [-0.9693, -0.4770],
         [-0.9693, -0.4770],
         [-0.9693, -0.4770],
         [-0.9693, -0.4770],
         [-0.9693, -0.4770],
         [-0.9693, -0.4770],
         [-0.9693, -0.4770],
         [-0.9693, -0.4770],
         [-0.9693, -0.4770]],
        [[-0.7884, -0.6062],
         [-0.7884, -0.6062],
         [-0.7884, -0.6062],
         [-0.7884, -0.6062],
         [-0.7884, -0.6062],
         [-0.7884, -0.6062],
         [-0.7884, -0.6062],
         [-0.7884, -0.6062],
         [-0.7884, -0.6062],
         [-0.7884, -0.6062]],
        [[-0.2926, -1.3716],
         [-0.2926, -1.3716],
         [-0.2926, -1.3716],
         [-0.2926, -1.3716],
         [-0.2926, -1.3716],
         [-0.2926, -1.3716],
         [-0.2926, -1.3716],
         [-0.2926, -1.3716],
         [-0.2926, -1.3716],
         [-0.2926, -1.3716]],
        [[-0.4356, -1.0409],
         [-0.4356, -1.0409],
         [-0.4356, -1.0409],
         [-0.4356, -1.0409],
         [-0.4356, -1.0409],
         [-0.4356, -1.0409],
         [-0.4356, -1.0409],
         [-0.4356, -1.0409],
         [-0.4356, -1.0409],
         [-0.4356, -1.0409]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.1969, -0.3597],
         [-1.1969, -0.3597],
         [-1.1969, -0.3597],
         [-1.1969, -0.3597],
         [-1.1969, -0.3597],
         [-1.1969, -0.3597],
         [-1.1969, -0.3597],
         [-1.1969, -0.3597],
         [-1.1969, -0.3597],
         [-1.1969, -0.3597]],
        [[-0.9631, -0.4808],
         [-0.9631, -0.4808],
         [-0.9631, -0.4808],
         [-0.9631, -0.4808],
         [-0.9631, -0.4808],
         [-0.9631, -0.4808],
         [-0.9631, -0.4808],
         [-0.9631, -0.4808],
         [-0.9631, -0.4808],
         [-0.9631, -0.4808]],
        [[-0.3862, -1.1383],
         [-0.3862, -1.1383],
         [-0.3862, -1.1383],
         [-0.3862, -1.1383],
         [-0.3862, -1.1383],
         [-0.3862, -1.1383],
         [-0.3862, -1.1383],
         [-0.3862, -1.1383],
         [-0.3862, -1.1383],
         [-0.3862, -1.1383]],
        [[-0.7719, -0.6201],
         [-0.7719, -0.6201],
         [-0.7719, -0.6201],
         [-0.7719, -0.6201],
         [-0.7719, -0.6201],
         [-0.7719, -0.6201],
         [-0.7719, -0.6201],
         [-0.7719, -0.6201],
         [-0.7719, -0.6201],
         [-0.7719, -0.6201]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4798, -0.9647],
         [-0.4798, -0.9647],
         [-0.4798, -0.9647],
         [-0.4798, -0.9647],
         [-0.4798, -0.9647],
         [-0.4798, -0.9647],
         [-0.4798, -0.9647],
         [-0.4798, -0.9647],
         [-0.4798, -0.9647],
         [-0.4798, -0.9647]],
        [[-0.3888, -1.1328],
         [-0.3888, -1.1328],
         [-0.3888, -1.1328],
         [-0.3888, -1.1328],
         [-0.3888, -1.1328],
         [-0.3888, -1.1328],
         [-0.3888, -1.1328],
         [-0.3888, -1.1328],
         [-0.3888, -1.1328],
         [-0.3888, -1.1328]],
        [[-0.7386, -0.6497],
         [-0.7386, -0.6497],
         [-0.7386, -0.6497],
         [-0.7386, -0.6497],
         [-0.7386, -0.6497],
         [-0.7386, -0.6497],
         [-0.7386, -0.6497],
         [-0.7386, -0.6497],
         [-0.7386, -0.6497],
         [-0.7386, -0.6497]],
        [[-1.1272, -0.3915],
         [-1.1272, -0.3915],
         [-1.1272, -0.3915],
         [-1.1272, -0.3915],
         [-1.1272, -0.3915],
         [-1.1272, -0.3915],
         [-1.1272, -0.3915],
         [-1.1272, -0.3915],
         [-1.1272, -0.3915],
         [-1.1272, -0.3915]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4122, -1.0853],
         [-0.4122, -1.0853],
         [-0.4122, -1.0853],
         [-0.4122, -1.0853],
         [-0.4122, -1.0853],
         [-0.4122, -1.0853],
         [-0.4122, -1.0853],
         [-0.4122, -1.0853],
         [-0.4122, -1.0853],
         [-0.4122, -1.0853]],
        [[-0.5482, -0.8627],
         [-0.5482, -0.8627],
         [-0.5482, -0.8627],
         [-0.5482, -0.8627],
         [-0.5482, -0.8627],
         [-0.5482, -0.8627],
         [-0.5482, -0.8627],
         [-0.5482, -0.8627],
         [-0.5482, -0.8627],
         [-0.5482, -0.8627]],
        [[-1.1523, -0.3797],
         [-1.1523, -0.3797],
         [-1.1523, -0.3797],
         [-1.1523, -0.3797],
         [-1.1523, -0.3797],
         [-1.1523, -0.3797],
         [-1.1523, -0.3797],
         [-1.1523, -0.3797],
         [-1.1523, -0.3797],
         [-1.1523, -0.3797]],
        [[-1.3493, -0.3003],
         [-1.3493, -0.3003],
         [-1.3493, -0.3003],
         [-1.3493, -0.3003],
         [-1.3493, -0.3003],
         [-1.3493, -0.3003],
         [-1.3493, -0.3003],
         [-1.3493, -0.3003],
         [-1.3493, -0.3003],
         [-1.3493, -0.3003]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.4516, -0.2668],
         [-1.4516, -0.2668],
         [-1.4516, -0.2668],
         [-1.4516, -0.2668],
         [-1.4516, -0.2668],
         [-1.4516, -0.2668],
         [-1.4516, -0.2668],
         [-1.4516, -0.2668],
         [-1.4516, -0.2668],
         [-1.4516, -0.2668]],
        [[-0.2242, -1.6052],
         [-0.2242, -1.6052],
         [-0.2242, -1.6052],
         [-0.2242, -1.6052],
         [-0.2242, -1.6052],
         [-0.2242, -1.6052],
         [-0.2242, -1.6052],
         [-0.2242, -1.6052],
         [-0.2242, -1.6052],
         [-0.2242, -1.6052]],
        [[-0.5963, -0.8004],
         [-0.5963, -0.8004],
         [-0.5963, -0.8004],
         [-0.5963, -0.8004],
         [-0.5963, -0.8004],
         [-0.5963, -0.8004],
         [-0.5963, -0.8004],
         [-0.5963, -0.8004],
         [-0.5963, -0.8004],
         [-0.5963, -0.8004]],
        [[-0.6882, -0.6981],
         [-0.6882, -0.6981],
         [-0.6882, -0.6981],
         [-0.6882, -0.6981],
         [-0.6882, -0.6981],
         [-0.6882, -0.6981],
         [-0.6882, -0.6981],
         [-0.6882, -0.6981],
         [-0.6882, -0.6981],
         [-0.6882, -0.6981]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6157, -0.7770],
         [-0.6157, -0.7770],
         [-0.6157, -0.7770],
         [-0.6157, -0.7770],
         [-0.6157, -0.7770],
         [-0.6157, -0.7770],
         [-0.6157, -0.7770],
         [-0.6157, -0.7770],
         [-0.6157, -0.7770],
         [-0.6157, -0.7770]],
        [[-0.7591, -0.6313],
         [-0.7591, -0.6313],
         [-0.7591, -0.6313],
         [-0.7591, -0.6313],
         [-0.7591, -0.6313],
         [-0.7591, -0.6313],
         [-0.7591, -0.6313],
         [-0.7591, -0.6313],
         [-0.7591, -0.6313],
         [-0.7591, -0.6313]],
        [[-0.2923, -1.3726],
         [-0.2923, -1.3726],
         [-0.2923, -1.3726],
         [-0.2923, -1.3726],
         [-0.2923, -1.3726],
         [-0.2923, -1.3726],
         [-0.2923, -1.3726],
         [-0.2923, -1.3726],
         [-0.2923, -1.3726],
         [-0.2923, -1.3726]],
        [[-0.4178, -1.0744],
         [-0.4178, -1.0744],
         [-0.4178, -1.0744],
         [-0.4178, -1.0744],
         [-0.4178, -1.0744],
         [-0.4178, -1.0744],
         [-0.4178, -1.0744],
         [-0.4178, -1.0744],
         [-0.4178, -1.0744],
         [-0.4178, -1.0744]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.3651, -0.2949],
         [-1.3651, -0.2949],
         [-1.3651, -0.2949],
         [-1.3651, -0.2949],
         [-1.3651, -0.2949],
         [-1.3651, -0.2949],
         [-1.3651, -0.2949],
         [-1.3651, -0.2949],
         [-1.3651, -0.2949],
         [-1.3651, -0.2949]],
        [[-0.4261, -1.0586],
         [-0.4261, -1.0586],
         [-0.4261, -1.0586],
         [-0.4261, -1.0586],
         [-0.4261, -1.0586],
         [-0.4261, -1.0586],
         [-0.4261, -1.0586],
         [-0.4261, -1.0586],
         [-0.4261, -1.0586],
         [-0.4261, -1.0586]],
        [[-0.8158, -0.5839],
         [-0.8158, -0.5839],
         [-0.8158, -0.5839],
         [-0.8158, -0.5839],
         [-0.8158, -0.5839],
         [-0.8158, -0.5839],
         [-0.8158, -0.5839],
         [-0.8158, -0.5839],
         [-0.8158, -0.5839],
         [-0.8158, -0.5839]],
        [[-0.2027, -1.6956],
         [-0.2027, -1.6956],
         [-0.2027, -1.6956],
         [-0.2027, -1.6956],
         [-0.2027, -1.6956],
         [-0.2027, -1.6956],
         [-0.2027, -1.6956],
         [-0.2027, -1.6956],
         [-0.2027, -1.6956],
         [-0.2027, -1.6956]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.9671, -0.4783],
         [-0.9671, -0.4783],
         [-0.9671, -0.4783],
         [-0.9671, -0.4783],
         [-0.9671, -0.4783],
         [-0.9671, -0.4783],
         [-0.9671, -0.4783],
         [-0.9671, -0.4783],
         [-0.9671, -0.4783],
         [-0.9671, -0.4783]],
        [[-0.4803, -0.9638],
         [-0.4803, -0.9638],
         [-0.4803, -0.9638],
         [-0.4803, -0.9638],
         [-0.4803, -0.9638],
         [-0.4803, -0.9638],
         [-0.4803, -0.9638],
         [-0.4803, -0.9638],
         [-0.4803, -0.9638],
         [-0.4803, -0.9638]],
        [[-0.2801, -1.4093],
         [-0.2801, -1.4093],
         [-0.2801, -1.4093],
         [-0.2801, -1.4093],
         [-0.2801, -1.4093],
         [-0.2801, -1.4093],
         [-0.2801, -1.4093],
         [-0.2801, -1.4093],
         [-0.2801, -1.4093],
         [-0.2801, -1.4093]],
        [[-0.8822, -0.5342],
         [-0.8822, -0.5342],
         [-0.8822, -0.5342],
         [-0.8822, -0.5342],
         [-0.8822, -0.5342],
         [-0.8822, -0.5342],
         [-0.8822, -0.5342],
         [-0.8822, -0.5342],
         [-0.8822, -0.5342],
         [-0.8822, -0.5342]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.3602, -0.2965],
         [-1.3602, -0.2965],
         [-1.3602, -0.2965],
         [-1.3602, -0.2965],
         [-1.3602, -0.2965],
         [-1.3602, -0.2965],
         [-1.3602, -0.2965],
         [-1.3602, -0.2965],
         [-1.3602, -0.2965],
         [-1.3602, -0.2965]],
        [[-1.2781, -0.3265],
         [-1.2781, -0.3265],
         [-1.2781, -0.3265],
         [-1.2781, -0.3265],
         [-1.2781, -0.3265],
         [-1.2781, -0.3265],
         [-1.2781, -0.3265],
         [-1.2781, -0.3265],
         [-1.2781, -0.3265],
         [-1.2781, -0.3265]],
        [[-0.3302, -1.2687],
         [-0.3302, -1.2687],
         [-0.3302, -1.2687],
         [-0.3302, -1.2687],
         [-0.3302, -1.2687],
         [-0.3302, -1.2687],
         [-0.3302, -1.2687],
         [-0.3302, -1.2687],
         [-0.3302, -1.2687],
         [-0.3302, -1.2687]],
        [[-0.3694, -1.1748],
         [-0.3694, -1.1748],
         [-0.3694, -1.1748],
         [-0.3694, -1.1748],
         [-0.3694, -1.1748],
         [-0.3694, -1.1748],
         [-0.3694, -1.1748],
         [-0.3694, -1.1748],
         [-0.3694, -1.1748],
         [-0.3694, -1.1748]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6927, -0.6936],
         [-0.6927, -0.6936],
         [-0.6927, -0.6936],
         [-0.6927, -0.6936],
         [-0.6927, -0.6936],
         [-0.6927, -0.6936],
         [-0.6927, -0.6936],
         [-0.6927, -0.6936],
         [-0.6927, -0.6936],
         [-0.6927, -0.6936]],
        [[-1.3976, -0.2840],
         [-1.3976, -0.2840],
         [-1.3976, -0.2840],
         [-1.3976, -0.2840],
         [-1.3976, -0.2840],
         [-1.3976, -0.2840],
         [-1.3976, -0.2840],
         [-1.3976, -0.2840],
         [-1.3976, -0.2840],
         [-1.3976, -0.2840]],
        [[-0.7664, -0.6249],
         [-0.7664, -0.6249],
         [-0.7664, -0.6249],
         [-0.7664, -0.6249],
         [-0.7664, -0.6249],
         [-0.7664, -0.6249],
         [-0.7664, -0.6249],
         [-0.7664, -0.6249],
         [-0.7664, -0.6249],
         [-0.7664, -0.6249]],
        [[-0.4549, -1.0065],
         [-0.4549, -1.0065],
         [-0.4549, -1.0065],
         [-0.4549, -1.0065],
         [-0.4549, -1.0065],
         [-0.4549, -1.0065],
         [-0.4549, -1.0065],
         [-0.4549, -1.0065],
         [-0.4549, -1.0065],
         [-0.4549, -1.0065]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6417, -0.7474],
         [-0.6417, -0.7474],
         [-0.6417, -0.7474],
         [-0.6417, -0.7474],
         [-0.6417, -0.7474],
         [-0.6417, -0.7474],
         [-0.6417, -0.7474],
         [-0.6417, -0.7474],
         [-0.6417, -0.7474],
         [-0.6417, -0.7474]],
        [[-0.2961, -1.3613],
         [-0.2961, -1.3613],
         [-0.2961, -1.3613],
         [-0.2961, -1.3613],
         [-0.2961, -1.3613],
         [-0.2961, -1.3613],
         [-0.2961, -1.3613],
         [-0.2961, -1.3613],
         [-0.2961, -1.3613],
         [-0.2961, -1.3613]],
        [[-1.0010, -0.4581],
         [-1.0010, -0.4581],
         [-1.0010, -0.4581],
         [-1.0010, -0.4581],
         [-1.0010, -0.4581],
         [-1.0010, -0.4581],
         [-1.0010, -0.4581],
         [-1.0010, -0.4581],
         [-1.0010, -0.4581],
         [-1.0010, -0.4581]],
        [[-0.2580, -1.4810],
         [-0.2580, -1.4810],
         [-0.2580, -1.4810],
         [-0.2580, -1.4810],
         [-0.2580, -1.4810],
         [-0.2580, -1.4810],
         [-0.2580, -1.4810],
         [-0.2580, -1.4810],
         [-0.2580, -1.4810],
         [-0.2580, -1.4810]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5609, -0.8456],
         [-0.5609, -0.8456],
         [-0.5609, -0.8456],
         [-0.5609, -0.8456],
         [-0.5609, -0.8456],
         [-0.5609, -0.8456],
         [-0.5609, -0.8456],
         [-0.5609, -0.8456],
         [-0.5609, -0.8456],
         [-0.5609, -0.8456]],
        [[-0.5173, -0.9067],
         [-0.5173, -0.9067],
         [-0.5173, -0.9067],
         [-0.5173, -0.9067],
         [-0.5173, -0.9067],
         [-0.5173, -0.9067],
         [-0.5173, -0.9067],
         [-0.5173, -0.9067],
         [-0.5173, -0.9067],
         [-0.5173, -0.9067]],
        [[-0.5278, -0.8914],
         [-0.5278, -0.8914],
         [-0.5278, -0.8914],
         [-0.5278, -0.8914],
         [-0.5278, -0.8914],
         [-0.5278, -0.8914],
         [-0.5278, -0.8914],
         [-0.5278, -0.8914],
         [-0.5278, -0.8914],
         [-0.5278, -0.8914]],
        [[-0.7240, -0.6632],
         [-0.7240, -0.6632],
         [-0.7240, -0.6632],
         [-0.7240, -0.6632],
         [-0.7240, -0.6632],
         [-0.7240, -0.6632],
         [-0.7240, -0.6632],
         [-0.7240, -0.6632],
         [-0.7240, -0.6632],
         [-0.7240, -0.6632]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.4160, -0.2780],
         [-1.4160, -0.2780],
         [-1.4160, -0.2780],
         [-1.4160, -0.2780],
         [-1.4160, -0.2780],
         [-1.4160, -0.2780],
         [-1.4160, -0.2780],
         [-1.4160, -0.2780],
         [-1.4160, -0.2780],
         [-1.4160, -0.2780]],
        [[-0.2629, -1.4646],
         [-0.2629, -1.4646],
         [-0.2629, -1.4646],
         [-0.2629, -1.4646],
         [-0.2629, -1.4646],
         [-0.2629, -1.4646],
         [-0.2629, -1.4646],
         [-0.2629, -1.4646],
         [-0.2629, -1.4646],
         [-0.2629, -1.4646]],
        [[-1.4881, -0.2559],
         [-1.4881, -0.2559],
         [-1.4881, -0.2559],
         [-1.4881, -0.2559],
         [-1.4881, -0.2559],
         [-1.4881, -0.2559],
         [-1.4881, -0.2559],
         [-1.4881, -0.2559],
         [-1.4881, -0.2559],
         [-1.4881, -0.2559]],
        [[-1.0153, -0.4499],
         [-1.0153, -0.4499],
         [-1.0153, -0.4499],
         [-1.0153, -0.4499],
         [-1.0153, -0.4499],
         [-1.0153, -0.4499],
         [-1.0153, -0.4499],
         [-1.0153, -0.4499],
         [-1.0153, -0.4499],
         [-1.0153, -0.4499]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4875, -0.9523],
         [-0.4875, -0.9523],
         [-0.4875, -0.9523],
         [-0.4875, -0.9523],
         [-0.4875, -0.9523],
         [-0.4875, -0.9523],
         [-0.4875, -0.9523],
         [-0.4875, -0.9523],
         [-0.4875, -0.9523],
         [-0.4875, -0.9523]],
        [[-0.5920, -0.8057],
         [-0.5920, -0.8057],
         [-0.5920, -0.8057],
         [-0.5920, -0.8057],
         [-0.5920, -0.8057],
         [-0.5920, -0.8057],
         [-0.5920, -0.8057],
         [-0.5920, -0.8057],
         [-0.5920, -0.8057],
         [-0.5920, -0.8057]],
        [[-1.1634, -0.3746],
         [-1.1634, -0.3746],
         [-1.1634, -0.3746],
         [-1.1634, -0.3746],
         [-1.1634, -0.3746],
         [-1.1634, -0.3746],
         [-1.1634, -0.3746],
         [-1.1634, -0.3746],
         [-1.1634, -0.3746],
         [-1.1634, -0.3746]],
        [[-0.5189, -0.9043],
         [-0.5189, -0.9043],
         [-0.5189, -0.9043],
         [-0.5189, -0.9043],
         [-0.5189, -0.9043],
         [-0.5189, -0.9043],
         [-0.5189, -0.9043],
         [-0.5189, -0.9043],
         [-0.5189, -0.9043],
         [-0.5189, -0.9043]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.3912, -1.1277],
         [-0.3912, -1.1277],
         [-0.3912, -1.1277],
         [-0.3912, -1.1277],
         [-0.3912, -1.1277],
         [-0.3912, -1.1277],
         [-0.3912, -1.1277],
         [-0.3912, -1.1277],
         [-0.3912, -1.1277],
         [-0.3912, -1.1277]],
        [[-1.5132, -0.2487],
         [-1.5132, -0.2487],
         [-1.5132, -0.2487],
         [-1.5132, -0.2487],
         [-1.5132, -0.2487],
         [-1.5132, -0.2487],
         [-1.5132, -0.2487],
         [-1.5132, -0.2487],
         [-1.5132, -0.2487],
         [-1.5132, -0.2487]],
        [[-0.6546, -0.7333],
         [-0.6546, -0.7333],
         [-0.6546, -0.7333],
         [-0.6546, -0.7333],
         [-0.6546, -0.7333],
         [-0.6546, -0.7333],
         [-0.6546, -0.7333],
         [-0.6546, -0.7333],
         [-0.6546, -0.7333],
         [-0.6546, -0.7333]],
        [[-0.4124, -1.0849],
         [-0.4124, -1.0849],
         [-0.4124, -1.0849],
         [-0.4124, -1.0849],
         [-0.4124, -1.0849],
         [-0.4124, -1.0849],
         [-0.4124, -1.0849],
         [-0.4124, -1.0849],
         [-0.4124, -1.0849],
         [-0.4124, -1.0849]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4921, -0.9451],
         [-0.4921, -0.9451],
         [-0.4921, -0.9451],
         [-0.4921, -0.9451],
         [-0.4921, -0.9451],
         [-0.4921, -0.9451],
         [-0.4921, -0.9451],
         [-0.4921, -0.9451],
         [-0.4921, -0.9451],
         [-0.4921, -0.9451]],
        [[-0.3789, -1.1539],
         [-0.3789, -1.1539],
         [-0.3789, -1.1539],
         [-0.3789, -1.1539],
         [-0.3789, -1.1539],
         [-0.3789, -1.1539],
         [-0.3789, -1.1539],
         [-0.3789, -1.1539],
         [-0.3789, -1.1539],
         [-0.3789, -1.1539]],
        [[-0.5024, -0.9290],
         [-0.5024, -0.9290],
         [-0.5024, -0.9290],
         [-0.5024, -0.9290],
         [-0.5024, -0.9290],
         [-0.5024, -0.9290],
         [-0.5024, -0.9290],
         [-0.5024, -0.9290],
         [-0.5024, -0.9290],
         [-0.5024, -0.9290]],
        [[-1.3004, -0.3180],
         [-1.3004, -0.3180],
         [-1.3004, -0.3180],
         [-1.3004, -0.3180],
         [-1.3004, -0.3180],
         [-1.3004, -0.3180],
         [-1.3004, -0.3180],
         [-1.3004, -0.3180],
         [-1.3004, -0.3180],
         [-1.3004, -0.3180]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.5015, -0.2521],
         [-1.5015, -0.2521],
         [-1.5015, -0.2521],
         [-1.5015, -0.2521],
         [-1.5015, -0.2521],
         [-1.5015, -0.2521],
         [-1.5015, -0.2521],
         [-1.5015, -0.2521],
         [-1.5015, -0.2521],
         [-1.5015, -0.2521]],
        [[-0.5726, -0.8303],
         [-0.5726, -0.8303],
         [-0.5726, -0.8303],
         [-0.5726, -0.8303],
         [-0.5726, -0.8303],
         [-0.5726, -0.8303],
         [-0.5726, -0.8303],
         [-0.5726, -0.8303],
         [-0.5726, -0.8303],
         [-0.5726, -0.8303]],
        [[-1.4817, -0.2578],
         [-1.4817, -0.2578],
         [-1.4817, -0.2578],
         [-1.4817, -0.2578],
         [-1.4817, -0.2578],
         [-1.4817, -0.2578],
         [-1.4817, -0.2578],
         [-1.4817, -0.2578],
         [-1.4817, -0.2578],
         [-1.4817, -0.2578]],
        [[-0.3786, -1.1546],
         [-0.3786, -1.1546],
         [-0.3786, -1.1546],
         [-0.3786, -1.1546],
         [-0.3786, -1.1546],
         [-0.3786, -1.1546],
         [-0.3786, -1.1546],
         [-0.3786, -1.1546],
         [-0.3786, -1.1546],
         [-0.3786, -1.1546]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4781, -0.9675],
         [-0.4781, -0.9675],
         [-0.4781, -0.9675],
         [-0.4781, -0.9675],
         [-0.4781, -0.9675],
         [-0.4781, -0.9675],
         [-0.4781, -0.9675],
         [-0.4781, -0.9675],
         [-0.4781, -0.9675],
         [-0.4781, -0.9675]],
        [[-1.4606, -0.2641],
         [-1.4606, -0.2641],
         [-1.4606, -0.2641],
         [-1.4606, -0.2641],
         [-1.4606, -0.2641],
         [-1.4606, -0.2641],
         [-1.4606, -0.2641],
         [-1.4606, -0.2641],
         [-1.4606, -0.2641],
         [-1.4606, -0.2641]],
        [[-0.7453, -0.6436],
         [-0.7453, -0.6436],
         [-0.7453, -0.6436],
         [-0.7453, -0.6436],
         [-0.7453, -0.6436],
         [-0.7453, -0.6436],
         [-0.7453, -0.6436],
         [-0.7453, -0.6436],
         [-0.7453, -0.6436],
         [-0.7453, -0.6436]],
        [[-1.5377, -0.2419],
         [-1.5377, -0.2419],
         [-1.5377, -0.2419],
         [-1.5377, -0.2419],
         [-1.5377, -0.2419],
         [-1.5377, -0.2419],
         [-1.5377, -0.2419],
         [-1.5377, -0.2419],
         [-1.5377, -0.2419],
         [-1.5377, -0.2419]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7796, -0.6135],
         [-0.7796, -0.6135],
         [-0.7796, -0.6135],
         [-0.7796, -0.6135],
         [-0.7796, -0.6135],
         [-0.7796, -0.6135],
         [-0.7796, -0.6135],
         [-0.7796, -0.6135],
         [-0.7796, -0.6135],
         [-0.7796, -0.6135]],
        [[-1.5044, -0.2512],
         [-1.5044, -0.2512],
         [-1.5044, -0.2512],
         [-1.5044, -0.2512],
         [-1.5044, -0.2512],
         [-1.5044, -0.2512],
         [-1.5044, -0.2512],
         [-1.5044, -0.2512],
         [-1.5044, -0.2512],
         [-1.5044, -0.2512]],
        [[-0.2702, -1.4407],
         [-0.2702, -1.4407],
         [-0.2702, -1.4407],
         [-0.2702, -1.4407],
         [-0.2702, -1.4407],
         [-0.2702, -1.4407],
         [-0.2702, -1.4407],
         [-0.2702, -1.4407],
         [-0.2702, -1.4407],
         [-0.2702, -1.4407]],
        [[-0.6029, -0.7923],
         [-0.6029, -0.7923],
         [-0.6029, -0.7923],
         [-0.6029, -0.7923],
         [-0.6029, -0.7923],
         [-0.6029, -0.7923],
         [-0.6029, -0.7923],
         [-0.6029, -0.7923],
         [-0.6029, -0.7923],
         [-0.6029, -0.7923]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6394, -0.7500],
         [-0.6394, -0.7500],
         [-0.6394, -0.7500],
         [-0.6394, -0.7500],
         [-0.6394, -0.7500],
         [-0.6394, -0.7500],
         [-0.6394, -0.7500],
         [-0.6394, -0.7500],
         [-0.6394, -0.7500],
         [-0.6394, -0.7500]],
        [[-0.2872, -1.3879],
         [-0.2872, -1.3879],
         [-0.2872, -1.3879],
         [-0.2872, -1.3879],
         [-0.2872, -1.3879],
         [-0.2872, -1.3879],
         [-0.2872, -1.3879],
         [-0.2872, -1.3879],
         [-0.2872, -1.3879],
         [-0.2872, -1.3879]],
        [[-0.9031, -0.5197],
         [-0.9031, -0.5197],
         [-0.9031, -0.5197],
         [-0.9031, -0.5197],
         [-0.9031, -0.5197],
         [-0.9031, -0.5197],
         [-0.9031, -0.5197],
         [-0.9031, -0.5197],
         [-0.9031, -0.5197],
         [-0.9031, -0.5197]],
        [[-0.9628, -0.4810],
         [-0.9628, -0.4810],
         [-0.9628, -0.4810],
         [-0.9628, -0.4810],
         [-0.9628, -0.4810],
         [-0.9628, -0.4810],
         [-0.9628, -0.4810],
         [-0.9628, -0.4810],
         [-0.9628, -0.4810],
         [-0.9628, -0.4810]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6604, -0.7270],
         [-0.6604, -0.7270],
         [-0.6604, -0.7270],
         [-0.6604, -0.7270],
         [-0.6604, -0.7270],
         [-0.6604, -0.7270],
         [-0.6604, -0.7270],
         [-0.6604, -0.7270],
         [-0.6604, -0.7270],
         [-0.6604, -0.7270]],
        [[-0.4515, -1.0124],
         [-0.4515, -1.0124],
         [-0.4515, -1.0124],
         [-0.4515, -1.0124],
         [-0.4515, -1.0124],
         [-0.4515, -1.0124],
         [-0.4515, -1.0124],
         [-0.4515, -1.0124],
         [-0.4515, -1.0124],
         [-0.4515, -1.0124]],
        [[-0.8998, -0.5220],
         [-0.8998, -0.5220],
         [-0.8998, -0.5220],
         [-0.8998, -0.5220],
         [-0.8998, -0.5220],
         [-0.8998, -0.5220],
         [-0.8998, -0.5220],
         [-0.8998, -0.5220],
         [-0.8998, -0.5220],
         [-0.8998, -0.5220]],
        [[-0.6191, -0.7731],
         [-0.6191, -0.7731],
         [-0.6191, -0.7731],
         [-0.6191, -0.7731],
         [-0.6191, -0.7731],
         [-0.6191, -0.7731],
         [-0.6191, -0.7731],
         [-0.6191, -0.7731],
         [-0.6191, -0.7731],
         [-0.6191, -0.7731]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4416, -1.0299],
         [-0.4416, -1.0299],
         [-0.4416, -1.0299],
         [-0.4416, -1.0299],
         [-0.4416, -1.0299],
         [-0.4416, -1.0299],
         [-0.4416, -1.0299],
         [-0.4416, -1.0299],
         [-0.4416, -1.0299],
         [-0.4416, -1.0299]],
        [[-0.5722, -0.8307],
         [-0.5722, -0.8307],
         [-0.5722, -0.8307],
         [-0.5722, -0.8307],
         [-0.5722, -0.8307],
         [-0.5722, -0.8307],
         [-0.5722, -0.8307],
         [-0.5722, -0.8307],
         [-0.5722, -0.8307],
         [-0.5722, -0.8307]],
        [[-0.6749, -0.7118],
         [-0.6749, -0.7118],
         [-0.6749, -0.7118],
         [-0.6749, -0.7118],
         [-0.6749, -0.7118],
         [-0.6749, -0.7118],
         [-0.6749, -0.7118],
         [-0.6749, -0.7118],
         [-0.6749, -0.7118],
         [-0.6749, -0.7118]],
        [[-1.5430, -0.2405],
         [-1.5430, -0.2405],
         [-1.5430, -0.2405],
         [-1.5430, -0.2405],
         [-1.5430, -0.2405],
         [-1.5430, -0.2405],
         [-1.5430, -0.2405],
         [-1.5430, -0.2405],
         [-1.5430, -0.2405],
         [-1.5430, -0.2405]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.3267, -1.2776],
         [-0.3267, -1.2776],
         [-0.3267, -1.2776],
         [-0.3267, -1.2776],
         [-0.3267, -1.2776],
         [-0.3267, -1.2776],
         [-0.3267, -1.2776],
         [-0.3267, -1.2776],
         [-0.3267, -1.2776],
         [-0.3267, -1.2776]],
        [[-0.8370, -0.5674],
         [-0.8370, -0.5674],
         [-0.8370, -0.5674],
         [-0.8370, -0.5674],
         [-0.8370, -0.5674],
         [-0.8370, -0.5674],
         [-0.8370, -0.5674],
         [-0.8370, -0.5674],
         [-0.8370, -0.5674],
         [-0.8370, -0.5674]],
        [[-0.3977, -1.1144],
         [-0.3977, -1.1144],
         [-0.3977, -1.1144],
         [-0.3977, -1.1144],
         [-0.3977, -1.1144],
         [-0.3977, -1.1144],
         [-0.3977, -1.1144],
         [-0.3977, -1.1144],
         [-0.3977, -1.1144],
         [-0.3977, -1.1144]],
        [[-1.4019, -0.2825],
         [-1.4019, -0.2825],
         [-1.4019, -0.2825],
         [-1.4019, -0.2825],
         [-1.4019, -0.2825],
         [-1.4019, -0.2825],
         [-1.4019, -0.2825],
         [-1.4019, -0.2825],
         [-1.4019, -0.2825],
         [-1.4019, -0.2825]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.1040, -0.4028],
         [-1.1040, -0.4028],
         [-1.1040, -0.4028],
         [-1.1040, -0.4028],
         [-1.1040, -0.4028],
         [-1.1040, -0.4028],
         [-1.1040, -0.4028],
         [-1.1040, -0.4028],
         [-1.1040, -0.4028],
         [-1.1040, -0.4028]],
        [[-0.8114, -0.5874],
         [-0.8114, -0.5874],
         [-0.8114, -0.5874],
         [-0.8114, -0.5874],
         [-0.8114, -0.5874],
         [-0.8114, -0.5874],
         [-0.8114, -0.5874],
         [-0.8114, -0.5874],
         [-0.8114, -0.5874],
         [-0.8114, -0.5874]],
        [[-1.4312, -0.2731],
         [-1.4312, -0.2731],
         [-1.4312, -0.2731],
         [-1.4312, -0.2731],
         [-1.4312, -0.2731],
         [-1.4312, -0.2731],
         [-1.4312, -0.2731],
         [-1.4312, -0.2731],
         [-1.4312, -0.2731],
         [-1.4312, -0.2731]],
        [[-0.4041, -1.1014],
         [-0.4041, -1.1014],
         [-0.4041, -1.1014],
         [-0.4041, -1.1014],
         [-0.4041, -1.1014],
         [-0.4041, -1.1014],
         [-0.4041, -1.1014],
         [-0.4041, -1.1014],
         [-0.4041, -1.1014],
         [-0.4041, -1.1014]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.3951, -1.1197],
         [-0.3951, -1.1197],
         [-0.3951, -1.1197],
         [-0.3951, -1.1197],
         [-0.3951, -1.1197],
         [-0.3951, -1.1197],
         [-0.3951, -1.1197],
         [-0.3951, -1.1197],
         [-0.3951, -1.1197],
         [-0.3951, -1.1197]],
        [[-1.1808, -0.3668],
         [-1.1808, -0.3668],
         [-1.1808, -0.3668],
         [-1.1808, -0.3668],
         [-1.1808, -0.3668],
         [-1.1808, -0.3668],
         [-1.1808, -0.3668],
         [-1.1808, -0.3668],
         [-1.1808, -0.3668],
         [-1.1808, -0.3668]],
        [[-0.2751, -1.4252],
         [-0.2751, -1.4252],
         [-0.2751, -1.4252],
         [-0.2751, -1.4252],
         [-0.2751, -1.4252],
         [-0.2751, -1.4252],
         [-0.2751, -1.4252],
         [-0.2751, -1.4252],
         [-0.2751, -1.4252],
         [-0.2751, -1.4252]],
        [[-1.1864, -0.3643],
         [-1.1864, -0.3643],
         [-1.1864, -0.3643],
         [-1.1864, -0.3643],
         [-1.1864, -0.3643],
         [-1.1864, -0.3643],
         [-1.1864, -0.3643],
         [-1.1864, -0.3643],
         [-1.1864, -0.3643],
         [-1.1864, -0.3643]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4841, -0.9577],
         [-0.4841, -0.9577],
         [-0.4841, -0.9577],
         [-0.4841, -0.9577],
         [-0.4841, -0.9577],
         [-0.4841, -0.9577],
         [-0.4841, -0.9577],
         [-0.4841, -0.9577],
         [-0.4841, -0.9577],
         [-0.4841, -0.9577]],
        [[-0.5486, -0.8622],
         [-0.5486, -0.8622],
         [-0.5486, -0.8622],
         [-0.5486, -0.8622],
         [-0.5486, -0.8622],
         [-0.5486, -0.8622],
         [-0.5486, -0.8622],
         [-0.5486, -0.8622],
         [-0.5486, -0.8622],
         [-0.5486, -0.8622]],
        [[-1.5104, -0.2495],
         [-1.5104, -0.2495],
         [-1.5104, -0.2495],
         [-1.5104, -0.2495],
         [-1.5104, -0.2495],
         [-1.5104, -0.2495],
         [-1.5104, -0.2495],
         [-1.5104, -0.2495],
         [-1.5104, -0.2495],
         [-1.5104, -0.2495]],
        [[-0.9088, -0.5158],
         [-0.9088, -0.5158],
         [-0.9088, -0.5158],
         [-0.9088, -0.5158],
         [-0.9088, -0.5158],
         [-0.9088, -0.5158],
         [-0.9088, -0.5158],
         [-0.9088, -0.5158],
         [-0.9088, -0.5158],
         [-0.9088, -0.5158]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4776, -0.9683],
         [-0.4776, -0.9683],
         [-0.4776, -0.9683],
         [-0.4776, -0.9683],
         [-0.4776, -0.9683],
         [-0.4776, -0.9683],
         [-0.4776, -0.9683],
         [-0.4776, -0.9683],
         [-0.4776, -0.9683],
         [-0.4776, -0.9683]],
        [[-0.7301, -0.6575],
         [-0.7301, -0.6575],
         [-0.7301, -0.6575],
         [-0.7301, -0.6575],
         [-0.7301, -0.6575],
         [-0.7301, -0.6575],
         [-0.7301, -0.6575],
         [-0.7301, -0.6575],
         [-0.7301, -0.6575],
         [-0.7301, -0.6575]],
        [[-1.0973, -0.4061],
         [-1.0973, -0.4061],
         [-1.0973, -0.4061],
         [-1.0973, -0.4061],
         [-1.0973, -0.4061],
         [-1.0973, -0.4061],
         [-1.0973, -0.4061],
         [-1.0973, -0.4061],
         [-1.0973, -0.4061],
         [-1.0973, -0.4061]],
        [[-1.1145, -0.3976],
         [-1.1145, -0.3976],
         [-1.1145, -0.3976],
         [-1.1145, -0.3976],
         [-1.1145, -0.3976],
         [-1.1145, -0.3976],
         [-1.1145, -0.3976],
         [-1.1145, -0.3976],
         [-1.1145, -0.3976],
         [-1.1145, -0.3976]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.3379, -1.2493],
         [-0.3379, -1.2493],
         [-0.3379, -1.2493],
         [-0.3379, -1.2493],
         [-0.3379, -1.2493],
         [-0.3379, -1.2493],
         [-0.3379, -1.2493],
         [-0.3379, -1.2493],
         [-0.3379, -1.2493],
         [-0.3379, -1.2493]],
        [[-0.3364, -1.2530],
         [-0.3364, -1.2530],
         [-0.3364, -1.2530],
         [-0.3364, -1.2530],
         [-0.3364, -1.2530],
         [-0.3364, -1.2530],
         [-0.3364, -1.2530],
         [-0.3364, -1.2530],
         [-0.3364, -1.2530],
         [-0.3364, -1.2530]],
        [[-1.0872, -0.4112],
         [-1.0872, -0.4112],
         [-1.0872, -0.4112],
         [-1.0872, -0.4112],
         [-1.0872, -0.4112],
         [-1.0872, -0.4112],
         [-1.0872, -0.4112],
         [-1.0872, -0.4112],
         [-1.0872, -0.4112],
         [-1.0872, -0.4112]],
        [[-0.6461, -0.7425],
         [-0.6461, -0.7425],
         [-0.6461, -0.7425],
         [-0.6461, -0.7425],
         [-0.6461, -0.7425],
         [-0.6461, -0.7425],
         [-0.6461, -0.7425],
         [-0.6461, -0.7425],
         [-0.6461, -0.7425],
         [-0.6461, -0.7425]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.2131, -1.6505],
         [-0.2131, -1.6505],
         [-0.2131, -1.6505],
         [-0.2131, -1.6505],
         [-0.2131, -1.6505],
         [-0.2131, -1.6505],
         [-0.2131, -1.6505],
         [-0.2131, -1.6505],
         [-0.2131, -1.6505],
         [-0.2131, -1.6505]],
        [[-1.5138, -0.2485],
         [-1.5138, -0.2485],
         [-1.5138, -0.2485],
         [-1.5138, -0.2485],
         [-1.5138, -0.2485],
         [-1.5138, -0.2485],
         [-1.5138, -0.2485],
         [-1.5138, -0.2485],
         [-1.5138, -0.2485],
         [-1.5138, -0.2485]],
        [[-0.7085, -0.6780],
         [-0.7085, -0.6780],
         [-0.7085, -0.6780],
         [-0.7085, -0.6780],
         [-0.7085, -0.6780],
         [-0.7085, -0.6780],
         [-0.7085, -0.6780],
         [-0.7085, -0.6780],
         [-0.7085, -0.6780],
         [-0.7085, -0.6780]],
        [[-1.4151, -0.2783],
         [-1.4151, -0.2783],
         [-1.4151, -0.2783],
         [-1.4151, -0.2783],
         [-1.4151, -0.2783],
         [-1.4151, -0.2783],
         [-1.4151, -0.2783],
         [-1.4151, -0.2783],
         [-1.4151, -0.2783],
         [-1.4151, -0.2783]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.3577, -1.2017],
         [-0.3577, -1.2017],
         [-0.3577, -1.2017],
         [-0.3577, -1.2017],
         [-0.3577, -1.2017],
         [-0.3577, -1.2017],
         [-0.3577, -1.2017],
         [-0.3577, -1.2017],
         [-0.3577, -1.2017],
         [-0.3577, -1.2017]],
        [[-0.4445, -1.0249],
         [-0.4445, -1.0249],
         [-0.4445, -1.0249],
         [-0.4445, -1.0249],
         [-0.4445, -1.0249],
         [-0.4445, -1.0249],
         [-0.4445, -1.0249],
         [-0.4445, -1.0249],
         [-0.4445, -1.0249],
         [-0.4445, -1.0249]],
        [[-0.7318, -0.6560],
         [-0.7318, -0.6560],
         [-0.7318, -0.6560],
         [-0.7318, -0.6560],
         [-0.7318, -0.6560],
         [-0.7318, -0.6560],
         [-0.7318, -0.6560],
         [-0.7318, -0.6560],
         [-0.7318, -0.6560],
         [-0.7318, -0.6560]],
        [[-0.5166, -0.9077],
         [-0.5166, -0.9077],
         [-0.5166, -0.9077],
         [-0.5166, -0.9077],
         [-0.5166, -0.9077],
         [-0.5166, -0.9077],
         [-0.5166, -0.9077],
         [-0.5166, -0.9077],
         [-0.5166, -0.9077],
         [-0.5166, -0.9077]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4650, -0.9892],
         [-0.4650, -0.9892],
         [-0.4650, -0.9892],
         [-0.4650, -0.9892],
         [-0.4650, -0.9892],
         [-0.4650, -0.9892],
         [-0.4650, -0.9892],
         [-0.4650, -0.9892],
         [-0.4650, -0.9892],
         [-0.4650, -0.9892]],
        [[-0.5886, -0.8099],
         [-0.5886, -0.8099],
         [-0.5886, -0.8099],
         [-0.5886, -0.8099],
         [-0.5886, -0.8099],
         [-0.5886, -0.8099],
         [-0.5886, -0.8099],
         [-0.5886, -0.8099],
         [-0.5886, -0.8099],
         [-0.5886, -0.8099]],
        [[-0.6432, -0.7457],
         [-0.6432, -0.7457],
         [-0.6432, -0.7457],
         [-0.6432, -0.7457],
         [-0.6432, -0.7457],
         [-0.6432, -0.7457],
         [-0.6432, -0.7457],
         [-0.6432, -0.7457],
         [-0.6432, -0.7457],
         [-0.6432, -0.7457]],
        [[-1.0277, -0.4429],
         [-1.0277, -0.4429],
         [-1.0277, -0.4429],
         [-1.0277, -0.4429],
         [-1.0277, -0.4429],
         [-1.0277, -0.4429],
         [-1.0277, -0.4429],
         [-1.0277, -0.4429],
         [-1.0277, -0.4429],
         [-1.0277, -0.4429]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5283, -0.8907],
         [-0.5283, -0.8907],
         [-0.5283, -0.8907],
         [-0.5283, -0.8907],
         [-0.5283, -0.8907],
         [-0.5283, -0.8907],
         [-0.5283, -0.8907],
         [-0.5283, -0.8907],
         [-0.5283, -0.8907],
         [-0.5283, -0.8907]],
        [[-0.5174, -0.9064],
         [-0.5174, -0.9064],
         [-0.5174, -0.9064],
         [-0.5174, -0.9064],
         [-0.5174, -0.9064],
         [-0.5174, -0.9064],
         [-0.5174, -0.9064],
         [-0.5174, -0.9064],
         [-0.5174, -0.9064],
         [-0.5174, -0.9064]],
        [[-0.2620, -1.4674],
         [-0.2620, -1.4674],
         [-0.2620, -1.4674],
         [-0.2620, -1.4674],
         [-0.2620, -1.4674],
         [-0.2620, -1.4674],
         [-0.2620, -1.4674],
         [-0.2620, -1.4674],
         [-0.2620, -1.4674],
         [-0.2620, -1.4674]],
        [[-0.5682, -0.8360],
         [-0.5682, -0.8360],
         [-0.5682, -0.8360],
         [-0.5682, -0.8360],
         [-0.5682, -0.8360],
         [-0.5682, -0.8360],
         [-0.5682, -0.8360],
         [-0.5682, -0.8360],
         [-0.5682, -0.8360],
         [-0.5682, -0.8360]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.5357, -0.2425],
         [-1.5357, -0.2425],
         [-1.5357, -0.2425],
         [-1.5357, -0.2425],
         [-1.5357, -0.2425],
         [-1.5357, -0.2425],
         [-1.5357, -0.2425],
         [-1.5357, -0.2425],
         [-1.5357, -0.2425],
         [-1.5357, -0.2425]],
        [[-0.6877, -0.6986],
         [-0.6877, -0.6986],
         [-0.6877, -0.6986],
         [-0.6877, -0.6986],
         [-0.6877, -0.6986],
         [-0.6877, -0.6986],
         [-0.6877, -0.6986],
         [-0.6877, -0.6986],
         [-0.6877, -0.6986],
         [-0.6877, -0.6986]],
        [[-0.6116, -0.7820],
         [-0.6116, -0.7820],
         [-0.6116, -0.7820],
         [-0.6116, -0.7820],
         [-0.6116, -0.7820],
         [-0.6116, -0.7820],
         [-0.6116, -0.7820],
         [-0.6116, -0.7820],
         [-0.6116, -0.7820],
         [-0.6116, -0.7820]],
        [[-1.2424, -0.3406],
         [-1.2424, -0.3406],
         [-1.2424, -0.3406],
         [-1.2424, -0.3406],
         [-1.2424, -0.3406],
         [-1.2424, -0.3406],
         [-1.2424, -0.3406],
         [-1.2424, -0.3406],
         [-1.2424, -0.3406],
         [-1.2424, -0.3406]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.9388, -0.4961],
         [-0.9388, -0.4961],
         [-0.9388, -0.4961],
         [-0.9388, -0.4961],
         [-0.9388, -0.4961],
         [-0.9388, -0.4961],
         [-0.9388, -0.4961],
         [-0.9388, -0.4961],
         [-0.9388, -0.4961],
         [-0.9388, -0.4961]],
        [[-1.4412, -0.2700],
         [-1.4412, -0.2700],
         [-1.4412, -0.2700],
         [-1.4412, -0.2700],
         [-1.4412, -0.2700],
         [-1.4412, -0.2700],
         [-1.4412, -0.2700],
         [-1.4412, -0.2700],
         [-1.4412, -0.2700],
         [-1.4412, -0.2700]],
        [[-1.0898, -0.4099],
         [-1.0898, -0.4099],
         [-1.0898, -0.4099],
         [-1.0898, -0.4099],
         [-1.0898, -0.4099],
         [-1.0898, -0.4099],
         [-1.0898, -0.4099],
         [-1.0898, -0.4099],
         [-1.0898, -0.4099],
         [-1.0898, -0.4099]],
        [[-0.8908, -0.5282],
         [-0.8908, -0.5282],
         [-0.8908, -0.5282],
         [-0.8908, -0.5282],
         [-0.8908, -0.5282],
         [-0.8908, -0.5282],
         [-0.8908, -0.5282],
         [-0.8908, -0.5282],
         [-0.8908, -0.5282],
         [-0.8908, -0.5282]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4790, -0.9661],
         [-0.4790, -0.9661],
         [-0.4790, -0.9661],
         [-0.4790, -0.9661],
         [-0.4790, -0.9661],
         [-0.4790, -0.9661],
         [-0.4790, -0.9661],
         [-0.4790, -0.9661],
         [-0.4790, -0.9661],
         [-0.4790, -0.9661]],
        [[-1.5220, -0.2463],
         [-1.5220, -0.2463],
         [-1.5220, -0.2463],
         [-1.5220, -0.2463],
         [-1.5220, -0.2463],
         [-1.5220, -0.2463],
         [-1.5220, -0.2463],
         [-1.5220, -0.2463],
         [-1.5220, -0.2463],
         [-1.5220, -0.2463]],
        [[-0.3682, -1.1777],
         [-0.3682, -1.1777],
         [-0.3682, -1.1777],
         [-0.3682, -1.1777],
         [-0.3682, -1.1777],
         [-0.3682, -1.1777],
         [-0.3682, -1.1777],
         [-0.3682, -1.1777],
         [-0.3682, -1.1777],
         [-0.3682, -1.1777]],
        [[-0.3677, -1.1786],
         [-0.3677, -1.1786],
         [-0.3677, -1.1786],
         [-0.3677, -1.1786],
         [-0.3677, -1.1786],
         [-0.3677, -1.1786],
         [-0.3677, -1.1786],
         [-0.3677, -1.1786],
         [-0.3677, -1.1786],
         [-0.3677, -1.1786]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.6151, -0.2217],
         [-1.6151, -0.2217],
         [-1.6151, -0.2217],
         [-1.6151, -0.2217],
         [-1.6151, -0.2217],
         [-1.6151, -0.2217],
         [-1.6151, -0.2217],
         [-1.6151, -0.2217],
         [-1.6151, -0.2217],
         [-1.6151, -0.2217]],
        [[-0.5803, -0.8204],
         [-0.5803, -0.8204],
         [-0.5803, -0.8204],
         [-0.5803, -0.8204],
         [-0.5803, -0.8204],
         [-0.5803, -0.8204],
         [-0.5803, -0.8204],
         [-0.5803, -0.8204],
         [-0.5803, -0.8204],
         [-0.5803, -0.8204]],
        [[-0.7176, -0.6693],
         [-0.7176, -0.6693],
         [-0.7176, -0.6693],
         [-0.7176, -0.6693],
         [-0.7176, -0.6693],
         [-0.7176, -0.6693],
         [-0.7176, -0.6693],
         [-0.7176, -0.6693],
         [-0.7176, -0.6693],
         [-0.7176, -0.6693]],
        [[-0.4026, -1.1044],
         [-0.4026, -1.1044],
         [-0.4026, -1.1044],
         [-0.4026, -1.1044],
         [-0.4026, -1.1044],
         [-0.4026, -1.1044],
         [-0.4026, -1.1044],
         [-0.4026, -1.1044],
         [-0.4026, -1.1044],
         [-0.4026, -1.1044]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.1192, -0.3953],
         [-1.1192, -0.3953],
         [-1.1192, -0.3953],
         [-1.1192, -0.3953],
         [-1.1192, -0.3953],
         [-1.1192, -0.3953],
         [-1.1192, -0.3953],
         [-1.1192, -0.3953],
         [-1.1192, -0.3953],
         [-1.1192, -0.3953]],
        [[-0.7207, -0.6663],
         [-0.7207, -0.6663],
         [-0.7207, -0.6663],
         [-0.7207, -0.6663],
         [-0.7207, -0.6663],
         [-0.7207, -0.6663],
         [-0.7207, -0.6663],
         [-0.7207, -0.6663],
         [-0.7207, -0.6663],
         [-0.7207, -0.6663]],
        [[-0.7333, -0.6545],
         [-0.7333, -0.6545],
         [-0.7333, -0.6545],
         [-0.7333, -0.6545],
         [-0.7333, -0.6545],
         [-0.7333, -0.6545],
         [-0.7333, -0.6545],
         [-0.7333, -0.6545],
         [-0.7333, -0.6545],
         [-0.7333, -0.6545]],
        [[-0.3974, -1.1149],
         [-0.3974, -1.1149],
         [-0.3974, -1.1149],
         [-0.3974, -1.1149],
         [-0.3974, -1.1149],
         [-0.3974, -1.1149],
         [-0.3974, -1.1149],
         [-0.3974, -1.1149],
         [-0.3974, -1.1149],
         [-0.3974, -1.1149]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.3001, -1.3499],
         [-0.3001, -1.3499],
         [-0.3001, -1.3499],
         [-0.3001, -1.3499],
         [-0.3001, -1.3499],
         [-0.3001, -1.3499],
         [-0.3001, -1.3499],
         [-0.3001, -1.3499],
         [-0.3001, -1.3499],
         [-0.3001, -1.3499]],
        [[-0.7262, -0.6611],
         [-0.7262, -0.6611],
         [-0.7262, -0.6611],
         [-0.7262, -0.6611],
         [-0.7262, -0.6611],
         [-0.7262, -0.6611],
         [-0.7262, -0.6611],
         [-0.7262, -0.6611],
         [-0.7262, -0.6611],
         [-0.7262, -0.6611]],
        [[-1.4361, -0.2716],
         [-1.4361, -0.2716],
         [-1.4361, -0.2716],
         [-1.4361, -0.2716],
         [-1.4361, -0.2716],
         [-1.4361, -0.2716],
         [-1.4361, -0.2716],
         [-1.4361, -0.2716],
         [-1.4361, -0.2716],
         [-1.4361, -0.2716]],
        [[-0.8880, -0.5301],
         [-0.8880, -0.5301],
         [-0.8880, -0.5301],
         [-0.8880, -0.5301],
         [-0.8880, -0.5301],
         [-0.8880, -0.5301],
         [-0.8880, -0.5301],
         [-0.8880, -0.5301],
         [-0.8880, -0.5301],
         [-0.8880, -0.5301]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.2649, -0.3317],
         [-1.2649, -0.3317],
         [-1.2649, -0.3317],
         [-1.2649, -0.3317],
         [-1.2649, -0.3317],
         [-1.2649, -0.3317],
         [-1.2649, -0.3317],
         [-1.2649, -0.3317],
         [-1.2649, -0.3317],
         [-1.2649, -0.3317]],
        [[-0.4513, -1.0127],
         [-0.4513, -1.0127],
         [-0.4513, -1.0127],
         [-0.4513, -1.0127],
         [-0.4513, -1.0127],
         [-0.4513, -1.0127],
         [-0.4513, -1.0127],
         [-0.4513, -1.0127],
         [-0.4513, -1.0127],
         [-0.4513, -1.0127]],
        [[-0.6754, -0.7112],
         [-0.6754, -0.7112],
         [-0.6754, -0.7112],
         [-0.6754, -0.7112],
         [-0.6754, -0.7112],
         [-0.6754, -0.7112],
         [-0.6754, -0.7112],
         [-0.6754, -0.7112],
         [-0.6754, -0.7112],
         [-0.6754, -0.7112]],
        [[-1.1529, -0.3794],
         [-1.1529, -0.3794],
         [-1.1529, -0.3794],
         [-1.1529, -0.3794],
         [-1.1529, -0.3794],
         [-1.1529, -0.3794],
         [-1.1529, -0.3794],
         [-1.1529, -0.3794],
         [-1.1529, -0.3794],
         [-1.1529, -0.3794]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.2648, -0.3317],
         [-1.2648, -0.3317],
         [-1.2648, -0.3317],
         [-1.2648, -0.3317],
         [-1.2648, -0.3317],
         [-1.2648, -0.3317],
         [-1.2648, -0.3317],
         [-1.2648, -0.3317],
         [-1.2648, -0.3317],
         [-1.2648, -0.3317]],
        [[-0.3908, -1.1285],
         [-0.3908, -1.1285],
         [-0.3908, -1.1285],
         [-0.3908, -1.1285],
         [-0.3908, -1.1285],
         [-0.3908, -1.1285],
         [-0.3908, -1.1285],
         [-0.3908, -1.1285],
         [-0.3908, -1.1285],
         [-0.3908, -1.1285]],
        [[-0.4015, -1.1065],
         [-0.4015, -1.1065],
         [-0.4015, -1.1065],
         [-0.4015, -1.1065],
         [-0.4015, -1.1065],
         [-0.4015, -1.1065],
         [-0.4015, -1.1065],
         [-0.4015, -1.1065],
         [-0.4015, -1.1065],
         [-0.4015, -1.1065]],
        [[-1.6704, -0.2085],
         [-1.6704, -0.2085],
         [-1.6704, -0.2085],
         [-1.6704, -0.2085],
         [-1.6704, -0.2085],
         [-1.6704, -0.2085],
         [-1.6704, -0.2085],
         [-1.6704, -0.2085],
         [-1.6704, -0.2085],
         [-1.6704, -0.2085]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.8839, -0.5330],
         [-0.8839, -0.5330],
         [-0.8839, -0.5330],
         [-0.8839, -0.5330],
         [-0.8839, -0.5330],
         [-0.8839, -0.5330],
         [-0.8839, -0.5330],
         [-0.8839, -0.5330],
         [-0.8839, -0.5330],
         [-0.8839, -0.5330]],
        [[-0.3447, -1.2324],
         [-0.3447, -1.2324],
         [-0.3447, -1.2324],
         [-0.3447, -1.2324],
         [-0.3447, -1.2324],
         [-0.3447, -1.2324],
         [-0.3447, -1.2324],
         [-0.3447, -1.2324],
         [-0.3447, -1.2324],
         [-0.3447, -1.2324]],
        [[-1.6526, -0.2126],
         [-1.6526, -0.2126],
         [-1.6526, -0.2126],
         [-1.6526, -0.2126],
         [-1.6526, -0.2126],
         [-1.6526, -0.2126],
         [-1.6526, -0.2126],
         [-1.6526, -0.2126],
         [-1.6526, -0.2126],
         [-1.6526, -0.2126]],
        [[-1.4401, -0.2704],
         [-1.4401, -0.2704],
         [-1.4401, -0.2704],
         [-1.4401, -0.2704],
         [-1.4401, -0.2704],
         [-1.4401, -0.2704],
         [-1.4401, -0.2704],
         [-1.4401, -0.2704],
         [-1.4401, -0.2704],
         [-1.4401, -0.2704]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.4484, -0.2678],
         [-1.4484, -0.2678],
         [-1.4484, -0.2678],
         [-1.4484, -0.2678],
         [-1.4484, -0.2678],
         [-1.4484, -0.2678],
         [-1.4484, -0.2678],
         [-1.4484, -0.2678],
         [-1.4484, -0.2678],
         [-1.4484, -0.2678]],
        [[-1.4494, -0.2675],
         [-1.4494, -0.2675],
         [-1.4494, -0.2675],
         [-1.4494, -0.2675],
         [-1.4494, -0.2675],
         [-1.4494, -0.2675],
         [-1.4494, -0.2675],
         [-1.4494, -0.2675],
         [-1.4494, -0.2675],
         [-1.4494, -0.2675]],
        [[-0.3224, -1.2889],
         [-0.3224, -1.2889],
         [-0.3224, -1.2889],
         [-0.3224, -1.2889],
         [-0.3224, -1.2889],
         [-0.3224, -1.2889],
         [-0.3224, -1.2889],
         [-0.3224, -1.2889],
         [-0.3224, -1.2889],
         [-0.3224, -1.2889]],
        [[-1.3759, -0.2912],
         [-1.3759, -0.2912],
         [-1.3759, -0.2912],
         [-1.3759, -0.2912],
         [-1.3759, -0.2912],
         [-1.3759, -0.2912],
         [-1.3759, -0.2912],
         [-1.3759, -0.2912],
         [-1.3759, -0.2912],
         [-1.3759, -0.2912]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.3681, -1.1778],
         [-0.3681, -1.1778],
         [-0.3681, -1.1778],
         [-0.3681, -1.1778],
         [-0.3681, -1.1778],
         [-0.3681, -1.1778],
         [-0.3681, -1.1778],
         [-0.3681, -1.1778],
         [-0.3681, -1.1778],
         [-0.3681, -1.1778]],
        [[-0.9245, -0.5054],
         [-0.9245, -0.5054],
         [-0.9245, -0.5054],
         [-0.9245, -0.5054],
         [-0.9245, -0.5054],
         [-0.9245, -0.5054],
         [-0.9245, -0.5054],
         [-0.9245, -0.5054],
         [-0.9245, -0.5054],
         [-0.9245, -0.5054]],
        [[-1.3413, -0.3032],
         [-1.3413, -0.3032],
         [-1.3413, -0.3032],
         [-1.3413, -0.3032],
         [-1.3413, -0.3032],
         [-1.3413, -0.3032],
         [-1.3413, -0.3032],
         [-1.3413, -0.3032],
         [-1.3413, -0.3032],
         [-1.3413, -0.3032]],
        [[-0.7181, -0.6688],
         [-0.7181, -0.6688],
         [-0.7181, -0.6688],
         [-0.7181, -0.6688],
         [-0.7181, -0.6688],
         [-0.7181, -0.6688],
         [-0.7181, -0.6688],
         [-0.7181, -0.6688],
         [-0.7181, -0.6688],
         [-0.7181, -0.6688]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.9894, -0.4649],
         [-0.9894, -0.4649],
         [-0.9894, -0.4649],
         [-0.9894, -0.4649],
         [-0.9894, -0.4649],
         [-0.9894, -0.4649],
         [-0.9894, -0.4649],
         [-0.9894, -0.4649],
         [-0.9894, -0.4649],
         [-0.9894, -0.4649]],
        [[-1.1759, -0.3690],
         [-1.1759, -0.3690],
         [-1.1759, -0.3690],
         [-1.1759, -0.3690],
         [-1.1759, -0.3690],
         [-1.1759, -0.3690],
         [-1.1759, -0.3690],
         [-1.1759, -0.3690],
         [-1.1759, -0.3690],
         [-1.1759, -0.3690]],
        [[-1.1111, -0.3993],
         [-1.1111, -0.3993],
         [-1.1111, -0.3993],
         [-1.1111, -0.3993],
         [-1.1111, -0.3993],
         [-1.1111, -0.3993],
         [-1.1111, -0.3993],
         [-1.1111, -0.3993],
         [-1.1111, -0.3993],
         [-1.1111, -0.3993]],
        [[-0.3614, -1.1931],
         [-0.3614, -1.1931],
         [-0.3614, -1.1931],
         [-0.3614, -1.1931],
         [-0.3614, -1.1931],
         [-0.3614, -1.1931],
         [-0.3614, -1.1931],
         [-0.3614, -1.1931],
         [-0.3614, -1.1931],
         [-0.3614, -1.1931]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.3491, -1.2219],
         [-0.3491, -1.2219],
         [-0.3491, -1.2219],
         [-0.3491, -1.2219],
         [-0.3491, -1.2219],
         [-0.3491, -1.2219],
         [-0.3491, -1.2219],
         [-0.3491, -1.2219],
         [-0.3491, -1.2219],
         [-0.3491, -1.2219]],


Online Simulation:   4%|▍         | 352/9306 [00:13<05:57, 25.06it/s]
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.9739, -0.4742],
         [-0.9739, -0.4742],
         [-0.9739, -0.4742],
         [-0.9739, -0.4742],
         [-0.9739, -0.4742],
         [-0.9739, -0.4742],
         [-0.9739, -0.4742],
         [-0.9739, -0.4742],
         [-0.9739, -0.4742],
         [-0.9739, -0.4742]],
        [[-1.3940, -0.2851],
         [-1.3940, -0.2851],
         [-1.3940, -0.2851],
         [-1.3940, -0.2851],
         [-1.3940, -0.2851],
         [-1.3940, -0.2851],
         [-1.3940, -0.2851],
         [-1.3940, -0.2851],
         [-1.3940, -0.2851],
         [-1.3940, -0.2851]],
        [[-0.4626, -0.9933],
         [-0.4626, -0.9933],
         [-0.4626, -0.9933],
         [-0.4626, -0.9933],
         [-0.4626, -0.9933],
         [-0.4626, -0.9933],
         [-0.4626, -0.9933],
         [-0.4626, -0.9933],
         [-0.4626, -0.9933],
         [-0.4626, -0.9933]],
        [[-0.5347, -0.8815],
         [-0.5347, -0.8815],
         [-0.5347, -0.8815],
         [-0.5347, -0.8815],
         [-0.5347, -0.8815],
         [-0.5347, -0.8815],
         [-0.5347, -0.8815],
         [-0.5347, -0.8815],
         [-0.5347, -0.8815],
         [-0.5347, -0.8815]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.3457, -0.3016],
         [-1.3457, -0.3016],
         [-1.3457, -0.3016],
         [-1.3457, -0.3016],
         [-1.3457, -0.3016],
         [-1.3457, -0.3016],
         [-1.3457, -0.3016],
         [-1.3457, -0.3016],
         [-1.3457, -0.3016],
         [-1.3457, -0.3016]],
        [[-1.0151, -0.4500],
         [-1.0151, -0.4500],
         [-1.0151, -0.4500],
         [-1.0151, -0.4500],
         [-1.0151, -0.4500],
         [-1.0151, -0.4500],
         [-1.0151, -0.4500],
         [-1.0151, -0.4500],
         [-1.0151, -0.4500],
         [-1.0151, -0.4500]],
        [[-1.0300, -0.4416],
         [-1.0300, -0.4416],
         [-1.0300, -0.4416],
         [-1.0300, -0.4416],
         [-1.0300, -0.4416],
         [-1.0300, -0.4416],
         [-1.0300, -0.4416],
         [-1.0300, -0.4416],
         [-1.0300, -0.4416],
         [-1.0300, -0.4416]],
        [[-0.4994, -0.9337],
         [-0.4994, -0.9337],
         [-0.4994, -0.9337],
         [-0.4994, -0.9337],
         [-0.4994, -0.9337],
         [-0.4994, -0.9337],
         [-0.4994, -0.9337],
         [-0.4994, -0.9337],
         [-0.4994, -0.9337],
         [-0.4994, -0.9337]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4570, -1.0028],
         [-0.4570, -1.0028],
         [-0.4570, -1.0028],
         [-0.4570, -1.0028],
         [-0.4570, -1.0028],
         [-0.4570, -1.0028],
         [-0.4570, -1.0028],
         [-0.4570, -1.0028],
         [-0.4570, -1.0028],
         [-0.4570, -1.0028]],
        [[-0.9066, -0.5174],
         [-0.9066, -0.5174],
         [-0.9066, -0.5174],
         [-0.9066, -0.5174],
         [-0.9066, -0.5174],
         [-0.9066, -0.5174],
         [-0.9066, -0.5174],
         [-0.9066, -0.5174],
         [-0.9066, -0.5174],
         [-0.9066, -0.5174]],
        [[-0.6925, -0.6938],
         [-0.6925, -0.6938],
         [-0.6925, -0.6938],
         [-0.6925, -0.6938],
         [-0.6925, -0.6938],
         [-0.6925, -0.6938],
         [-0.6925, -0.6938],
         [-0.6925, -0.6938],
         [-0.6925, -0.6938],
         [-0.6925, -0.6938]],
        [[-1.3363, -0.3049],
         [-1.3363, -0.3049],
         [-1.3363, -0.3049],
         [-1.3363, -0.3049],
         [-1.3363, -0.3049],
         [-1.3363, -0.3049],
         [-1.3363, -0.3049],
         [-1.3363, -0.3049],
         [-1.3363, -0.3049],
         [-1.3363, -0.3049]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.1249, -0.3926],
         [-1.1249, -0.3926],
         [-1.1249, -0.3926],
         [-1.1249, -0.3926],
         [-1.1249, -0.3926],
         [-1.1249, -0.3926],
         [-1.1249, -0.3926],
         [-1.1249, -0.3926],
         [-1.1249, -0.3926],
         [-1.1249, -0.3926]],
        [[-0.7837, -0.6101],
         [-0.7837, -0.6101],
         [-0.7837, -0.6101],
         [-0.7837, -0.6101],
         [-0.7837, -0.6101],
         [-0.7837, -0.6101],
         [-0.7837, -0.6101],
         [-0.7837, -0.6101],
         [-0.7837, -0.6101],
         [-0.7837, -0.6101]],
        [[-1.3380, -0.3043],
         [-1.3380, -0.3043],
         [-1.3380, -0.3043],
         [-1.3380, -0.3043],
         [-1.3380, -0.3043],
         [-1.3380, -0.3043],
         [-1.3380, -0.3043],
         [-1.3380, -0.3043],
         [-1.3380, -0.3043],
         [-1.3380, -0.3043]],
        [[-0.6801, -0.7064],
         [-0.6801, -0.7064],
         [-0.6801, -0.7064],
         [-0.6801, -0.7064],
         [-0.6801, -0.7064],
         [-0.6801, -0.7064],
         [-0.6801, -0.7064],
         [-0.6801, -0.7064],
         [-0.6801, -0.7064],
         [-0.6801, -0.7064]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.8105, -0.5881],
         [-0.8105, -0.5881],
         [-0.8105, -0.5881],
         [-0.8105, -0.5881],
         [-0.8105, -0.5881],
         [-0.8105, -0.5881],
         [-0.8105, -0.5881],
         [-0.8105, -0.5881],
         [-0.8105, -0.5881],
         [-0.8105, -0.5881]],
        [[-0.8306, -0.5723],
         [-0.8306, -0.5723],
         [-0.8306, -0.5723],
         [-0.8306, -0.5723],
         [-0.8306, -0.5723],
         [-0.8306, -0.5723],
         [-0.8306, -0.5723],
         [-0.8306, -0.5723],
         [-0.8306, -0.5723],
         [-0.8306, -0.5723]],
        [[-0.5352, -0.8808],
         [-0.5352, -0.8808],
         [-0.5352, -0.8808],
         [-0.5352, -0.8808],
         [-0.5352, -0.8808],
         [-0.5352, -0.8808],
         [-0.5352, -0.8808],
         [-0.5352, -0.8808],
         [-0.5352, -0.8808],
         [-0.5352, -0.8808]],
        [[-0.6520, -0.7361],
         [-0.6520, -0.7361],
         [-0.6520, -0.7361],
         [-0.6520, -0.7361],
         [-0.6520, -0.7361],
         [-0.6520, -0.7361],
         [-0.6520, -0.7361],
         [-0.6520, -0.7361],
         [-0.6520, -0.7361],
         [-0.6520, -0.7361]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.0170, -0.4489],
         [-1.0170, -0.4489],
         [-1.0170, -0.4489],
         [-1.0170, -0.4489],
         [-1.0170, -0.4489],
         [-1.0170, -0.4489],
         [-1.0170, -0.4489],
         [-1.0170, -0.4489],
         [-1.0170, -0.4489],
         [-1.0170, -0.4489]],
        [[-0.7932, -0.6022],
         [-0.7932, -0.6022],
         [-0.7932, -0.6022],
         [-0.7932, -0.6022],
         [-0.7932, -0.6022],
         [-0.7932, -0.6022],
         [-0.7932, -0.6022],
         [-0.7932, -0.6022],
         [-0.7932, -0.6022],
         [-0.7932, -0.6022]],
        [[-0.5306, -0.8874],
         [-0.5306, -0.8874],
         [-0.5306, -0.8874],
         [-0.5306, -0.8874],
         [-0.5306, -0.8874],
         [-0.5306, -0.8874],
         [-0.5306, -0.8874],
         [-0.5306, -0.8874],
         [-0.5306, -0.8874],
         [-0.5306, -0.8874]],
        [[-0.7417, -0.6468],
         [-0.7417, -0.6468],
         [-0.7417, -0.6468],
         [-0.7417, -0.6468],
         [-0.7417, -0.6468],
         [-0.7417, -0.6468],
         [-0.7417, -0.6468],
         [-0.7417, -0.6468],
         [-0.7417, -0.6468],
         [-0.7417, -0.6468]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7621, -0.6287],
         [-0.7621, -0.6287],
         [-0.7621, -0.6287],
         [-0.7621, -0.6287],
         [-0.7621, -0.6287],
         [-0.7621, -0.6287],
         [-0.7621, -0.6287],
         [-0.7621, -0.6287],
         [-0.7621, -0.6287],
         [-0.7621, -0.6287]],
        [[-0.9039, -0.5191],
         [-0.9039, -0.5191],
         [-0.9039, -0.5191],
         [-0.9039, -0.5191],
         [-0.9039, -0.5191],
         [-0.9039, -0.5191],
         [-0.9039, -0.5191],
         [-0.9039, -0.5191],
         [-0.9039, -0.5191],
         [-0.9039, -0.5191]],
        [[-0.9923, -0.4632],
         [-0.9923, -0.4632],
         [-0.9923, -0.4632],
         [-0.9923, -0.4632],
         [-0.9923, -0.4632],
         [-0.9923, -0.4632],
         [-0.9923, -0.4632],
         [-0.9923, -0.4632],
         [-0.9923, -0.4632],
         [-0.9923, -0.4632]],
        [[-1.2378, -0.3425],
         [-1.2378, -0.3425],
         [-1.2378, -0.3425],
         [-1.2378, -0.3425],
         [-1.2378, -0.3425],
         [-1.2378, -0.3425],
         [-1.2378, -0.3425],
         [-1.2378, -0.3425],
         [-1.2378, -0.3425],
         [-1.2378, -0.3425]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4483, -1.0181],
         [-0.4483, -1.0181],
         [-0.4483, -1.0181],
         [-0.4483, -1.0181],
         [-0.4483, -1.0181],
         [-0.4483, -1.0181],
         [-0.4483, -1.0181],
         [-0.4483, -1.0181],
         [-0.4483, -1.0181],
         [-0.4483, -1.0181]],
        [[-1.0957, -0.4069],
         [-1.0957, -0.4069],
         [-1.0957, -0.4069],
         [-1.0957, -0.4069],
         [-1.0957, -0.4069],
         [-1.0957, -0.4069],
         [-1.0957, -0.4069],
         [-1.0957, -0.4069],
         [-1.0957, -0.4069],
         [-1.0957, -0.4069]],
        [[-0.6780, -0.7085],
         [-0.6780, -0.7085],
         [-0.6780, -0.7085],
         [-0.6780, -0.7085],
         [-0.6780, -0.7085],
         [-0.6780, -0.7085],
         [-0.6780, -0.7085],
         [-0.6780, -0.7085],
         [-0.6780, -0.7085],
         [-0.6780, -0.7085]],
        [[-1.0590, -0.4259],
         [-1.0590, -0.4259],
         [-1.0590, -0.4259],
         [-1.0590, -0.4259],
         [-1.0590, -0.4259],
         [-1.0590, -0.4259],
         [-1.0590, -0.4259],
         [-1.0590, -0.4259],
         [-1.0590, -0.4259],
         [-1.0590, -0.4259]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4361, -1.0401],
         [-0.4361, -1.0401],
         [-0.4361, -1.0401],
         [-0.4361, -1.0401],
         [-0.4361, -1.0401],
         [-0.4361, -1.0401],
         [-0.4361, -1.0401],
         [-0.4361, -1.0401],
         [-0.4361, -1.0401],
         [-0.4361, -1.0401]],
        [[-0.6962, -0.6901],
         [-0.6962, -0.6901],
         [-0.6962, -0.6901],
         [-0.6962, -0.6901],
         [-0.6962, -0.6901],
         [-0.6962, -0.6901],
         [-0.6962, -0.6901],
         [-0.6962, -0.6901],
         [-0.6962, -0.6901],
         [-0.6962, -0.6901]],
        [[-0.8196, -0.5809],
         [-0.8196, -0.5809],
         [-0.8196, -0.5809],
         [-0.8196, -0.5809],
         [-0.8196, -0.5809],
         [-0.8196, -0.5809],
         [-0.8196, -0.5809],
         [-0.8196, -0.5809],
         [-0.8196, -0.5809],
         [-0.8196, -0.5809]],
        [[-0.9082, -0.5163],
         [-0.9082, -0.5163],
         [-0.9082, -0.5163],
         [-0.9082, -0.5163],
         [-0.9082, -0.5163],
         [-0.9082, -0.5163],
         [-0.9082, -0.5163],
         [-0.9082, -0.5163],
         [-0.9082, -0.5163],
         [-0.9082, -0.5163]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.8844, -0.5327],
         [-0.8844, -0.5327],
         [-0.8844, -0.5327],
         [-0.8844, -0.5327],
         [-0.8844, -0.5327],
         [-0.8844, -0.5327],
         [-0.8844, -0.5327],
         [-0.8844, -0.5327],
         [-0.8844, -0.5327],
         [-0.8844, -0.5327]],
        [[-0.5652, -0.8399],
         [-0.5652, -0.8399],
         [-0.5652, -0.8399],
         [-0.5652, -0.8399],
         [-0.5652, -0.8399],
         [-0.5652, -0.8399],
         [-0.5652, -0.8399],
         [-0.5652, -0.8399],
         [-0.5652, -0.8399],
         [-0.5652, -0.8399]],
        [[-0.6004, -0.7954],
         [-0.6004, -0.7954],
         [-0.6004, -0.7954],
         [-0.6004, -0.7954],
         [-0.6004, -0.7954],
         [-0.6004, -0.7954],
         [-0.6004, -0.7954],
         [-0.6004, -0.7954],
         [-0.6004, -0.7954],
         [-0.6004, -0.7954]],
        [[-0.3746, -1.1634],
         [-0.3746, -1.1634],
         [-0.3746, -1.1634],
         [-0.3746, -1.1634],
         [-0.3746, -1.1634],
         [-0.3746, -1.1634],
         [-0.3746, -1.1634],
         [-0.3746, -1.1634],
         [-0.3746, -1.1634],
         [-0.3746, -1.1634]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6970, -0.6893],
         [-0.6970, -0.6893],
         [-0.6970, -0.6893],
         [-0.6970, -0.6893],
         [-0.6970, -0.6893],
         [-0.6970, -0.6893],
         [-0.6970, -0.6893],
         [-0.6970, -0.6893],
         [-0.6970, -0.6893],
         [-0.6970, -0.6893]],
        [[-0.5857, -0.8136],
         [-0.5857, -0.8136],
         [-0.5857, -0.8136],
         [-0.5857, -0.8136],
         [-0.5857, -0.8136],
         [-0.5857, -0.8136],
         [-0.5857, -0.8136],
         [-0.5857, -0.8136],
         [-0.5857, -0.8136],
         [-0.5857, -0.8136]],
        [[-0.4061, -1.0974],
         [-0.4061, -1.0974],
         [-0.4061, -1.0974],
         [-0.4061, -1.0974],
         [-0.4061, -1.0974],
         [-0.4061, -1.0974],
         [-0.4061, -1.0974],
         [-0.4061, -1.0974],
         [-0.4061, -1.0974],
         [-0.4061, -1.0974]],
        [[-1.0476, -0.4320],
         [-1.0476, -0.4320],
         [-1.0476, -0.4320],
         [-1.0476, -0.4320],
         [-1.0476, -0.4320],
         [-1.0476, -0.4320],
         [-1.0476, -0.4320],
         [-1.0476, -0.4320],
         [-1.0476, -0.4320],
         [-1.0476, -0.4320]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5076, -0.9212],
         [-0.5076, -0.9212],
         [-0.5076, -0.9212],
         [-0.5076, -0.9212],
         [-0.5076, -0.9212],
         [-0.5076, -0.9212],
         [-0.5076, -0.9212],
         [-0.5076, -0.9212],
         [-0.5076, -0.9212],
         [-0.5076, -0.9212]],
        [[-0.6208, -0.7712],
         [-0.6208, -0.7712],
         [-0.6208, -0.7712],
         [-0.6208, -0.7712],
         [-0.6208, -0.7712],
         [-0.6208, -0.7712],
         [-0.6208, -0.7712],
         [-0.6208, -0.7712],
         [-0.6208, -0.7712],
         [-0.6208, -0.7712]],
        [[-0.8227, -0.5784],
         [-0.8227, -0.5784],
         [-0.8227, -0.5784],
         [-0.8227, -0.5784],
         [-0.8227, -0.5784],
         [-0.8227, -0.5784],
         [-0.8227, -0.5784],
         [-0.8227, -0.5784],
         [-0.8227, -0.5784],
         [-0.8227, -0.5784]],
        [[-0.9937, -0.4624],
         [-0.9937, -0.4624],
         [-0.9937, -0.4624],
         [-0.9937, -0.4624],
         [-0.9937, -0.4624],
         [-0.9937, -0.4624],
         [-0.9937, -0.4624],
         [-0.9937, -0.4624],
         [-0.9937, -0.4624],
         [-0.9937, -0.4624]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.0669, -0.4217],
         [-1.0669, -0.4217],
         [-1.0669, -0.4217],
         [-1.0669, -0.4217],
         [-1.0669, -0.4217],
         [-1.0669, -0.4217],
         [-1.0669, -0.4217],
         [-1.0669, -0.4217],
         [-1.0669, -0.4217],
         [-1.0669, -0.4217]],
        [[-0.6971, -0.6892],
         [-0.6971, -0.6892],
         [-0.6971, -0.6892],
         [-0.6971, -0.6892],
         [-0.6971, -0.6892],
         [-0.6971, -0.6892],
         [-0.6971, -0.6892],
         [-0.6971, -0.6892],
         [-0.6971, -0.6892],
         [-0.6971, -0.6892]],
        [[-0.7063, -0.6801],
         [-0.7063, -0.6801],
         [-0.7063, -0.6801],
         [-0.7063, -0.6801],
         [-0.7063, -0.6801],
         [-0.7063, -0.6801],
         [-0.7063, -0.6801],
         [-0.7063, -0.6801],
         [-0.7063, -0.6801],
         [-0.7063, -0.6801]],
        [[-0.7674, -0.6240],
         [-0.7674, -0.6240],
         [-0.7674, -0.6240],
         [-0.7674, -0.6240],
         [-0.7674, -0.6240],
         [-0.7674, -0.6240],
         [-0.7674, -0.6240],
         [-0.7674, -0.6240],
         [-0.7674, -0.6240],
         [-0.7674, -0.6240]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.8516, -0.5564],
         [-0.8516, -0.5564],
         [-0.8516, -0.5564],
         [-0.8516, -0.5564],
         [-0.8516, -0.5564],
         [-0.8516, -0.5564],
         [-0.8516, -0.5564],
         [-0.8516, -0.5564],
         [-0.8516, -0.5564],
         [-0.8516, -0.5564]],
        [[-0.4618, -0.9946],
         [-0.4618, -0.9946],
         [-0.4618, -0.9946],
         [-0.4618, -0.9946],
         [-0.4618, -0.9946],
         [-0.4618, -0.9946],
         [-0.4618, -0.9946],
         [-0.4618, -0.9946],
         [-0.4618, -0.9946],
         [-0.4618, -0.9946]],
        [[-0.6654, -0.7217],
         [-0.6654, -0.7217],
         [-0.6654, -0.7217],
         [-0.6654, -0.7217],
         [-0.6654, -0.7217],
         [-0.6654, -0.7217],
         [-0.6654, -0.7217],
         [-0.6654, -0.7217],
         [-0.6654, -0.7217],
         [-0.6654, -0.7217]],
        [[-0.3244, -1.2835],
         [-0.3244, -1.2835],
         [-0.3244, -1.2835],
         [-0.3244, -1.2835],
         [-0.3244, -1.2835],
         [-0.3244, -1.2835],
         [-0.3244, -1.2835],
         [-0.3244, -1.2835],
         [-0.3244, -1.2835],
         [-0.3244, -1.2835]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5127, -0.9136],
         [-0.5127, -0.9136],
         [-0.5127, -0.9136],
         [-0.5127, -0.9136],
         [-0.5127, -0.9136],
         [-0.5127, -0.9136],
         [-0.5127, -0.9136],
         [-0.5127, -0.9136],
         [-0.5127, -0.9136],
         [-0.5127, -0.9136]],
        [[-0.3541, -1.2099],
         [-0.3541, -1.2099],
         [-0.3541, -1.2099],
         [-0.3541, -1.2099],
         [-0.3541, -1.2099],
         [-0.3541, -1.2099],
         [-0.3541, -1.2099],
         [-0.3541, -1.2099],
         [-0.3541, -1.2099],
         [-0.3541, -1.2099]],
        [[-0.3397, -1.2449],
         [-0.3397, -1.2449],
         [-0.3397, -1.2449],
         [-0.3397, -1.2449],
         [-0.3397, -1.2449],
         [-0.3397, -1.2449],
         [-0.3397, -1.2449],
         [-0.3397, -1.2449],
         [-0.3397, -1.2449],
         [-0.3397, -1.2449]],
        [[-1.2004, -0.3582],
         [-1.2004, -0.3582],
         [-1.2004, -0.3582],
         [-1.2004, -0.3582],
         [-1.2004, -0.3582],
         [-1.2004, -0.3582],
         [-1.2004, -0.3582],
         [-1.2004, -0.3582],
         [-1.2004, -0.3582],
         [-1.2004, -0.3582]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.2399, -0.3417],
         [-1.2399, -0.3417],
         [-1.2399, -0.3417],
         [-1.2399, -0.3417],
         [-1.2399, -0.3417],
         [-1.2399, -0.3417],
         [-1.2399, -0.3417],
         [-1.2399, -0.3417],
         [-1.2399, -0.3417],
         [-1.2399, -0.3417]],
        [[-0.3275, -1.2755],
         [-0.3275, -1.2755],
         [-0.3275, -1.2755],
         [-0.3275, -1.2755],
         [-0.3275, -1.2755],
         [-0.3275, -1.2755],
         [-0.3275, -1.2755],
         [-0.3275, -1.2755],
         [-0.3275, -1.2755],
         [-0.3275, -1.2755]],
        [[-0.5929, -0.8046],
         [-0.5929, -0.8046],
         [-0.5929, -0.8046],
         [-0.5929, -0.8046],
         [-0.5929, -0.8046],
         [-0.5929, -0.8046],
         [-0.5929, -0.8046],
         [-0.5929, -0.8046],
         [-0.5929, -0.8046],
         [-0.5929, -0.8046]],
        [[-0.6765, -0.7100],
         [-0.6765, -0.7100],
         [-0.6765, -0.7100],
         [-0.6765, -0.7100],
         [-0.6765, -0.7100],
         [-0.6765, -0.7100],
         [-0.6765, -0.7100],
         [-0.6765, -0.7100],
         [-0.6765, -0.7100],
         [-0.6765, -0.7100]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5414, -0.8721],
         [-0.5414, -0.8721],
         [-0.5414, -0.8721],
         [-0.5414, -0.8721],
         [-0.5414, -0.8721],
         [-0.5414, -0.8721],
         [-0.5414, -0.8721],
         [-0.5414, -0.8721],
         [-0.5414, -0.8721],
         [-0.5414, -0.8721]],
        [[-0.2570, -1.4844],
         [-0.2570, -1.4844],
         [-0.2570, -1.4844],
         [-0.2570, -1.4844],
         [-0.2570, -1.4844],
         [-0.2570, -1.4844],
         [-0.2570, -1.4844],
         [-0.2570, -1.4844],
         [-0.2570, -1.4844],
         [-0.2570, -1.4844]],
        [[-0.4262, -1.0584],
         [-0.4262, -1.0584],
         [-0.4262, -1.0584],
         [-0.4262, -1.0584],
         [-0.4262, -1.0584],
         [-0.4262, -1.0584],
         [-0.4262, -1.0584],
         [-0.4262, -1.0584],
         [-0.4262, -1.0584],
         [-0.4262, -1.0584]],
        [[-0.5525, -0.8569],
         [-0.5525, -0.8569],
         [-0.5525, -0.8569],
         [-0.5525, -0.8569],
         [-0.5525, -0.8569],
         [-0.5525, -0.8569],
         [-0.5525, -0.8569],
         [-0.5525, -0.8569],
         [-0.5525, -0.8569],
         [-0.5525, -0.8569]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.8932, -0.5265],
         [-0.8932, -0.5265],
         [-0.8932, -0.5265],
         [-0.8932, -0.5265],
         [-0.8932, -0.5265],
         [-0.8932, -0.5265],
         [-0.8932, -0.5265],
         [-0.8932, -0.5265],
         [-0.8932, -0.5265],
         [-0.8932, -0.5265]],
        [[-0.6122, -0.7813],
         [-0.6122, -0.7813],
         [-0.6122, -0.7813],
         [-0.6122, -0.7813],
         [-0.6122, -0.7813],
         [-0.6122, -0.7813],
         [-0.6122, -0.7813],
         [-0.6122, -0.7813],
         [-0.6122, -0.7813],
         [-0.6122, -0.7813]],
        [[-0.9456, -0.4918],
         [-0.9456, -0.4918],
         [-0.9456, -0.4918],
         [-0.9456, -0.4918],
         [-0.9456, -0.4918],
         [-0.9456, -0.4918],
         [-0.9456, -0.4918],
         [-0.9456, -0.4918],
         [-0.9456, -0.4918],
         [-0.9456, -0.4918]],
        [[-0.3999, -1.1099],
         [-0.3999, -1.1099],
         [-0.3999, -1.1099],
         [-0.3999, -1.1099],
         [-0.3999, -1.1099],
         [-0.3999, -1.1099],
         [-0.3999, -1.1099],
         [-0.3999, -1.1099],
         [-0.3999, -1.1099],
         [-0.3999, -1.1099]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6706, -0.7162],
         [-0.6706, -0.7162],
         [-0.6706, -0.7162],
         [-0.6706, -0.7162],
         [-0.6706, -0.7162],
         [-0.6706, -0.7162],
         [-0.6706, -0.7162],
         [-0.6706, -0.7162],
         [-0.6706, -0.7162],
         [-0.6706, -0.7162]],
        [[-0.6723, -0.7145],
         [-0.6723, -0.7145],
         [-0.6723, -0.7145],
         [-0.6723, -0.7145],
         [-0.6723, -0.7145],
         [-0.6723, -0.7145],
         [-0.6723, -0.7145],
         [-0.6723, -0.7145],
         [-0.6723, -0.7145],
         [-0.6723, -0.7145]],
        [[-1.1827, -0.3659],
         [-1.1827, -0.3659],
         [-1.1827, -0.3659],
         [-1.1827, -0.3659],
         [-1.1827, -0.3659],
         [-1.1827, -0.3659],
         [-1.1827, -0.3659],
         [-1.1827, -0.3659],
         [-1.1827, -0.3659],
         [-1.1827, -0.3659]],
        [[-1.0501, -0.4306],
         [-1.0501, -0.4306],
         [-1.0501, -0.4306],
         [-1.0501, -0.4306],
         [-1.0501, -0.4306],
         [-1.0501, -0.4306],
         [-1.0501, -0.4306],
         [-1.0501, -0.4306],
         [-1.0501, -0.4306],
         [-1.0501, -0.4306]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5673, -0.8371],
         [-0.5673, -0.8371],
         [-0.5673, -0.8371],
         [-0.5673, -0.8371],
         [-0.5673, -0.8371],
         [-0.5673, -0.8371],
         [-0.5673, -0.8371],
         [-0.5673, -0.8371],
         [-0.5673, -0.8371],
         [-0.5673, -0.8371]],
        [[-0.7318, -0.6559],
         [-0.7318, -0.6559],
         [-0.7318, -0.6559],
         [-0.7318, -0.6559],
         [-0.7318, -0.6559],
         [-0.7318, -0.6559],
         [-0.7318, -0.6559],
         [-0.7318, -0.6559],
         [-0.7318, -0.6559],
         [-0.7318, -0.6559]],
        [[-0.4021, -1.1053],
         [-0.4021, -1.1053],
         [-0.4021, -1.1053],
         [-0.4021, -1.1053],
         [-0.4021, -1.1053],
         [-0.4021, -1.1053],
         [-0.4021, -1.1053],
         [-0.4021, -1.1053],
         [-0.4021, -1.1053],
         [-0.4021, -1.1053]],
        [[-0.7401, -0.6483],
         [-0.7401, -0.6483],
         [-0.7401, -0.6483],
         [-0.7401, -0.6483],
         [-0.7401, -0.6483],
         [-0.7401, -0.6483],
         [-0.7401, -0.6483],
         [-0.7401, -0.6483],
         [-0.7401, -0.6483],
         [-0.7401, -0.6483]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.2705, -1.4398],
         [-0.2705, -1.4398],
         [-0.2705, -1.4398],
         [-0.2705, -1.4398],
         [-0.2705, -1.4398],
         [-0.2705, -1.4398],
         [-0.2705, -1.4398],
         [-0.2705, -1.4398],
         [-0.2705, -1.4398],
         [-0.2705, -1.4398]],
        [[-0.5836, -0.8162],
         [-0.5836, -0.8162],
         [-0.5836, -0.8162],
         [-0.5836, -0.8162],
         [-0.5836, -0.8162],
         [-0.5836, -0.8162],
         [-0.5836, -0.8162],
         [-0.5836, -0.8162],
         [-0.5836, -0.8162],
         [-0.5836, -0.8162]],
        [[-1.3920, -0.2858],
         [-1.3920, -0.2858],
         [-1.3920, -0.2858],
         [-1.3920, -0.2858],
         [-1.3920, -0.2858],
         [-1.3920, -0.2858],
         [-1.3920, -0.2858],
         [-1.3920, -0.2858],
         [-1.3920, -0.2858],
         [-1.3920, -0.2858]],
        [[-1.0365, -0.4380],
         [-1.0365, -0.4380],
         [-1.0365, -0.4380],
         [-1.0365, -0.4380],
         [-1.0365, -0.4380],
         [-1.0365, -0.4380],
         [-1.0365, -0.4380],
         [-1.0365, -0.4380],
         [-1.0365, -0.4380],
         [-1.0365, -0.4380]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7947, -0.6009],
         [-0.7947, -0.6009],
         [-0.7947, -0.6009],
         [-0.7947, -0.6009],
         [-0.7947, -0.6009],
         [-0.7947, -0.6009],
         [-0.7947, -0.6009],
         [-0.7947, -0.6009],
         [-0.7947, -0.6009],
         [-0.7947, -0.6009]],
        [[-0.7199, -0.6671],
         [-0.7199, -0.6671],
         [-0.7199, -0.6671],
         [-0.7199, -0.6671],
         [-0.7199, -0.6671],
         [-0.7199, -0.6671],
         [-0.7199, -0.6671],
         [-0.7199, -0.6671],
         [-0.7199, -0.6671],
         [-0.7199, -0.6671]],
        [[-0.7971, -0.5990],
         [-0.7971, -0.5990],
         [-0.7971, -0.5990],
         [-0.7971, -0.5990],
         [-0.7971, -0.5990],
         [-0.7971, -0.5990],
         [-0.7971, -0.5990],
         [-0.7971, -0.5990],
         [-0.7971, -0.5990],
         [-0.7971, -0.5990]],
        [[-0.3296, -1.2703],
         [-0.3296, -1.2703],
         [-0.3296, -1.2703],
         [-0.3296, -1.2703],
         [-0.3296, -1.2703],
         [-0.3296, -1.2703],
         [-0.3296, -1.2703],
         [-0.3296, -1.2703],
         [-0.3296, -1.2703],
         [-0.3296, -1.2703]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4858, -0.9550],
         [-0.4858, -0.9550],
         [-0.4858, -0.9550],
         [-0.4858, -0.9550],
         [-0.4858, -0.9550],
         [-0.4858, -0.9550],
         [-0.4858, -0.9550],
         [-0.4858, -0.9550],
         [-0.4858, -0.9550],
         [-0.4858, -0.9550]],
        [[-0.7827, -0.6109],
         [-0.7827, -0.6109],
         [-0.7827, -0.6109],
         [-0.7827, -0.6109],
         [-0.7827, -0.6109],
         [-0.7827, -0.6109],
         [-0.7827, -0.6109],
         [-0.7827, -0.6109],
         [-0.7827, -0.6109],
         [-0.7827, -0.6109]],
        [[-1.0462, -0.4328],
         [-1.0462, -0.4328],
         [-1.0462, -0.4328],
         [-1.0462, -0.4328],
         [-1.0462, -0.4328],
         [-1.0462, -0.4328],
         [-1.0462, -0.4328],
         [-1.0462, -0.4328],
         [-1.0462, -0.4328],
         [-1.0462, -0.4328]],
        [[-0.4338, -1.0443],
         [-0.4338, -1.0443],
         [-0.4338, -1.0443],
         [-0.4338, -1.0443],
         [-0.4338, -1.0443],
         [-0.4338, -1.0443],
         [-0.4338, -1.0443],
         [-0.4338, -1.0443],
         [-0.4338, -1.0443],
         [-0.4338, -1.0443]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4700, -0.9809],
         [-0.4700, -0.9809],
         [-0.4700, -0.9809],
         [-0.4700, -0.9809],
         [-0.4700, -0.9809],
         [-0.4700, -0.9809],
         [-0.4700, -0.9809],
         [-0.4700, -0.9809],
         [-0.4700, -0.9809],
         [-0.4700, -0.9809]],
        [[-0.4074, -1.0948],
         [-0.4074, -1.0948],
         [-0.4074, -1.0948],
         [-0.4074, -1.0948],
         [-0.4074, -1.0948],
         [-0.4074, -1.0948],
         [-0.4074, -1.0948],
         [-0.4074, -1.0948],
         [-0.4074, -1.0948],
         [-0.4074, -1.0948]],
        [[-0.9274, -0.5035],
         [-0.9274, -0.5035],
         [-0.9274, -0.5035],
         [-0.9274, -0.5035],
         [-0.9274, -0.5035],
         [-0.9274, -0.5035],
         [-0.9274, -0.5035],
         [-0.9274, -0.5035],
         [-0.9274, -0.5035],
         [-0.9274, -0.5035]],
        [[-0.4004, -1.1089],
         [-0.4004, -1.1089],
         [-0.4004, -1.1089],
         [-0.4004, -1.1089],
         [-0.4004, -1.1089],
         [-0.4004, -1.1089],
         [-0.4004, -1.1089],
         [-0.4004, -1.1089],
         [-0.4004, -1.1089],
         [-0.4004, -1.1089]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6272, -0.7637],
         [-0.6272, -0.7637],
         [-0.6272, -0.7637],
         [-0.6272, -0.7637],
         [-0.6272, -0.7637],
         [-0.6272, -0.7637],
         [-0.6272, -0.7637],
         [-0.6272, -0.7637],
         [-0.6272, -0.7637],
         [-0.6272, -0.7637]],
        [[-0.7056, -0.6808],
         [-0.7056, -0.6808],
         [-0.7056, -0.6808],
         [-0.7056, -0.6808],
         [-0.7056, -0.6808],
         [-0.7056, -0.6808],
         [-0.7056, -0.6808],
         [-0.7056, -0.6808],
         [-0.7056, -0.6808],
         [-0.7056, -0.6808]],
        [[-0.3865, -1.1376],
         [-0.3865, -1.1376],
         [-0.3865, -1.1376],
         [-0.3865, -1.1376],
         [-0.3865, -1.1376],
         [-0.3865, -1.1376],
         [-0.3865, -1.1376],
         [-0.3865, -1.1376],
         [-0.3865, -1.1376],
         [-0.3865, -1.1376]],
        [[-0.5309, -0.8869],
         [-0.5309, -0.8869],
         [-0.5309, -0.8869],
         [-0.5309, -0.8869],
         [-0.5309, -0.8869],
         [-0.5309, -0.8869],
         [-0.5309, -0.8869],
         [-0.5309, -0.8869],
         [-0.5309, -0.8869],
         [-0.5309, -0.8869]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4460, -1.0222],
         [-0.4460, -1.0222],
         [-0.4460, -1.0222],
         [-0.4460, -1.0222],
         [-0.4460, -1.0222],
         [-0.4460, -1.0222],
         [-0.4460, -1.0222],
         [-0.4460, -1.0222],
         [-0.4460, -1.0222],
         [-0.4460, -1.0222]],
        [[-0.4258, -1.0591],
         [-0.4258, -1.0591],
         [-0.4258, -1.0591],
         [-0.4258, -1.0591],
         [-0.4258, -1.0591],
         [-0.4258, -1.0591],
         [-0.4258, -1.0591],
         [-0.4258, -1.0591],
         [-0.4258, -1.0591],
         [-0.4258, -1.0591]],
        [[-0.4545, -1.0072],
         [-0.4545, -1.0072],
         [-0.4545, -1.0072],
         [-0.4545, -1.0072],
         [-0.4545, -1.0072],
         [-0.4545, -1.0072],
         [-0.4545, -1.0072],
         [-0.4545, -1.0072],
         [-0.4545, -1.0072],
         [-0.4545, -1.0072]],
        [[-0.8070, -0.5909],
         [-0.8070, -0.5909],
         [-0.8070, -0.5909],
         [-0.8070, -0.5909],
         [-0.8070, -0.5909],
         [-0.8070, -0.5909],
         [-0.8070, -0.5909],
         [-0.8070, -0.5909],
         [-0.8070, -0.5909],
         [-0.8070, -0.5909]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.1077, -0.4010],
         [-1.1077, -0.4010],
         [-1.1077, -0.4010],
         [-1.1077, -0.4010],
         [-1.1077, -0.4010],
         [-1.1077, -0.4010],
         [-1.1077, -0.4010],
         [-1.1077, -0.4010],
         [-1.1077, -0.4010],
         [-1.1077, -0.4010]],
        [[-0.4711, -0.9790],
         [-0.4711, -0.9790],
         [-0.4711, -0.9790],
         [-0.4711, -0.9790],
         [-0.4711, -0.9790],
         [-0.4711, -0.9790],
         [-0.4711, -0.9790],
         [-0.4711, -0.9790],
         [-0.4711, -0.9790],
         [-0.4711, -0.9790]],
        [[-1.5006, -0.2523],
         [-1.5006, -0.2523],
         [-1.5006, -0.2523],
         [-1.5006, -0.2523],
         [-1.5006, -0.2523],
         [-1.5006, -0.2523],
         [-1.5006, -0.2523],
         [-1.5006, -0.2523],
         [-1.5006, -0.2523],
         [-1.5006, -0.2523]],
        [[-1.0337, -0.4396],
         [-1.0337, -0.4396],
         [-1.0337, -0.4396],
         [-1.0337, -0.4396],
         [-1.0337, -0.4396],
         [-1.0337, -0.4396],
         [-1.0337, -0.4396],
         [-1.0337, -0.4396],
         [-1.0337, -0.4396],
         [-1.0337, -0.4396]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5213, -0.9008],
         [-0.5213, -0.9008],
         [-0.5213, -0.9008],
         [-0.5213, -0.9008],
         [-0.5213, -0.9008],
         [-0.5213, -0.9008],
         [-0.5213, -0.9008],
         [-0.5213, -0.9008],
         [-0.5213, -0.9008],
         [-0.5213, -0.9008]],
        [[-1.2026, -0.3573],
         [-1.2026, -0.3573],
         [-1.2026, -0.3573],
         [-1.2026, -0.3573],
         [-1.2026, -0.3573],
         [-1.2026, -0.3573],
         [-1.2026, -0.3573],
         [-1.2026, -0.3573],
         [-1.2026, -0.3573],
         [-1.2026, -0.3573]],
        [[-1.1904, -0.3626],
         [-1.1904, -0.3626],
         [-1.1904, -0.3626],
         [-1.1904, -0.3626],
         [-1.1904, -0.3626],
         [-1.1904, -0.3626],
         [-1.1904, -0.3626],
         [-1.1904, -0.3626],
         [-1.1904, -0.3626],
         [-1.1904, -0.3626]],
        [[-0.4913, -0.9464],
         [-0.4913, -0.9464],
         [-0.4913, -0.9464],
         [-0.4913, -0.9464],
         [-0.4913, -0.9464],
         [-0.4913, -0.9464],
         [-0.4913, -0.9464],
         [-0.4913, -0.9464],
         [-0.4913, -0.9464],
         [-0.4913, -0.9464]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.2263, -1.5971],
         [-0.2263, -1.5971],
         [-0.2263, -1.5971],
         [-0.2263, -1.5971],
         [-0.2263, -1.5971],
         [-0.2263, -1.5971],
         [-0.2263, -1.5971],
         [-0.2263, -1.5971],
         [-0.2263, -1.5971],
         [-0.2263, -1.5971]],
        [[-0.3033, -1.3407],
         [-0.3033, -1.3407],
         [-0.3033, -1.3407],
         [-0.3033, -1.3407],
         [-0.3033, -1.3407],
         [-0.3033, -1.3407],
         [-0.3033, -1.3407],
         [-0.3033, -1.3407],
         [-0.3033, -1.3407],
         [-0.3033, -1.3407]],
        [[-0.4614, -0.9953],
         [-0.4614, -0.9953],
         [-0.4614, -0.9953],
         [-0.4614, -0.9953],
         [-0.4614, -0.9953],
         [-0.4614, -0.9953],
         [-0.4614, -0.9953],
         [-0.4614, -0.9953],
         [-0.4614, -0.9953],
         [-0.4614, -0.9953]],
        [[-1.2381, -0.3424],
         [-1.2381, -0.3424],
         [-1.2381, -0.3424],
         [-1.2381, -0.3424],
         [-1.2381, -0.3424],
         [-1.2381, -0.3424],
         [-1.2381, -0.3424],
         [-1.2381, -0.3424],
         [-1.2381, -0.3424],
         [-1.2381, -0.3424]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.3098, -0.3145],
         [-1.3098, -0.3145],
         [-1.3098, -0.3145],
         [-1.3098, -0.3145],
         [-1.3098, -0.3145],
         [-1.3098, -0.3145],
         [-1.3098, -0.3145],
         [-1.3098, -0.3145],
         [-1.3098, -0.3145],
         [-1.3098, -0.3145]],
        [[-1.5662, -0.2342],
         [-1.5662, -0.2342],
         [-1.5662, -0.2342],
         [-1.5662, -0.2342],
         [-1.5662, -0.2342],
         [-1.5662, -0.2342],
         [-1.5662, -0.2342],
         [-1.5662, -0.2342],
         [-1.5662, -0.2342],
         [-1.5662, -0.2342]],
        [[-0.9986, -0.4595],
         [-0.9986, -0.4595],
         [-0.9986, -0.4595],
         [-0.9986, -0.4595],
         [-0.9986, -0.4595],
         [-0.9986, -0.4595],
         [-0.9986, -0.4595],
         [-0.9986, -0.4595],
         [-0.9986, -0.4595],
         [-0.9986, -0.4595]],
        [[-0.5409, -0.8728],
         [-0.5409, -0.8728],
         [-0.5409, -0.8728],
         [-0.5409, -0.8728],
         [-0.5409, -0.8728],
         [-0.5409, -0.8728],
         [-0.5409, -0.8728],
         [-0.5409, -0.8728],
         [-0.5409, -0.8728],
         [-0.5409, -0.8728]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.3121, -0.3137],
         [-1.3121, -0.3137],
         [-1.3121, -0.3137],
         [-1.3121, -0.3137],
         [-1.3121, -0.3137],
         [-1.3121, -0.3137],
         [-1.3121, -0.3137],
         [-1.3121, -0.3137],
         [-1.3121, -0.3137],
         [-1.3121, -0.3137]],
        [[-1.2298, -0.3458],
         [-1.2298, -0.3458],
         [-1.2298, -0.3458],
         [-1.2298, -0.3458],
         [-1.2298, -0.3458],
         [-1.2298, -0.3458],
         [-1.2298, -0.3458],
         [-1.2298, -0.3458],
         [-1.2298, -0.3458],
         [-1.2298, -0.3458]],
        [[-0.6841, -0.7023],
         [-0.6841, -0.7023],
         [-0.6841, -0.7023],
         [-0.6841, -0.7023],
         [-0.6841, -0.7023],
         [-0.6841, -0.7023],
         [-0.6841, -0.7023],
         [-0.6841, -0.7023],
         [-0.6841, -0.7023],
         [-0.6841, -0.7023]],
        [[-0.5757, -0.8263],
         [-0.5757, -0.8263],
         [-0.5757, -0.8263],
         [-0.5757, -0.8263],
         [-0.5757, -0.8263],
         [-0.5757, -0.8263],
         [-0.5757, -0.8263],
         [-0.5757, -0.8263],
         [-0.5757, -0.8263],
         [-0.5757, -0.8263]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6985, -0.6878],
         [-0.6985, -0.6878],
         [-0.6985, -0.6878],
         [-0.6985, -0.6878],
         [-0.6985, -0.6878],
         [-0.6985, -0.6878],
         [-0.6985, -0.6878],
         [-0.6985, -0.6878],
         [-0.6985, -0.6878],
         [-0.6985, -0.6878]],
        [[-0.4033, -1.1030],
         [-0.4033, -1.1030],
         [-0.4033, -1.1030],
         [-0.4033, -1.1030],
         [-0.4033, -1.1030],
         [-0.4033, -1.1030],
         [-0.4033, -1.1030],
         [-0.4033, -1.1030],
         [-0.4033, -1.1030],
         [-0.4033, -1.1030]],
        [[-0.2142, -1.6461],
         [-0.2142, -1.6461],
         [-0.2142, -1.6461],
         [-0.2142, -1.6461],
         [-0.2142, -1.6461],
         [-0.2142, -1.6461],
         [-0.2142, -1.6461],
         [-0.2142, -1.6461],
         [-0.2142, -1.6461],
         [-0.2142, -1.6461]],
        [[-0.9405, -0.4950],
         [-0.9405, -0.4950],
         [-0.9405, -0.4950],
         [-0.9405, -0.4950],
         [-0.9405, -0.4950],
         [-0.9405, -0.4950],
         [-0.9405, -0.4950],
         [-0.9405, -0.4950],
         [-0.9405, -0.4950],
         [-0.9405, -0.4950]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.2018, -0.3576],
         [-1.2018, -0.3576],
         [-1.2018, -0.3576],
         [-1.2018, -0.3576],
         [-1.2018, -0.3576],
         [-1.2018, -0.3576],
         [-1.2018, -0.3576],
         [-1.2018, -0.3576],
         [-1.2018, -0.3576],
         [-1.2018, -0.3576]],
        [[-0.4394, -1.0339],
         [-0.4394, -1.0339],
         [-0.4394, -1.0339],
         [-0.4394, -1.0339],
         [-0.4394, -1.0339],
         [-0.4394, -1.0339],
         [-0.4394, -1.0339],
         [-0.4394, -1.0339],
         [-0.4394, -1.0339],
         [-0.4394, -1.0339]],
        [[-1.3650, -0.2949],
         [-1.3650, -0.2949],
         [-1.3650, -0.2949],
         [-1.3650, -0.2949],
         [-1.3650, -0.2949],
         [-1.3650, -0.2949],
         [-1.3650, -0.2949],
         [-1.3650, -0.2949],
         [-1.3650, -0.2949],
         [-1.3650, -0.2949]],
        [[-1.4342, -0.2722],
         [-1.4342, -0.2722],
         [-1.4342, -0.2722],
         [-1.4342, -0.2722],
         [-1.4342, -0.2722],
         [-1.4342, -0.2722],
         [-1.4342, -0.2722],
         [-1.4342, -0.2722],
         [-1.4342, -0.2722],
         [-1.4342, -0.2722]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.6682, -0.2090],
         [-1.6682, -0.2090],
         [-1.6682, -0.2090],
         [-1.6682, -0.2090],
         [-1.6682, -0.2090],
         [-1.6682, -0.2090],
         [-1.6682, -0.2090],
         [-1.6682, -0.2090],
         [-1.6682, -0.2090],
         [-1.6682, -0.2090]],
        [[-0.2881, -1.3849],
         [-0.2881, -1.3849],
         [-0.2881, -1.3849],
         [-0.2881, -1.3849],
         [-0.2881, -1.3849],
         [-0.2881, -1.3849],
         [-0.2881, -1.3849],
         [-0.2881, -1.3849],
         [-0.2881, -1.3849],
         [-0.2881, -1.3849]],
        [[-0.5134, -0.9124],
         [-0.5134, -0.9124],
         [-0.5134, -0.9124],
         [-0.5134, -0.9124],
         [-0.5134, -0.9124],
         [-0.5134, -0.9124],
         [-0.5134, -0.9124],
         [-0.5134, -0.9124],
         [-0.5134, -0.9124],
         [-0.5134, -0.9124]],
        [[-0.8372, -0.5673],
         [-0.8372, -0.5673],
         [-0.8372, -0.5673],
         [-0.8372, -0.5673],
         [-0.8372, -0.5673],
         [-0.8372, -0.5673],
         [-0.8372, -0.5673],
         [-0.8372, -0.5673],
         [-0.8372, -0.5673],
         [-0.8372, -0.5673]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.3876, -0.2872],
         [-1.3876, -0.2872],
         [-1.3876, -0.2872],
         [-1.3876, -0.2872],
         [-1.3876, -0.2872],
         [-1.3876, -0.2872],
         [-1.3876, -0.2872],
         [-1.3876, -0.2872],
         [-1.3876, -0.2872],
         [-1.3876, -0.2872]],
        [[-1.3116, -0.3139],
         [-1.3116, -0.3139],
         [-1.3116, -0.3139],
         [-1.3116, -0.3139],
         [-1.3116, -0.3139],
         [-1.3116, -0.3139],
         [-1.3116, -0.3139],
         [-1.3116, -0.3139],
         [-1.3116, -0.3139],
         [-1.3116, -0.3139]],
        [[-0.4585, -1.0003],
         [-0.4585, -1.0003],
         [-0.4585, -1.0003],
         [-0.4585, -1.0003],
         [-0.4585, -1.0003],
         [-0.4585, -1.0003],
         [-0.4585, -1.0003],
         [-0.4585, -1.0003],
         [-0.4585, -1.0003],
         [-0.4585, -1.0003]],
        [[-0.3906, -1.1291],
         [-0.3906, -1.1291],
         [-0.3906, -1.1291],
         [-0.3906, -1.1291],
         [-0.3906, -1.1291],
         [-0.3906, -1.1291],
         [-0.3906, -1.1291],
         [-0.3906, -1.1291],
         [-0.3906, -1.1291],
         [-0.3906, -1.1291]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.3665, -1.1814],
         [-0.3665, -1.1814],
         [-0.3665, -1.1814],
         [-0.3665, -1.1814],
         [-0.3665, -1.1814],
         [-0.3665, -1.1814],
         [-0.3665, -1.1814],
         [-0.3665, -1.1814],
         [-0.3665, -1.1814],
         [-0.3665, -1.1814]],
        [[-0.3981, -1.1135],
         [-0.3981, -1.1135],
         [-0.3981, -1.1135],
         [-0.3981, -1.1135],
         [-0.3981, -1.1135],
         [-0.3981, -1.1135],
         [-0.3981, -1.1135],
         [-0.3981, -1.1135],
         [-0.3981, -1.1135],
         [-0.3981, -1.1135]],
        [[-0.8864, -0.5312],
         [-0.8864, -0.5312],
         [-0.8864, -0.5312],
         [-0.8864, -0.5312],
         [-0.8864, -0.5312],
         [-0.8864, -0.5312],
         [-0.8864, -0.5312],
         [-0.8864, -0.5312],
         [-0.8864, -0.5312],
         [-0.8864, -0.5312]],
        [[-0.8929, -0.5267],
         [-0.8929, -0.5267],
         [-0.8929, -0.5267],
         [-0.8929, -0.5267],
         [-0.8929, -0.5267],
         [-0.8929, -0.5267],
         [-0.8929, -0.5267],
         [-0.8929, -0.5267],
         [-0.8929, -0.5267],
         [-0.8929, -0.5267]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4377, -1.0372],
         [-0.4377, -1.0372],
         [-0.4377, -1.0372],
         [-0.4377, -1.0372],
         [-0.4377, -1.0372],
         [-0.4377, -1.0372],
         [-0.4377, -1.0372],
         [-0.4377, -1.0372],
         [-0.4377, -1.0372],
         [-0.4377, -1.0372]],
        [[-0.2068, -1.6774],
         [-0.2068, -1.6774],
         [-0.2068, -1.6774],
         [-0.2068, -1.6774],
         [-0.2068, -1.6774],
         [-0.2068, -1.6774],
         [-0.2068, -1.6774],
         [-0.2068, -1.6774],
         [-0.2068, -1.6774],
         [-0.2068, -1.6774]],
        [[-1.2240, -0.3482],
         [-1.2240, -0.3482],
         [-1.2240, -0.3482],
         [-1.2240, -0.3482],
         [-1.2240, -0.3482],
         [-1.2240, -0.3482],
         [-1.2240, -0.3482],
         [-1.2240, -0.3482],
         [-1.2240, -0.3482],
         [-1.2240, -0.3482]],
        [[-0.4891, -0.9497],
         [-0.4891, -0.9497],
         [-0.4891, -0.9497],
         [-0.4891, -0.9497],
         [-0.4891, -0.9497],
         [-0.4891, -0.9497],
         [-0.4891, -0.9497],
         [-0.4891, -0.9497],
         [-0.4891, -0.9497],
         [-0.4891, -0.9497]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.1092, -0.4002],
         [-1.1092, -0.4002],
         [-1.1092, -0.4002],
         [-1.1092, -0.4002],
         [-1.1092, -0.4002],
         [-1.1092, -0.4002],
         [-1.1092, -0.4002],
         [-1.1092, -0.4002],
         [-1.1092, -0.4002],
         [-1.1092, -0.4002]],
        [[-0.9282, -0.5030],
         [-0.9282, -0.5030],
         [-0.9282, -0.5030],
         [-0.9282, -0.5030],
         [-0.9282, -0.5030],
         [-0.9282, -0.5030],
         [-0.9282, -0.5030],
         [-0.9282, -0.5030],
         [-0.9282, -0.5030],
         [-0.9282, -0.5030]],
        [[-1.5284, -0.2445],
         [-1.5284, -0.2445],
         [-1.5284, -0.2445],
         [-1.5284, -0.2445],
         [-1.5284, -0.2445],
         [-1.5284, -0.2445],
         [-1.5284, -0.2445],
         [-1.5284, -0.2445],
         [-1.5284, -0.2445],
         [-1.5284, -0.2445]],
        [[-0.9074, -0.5168],
         [-0.9074, -0.5168],
         [-0.9074, -0.5168],
         [-0.9074, -0.5168],
         [-0.9074, -0.5168],
         [-0.9074, -0.5168],
         [-0.9074, -0.5168],
         [-0.9074, -0.5168],
         [-0.9074, -0.5168],
         [-0.9074, -0.5168]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5104, -0.9169],
         [-0.5104, -0.9169],
         [-0.5104, -0.9169],
         [-0.5104, -0.9169],
         [-0.5104, -0.9169],
         [-0.5104, -0.9169],
         [-0.5104, -0.9169],
         [-0.5104, -0.9169],
         [-0.5104, -0.9169],
         [-0.5104, -0.9169]],
        [[-1.1383, -0.3862],
         [-1.1383, -0.3862],
         [-1.1383, -0.3862],
         [-1.1383, -0.3862],
         [-1.1383, -0.3862],
         [-1.1383, -0.3862],
         [-1.1383, -0.3862],
         [-1.1383, -0.3862],
         [-1.1383, -0.3862],
         [-1.1383, -0.3862]],
        [[-0.6306, -0.7599],
         [-0.6306, -0.7599],
         [-0.6306, -0.7599],
         [-0.6306, -0.7599],
         [-0.6306, -0.7599],
         [-0.6306, -0.7599],
         [-0.6306, -0.7599],
         [-0.6306, -0.7599],
         [-0.6306, -0.7599],
         [-0.6306, -0.7599]],
        [[-0.7310, -0.6566],
         [-0.7310, -0.6566],
         [-0.7310, -0.6566],
         [-0.7310, -0.6566],
         [-0.7310, -0.6566],
         [-0.7310, -0.6566],
         [-0.7310, -0.6566],
         [-0.7310, -0.6566],
         [-0.7310, -0.6566],
         [-0.7310, -0.6566]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4835, -0.9587],
         [-0.4835, -0.9587],
         [-0.4835, -0.9587],
         [-0.4835, -0.9587],
         [-0.4835, -0.9587],
         [-0.4835, -0.9587],
         [-0.4835, -0.9587],
         [-0.4835, -0.9587],
         [-0.4835, -0.9587],
         [-0.4835, -0.9587]],
        [[-1.3196, -0.3110],
         [-1.3196, -0.3110],
         [-1.3196, -0.3110],
         [-1.3196, -0.3110],
         [-1.3196, -0.3110],
         [-1.3196, -0.3110],
         [-1.3196, -0.3110],
         [-1.3196, -0.3110],
         [-1.3196, -0.3110],
         [-1.3196, -0.3110]],
        [[-0.6095, -0.7844],
         [-0.6095, -0.7844],
         [-0.6095, -0.7844],
         [-0.6095, -0.7844],
         [-0.6095, -0.7844],
         [-0.6095, -0.7844],
         [-0.6095, -0.7844],
         [-0.6095, -0.7844],
         [-0.6095, -0.7844],
         [-0.6095, -0.7844]],
        [[-0.5570, -0.8508],
         [-0.5570, -0.8508],
         [-0.5570, -0.8508],
         [-0.5570, -0.8508],
         [-0.5570, -0.8508],
         [-0.5570, -0.8508],
         [-0.5570, -0.8508],
         [-0.5570, -0.8508],
         [-0.5570, -0.8508],
         [-0.5570, -0.8508]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.4380, -0.2710],
         [-1.4380, -0.2710],
         [-1.4380, -0.2710],
         [-1.4380, -0.2710],
         [-1.4380, -0.2710],
         [-1.4380, -0.2710],
         [-1.4380, -0.2710],
         [-1.4380, -0.2710],
         [-1.4380, -0.2710],
         [-1.4380, -0.2710]],
        [[-0.8415, -0.5640],
         [-0.8415, -0.5640],
         [-0.8415, -0.5640],
         [-0.8415, -0.5640],
         [-0.8415, -0.5640],
         [-0.8415, -0.5640],
         [-0.8415, -0.5640],
         [-0.8415, -0.5640],
         [-0.8415, -0.5640],
         [-0.8415, -0.5640]],
        [[-0.3398, -1.2445],
         [-0.3398, -1.2445],
         [-0.3398, -1.2445],
         [-0.3398, -1.2445],
         [-0.3398, -1.2445],
         [-0.3398, -1.2445],
         [-0.3398, -1.2445],
         [-0.3398, -1.2445],
         [-0.3398, -1.2445],
         [-0.3398, -1.2445]],
        [[-1.0480, -0.4318],
         [-1.0480, -0.4318],
         [-1.0480, -0.4318],
         [-1.0480, -0.4318],
         [-1.0480, -0.4318],
         [-1.0480, -0.4318],
         [-1.0480, -0.4318],
         [-1.0480, -0.4318],
         [-1.0480, -0.4318],
         [-1.0480, -0.4318]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6630, -0.7242],
         [-0.6630, -0.7242],
         [-0.6630, -0.7242],
         [-0.6630, -0.7242],
         [-0.6630, -0.7242],
         [-0.6630, -0.7242],
         [-0.6630, -0.7242],
         [-0.6630, -0.7242],
         [-0.6630, -0.7242],
         [-0.6630, -0.7242]],
        [[-0.3270, -1.2769],
         [-0.3270, -1.2769],
         [-0.3270, -1.2769],
         [-0.3270, -1.2769],
         [-0.3270, -1.2769],
         [-0.3270, -1.2769],
         [-0.3270, -1.2769],
         [-0.3270, -1.2769],
         [-0.3270, -1.2769],
         [-0.3270, -1.2769]],
        [[-0.2394, -1.5468],
         [-0.2394, -1.5468],
         [-0.2394, -1.5468],
         [-0.2394, -1.5468],
         [-0.2394, -1.5468],
         [-0.2394, -1.5468],
         [-0.2394, -1.5468],
         [-0.2394, -1.5468],
         [-0.2394, -1.5468],
         [-0.2394, -1.5468]],
        [[-0.2197, -1.6234],
         [-0.2197, -1.6234],
         [-0.2197, -1.6234],
         [-0.2197, -1.6234],
         [-0.2197, -1.6234],
         [-0.2197, -1.6234],
         [-0.2197, -1.6234],
         [-0.2197, -1.6234],
         [-0.2197, -1.6234],
         [-0.2197, -1.6234]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.2845, -0.3240],
         [-1.2845, -0.3240],
         [-1.2845, -0.3240],
         [-1.2845, -0.3240],
         [-1.2845, -0.3240],
         [-1.2845, -0.3240],
         [-1.2845, -0.3240],
         [-1.2845, -0.3240],
         [-1.2845, -0.3240],
         [-1.2845, -0.3240]],
        [[-0.2636, -1.4621],
         [-0.2636, -1.4621],
         [-0.2636, -1.4621],
         [-0.2636, -1.4621],
         [-0.2636, -1.4621],
         [-0.2636, -1.4621],
         [-0.2636, -1.4621],
         [-0.2636, -1.4621],
         [-0.2636, -1.4621],
         [-0.2636, -1.4621]],
        [[-0.3429, -1.2368],
         [-0.3429, -1.2368],
         [-0.3429, -1.2368],
         [-0.3429, -1.2368],
         [-0.3429, -1.2368],
         [-0.3429, -1.2368],
         [-0.3429, -1.2368],
         [-0.3429, -1.2368],
         [-0.3429, -1.2368],
         [-0.3429, -1.2368]],
        [[-0.5923, -0.8053],
         [-0.5923, -0.8053],
         [-0.5923, -0.8053],
         [-0.5923, -0.8053],
         [-0.5923, -0.8053],
         [-0.5923, -0.8053],
         [-0.5923, -0.8053],
         [-0.5923, -0.8053],
         [-0.5923, -0.8053],
         [-0.5923, -0.8053]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.5974, -0.2262],
         [-1.5974, -0.2262],
         [-1.5974, -0.2262],
         [-1.5974, -0.2262],
         [-1.5974, -0.2262],
         [-1.5974, -0.2262],
         [-1.5974, -0.2262],
         [-1.5974, -0.2262],
         [-1.5974, -0.2262],
         [-1.5974, -0.2262]],
        [[-1.3079, -0.3153],
         [-1.3079, -0.3153],
         [-1.3079, -0.3153],
         [-1.3079, -0.3153],
         [-1.3079, -0.3153],
         [-1.3079, -0.3153],
         [-1.3079, -0.3153],
         [-1.3079, -0.3153],
         [-1.3079, -0.3153],
         [-1.3079, -0.3153]],
        [[-0.3627, -1.1902],
         [-0.3627, -1.1902],
         [-0.3627, -1.1902],
         [-0.3627, -1.1902],
         [-0.3627, -1.1902],
         [-0.3627, -1.1902],
         [-0.3627, -1.1902],
         [-0.3627, -1.1902],
         [-0.3627, -1.1902],
         [-0.3627, -1.1902]],
        [[-1.3947, -0.2849],
         [-1.3947, -0.2849],
         [-1.3947, -0.2849],
         [-1.3947, -0.2849],
         [-1.3947, -0.2849],
         [-1.3947, -0.2849],
         [-1.3947, -0.2849],
         [-1.3947, -0.2849],
         [-1.3947, -0.2849],
         [-1.3947, -0.2849]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.0817, -0.4140],
         [-1.0817, -0.4140],
         [-1.0817, -0.4140],
         [-1.0817, -0.4140],
         [-1.0817, -0.4140],
         [-1.0817, -0.4140],
         [-1.0817, -0.4140],
         [-1.0817, -0.4140],
         [-1.0817, -0.4140],
         [-1.0817, -0.4140]],
        [[-1.8128, -0.1782],
         [-1.8128, -0.1782],
         [-1.8128, -0.1782],
         [-1.8128, -0.1782],
         [-1.8128, -0.1782],
         [-1.8128, -0.1782],
         [-1.8128, -0.1782],
         [-1.8128, -0.1782],
         [-1.8128, -0.1782],
         [-1.8128, -0.1782]],
        [[-1.4802, -0.2582],
         [-1.4802, -0.2582],
         [-1.4802, -0.2582],
         [-1.4802, -0.2582],
         [-1.4802, -0.2582],
         [-1.4802, -0.2582],
         [-1.4802, -0.2582],
         [-1.4802, -0.2582],
         [-1.4802, -0.2582],
         [-1.4802, -0.2582]],
        [[-1.6987, -0.2020],
         [-1.6987, -0.2020],
         [-1.6987, -0.2020],
         [-1.6987, -0.2020],
         [-1.6987, -0.2020],
         [-1.6987, -0.2020],
         [-1.6987, -0.2020],
         [-1.6987, -0.2020],
         [-1.6987, -0.2020],
         [-1.6987, -0.2020]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5358, -0.8800],
         [-0.5358, -0.8800],
         [-0.5358, -0.8800],
         [-0.5358, -0.8800],
         [-0.5358, -0.8800],
         [-0.5358, -0.8800],
         [-0.5358, -0.8800],
         [-0.5358, -0.8800],
         [-0.5358, -0.8800],
         [-0.5358, -0.8800]],
        [[-1.1150, -0.3974],
         [-1.1150, -0.3974],
         [-1.1150, -0.3974],
         [-1.1150, -0.3974],
         [-1.1150, -0.3974],
         [-1.1150, -0.3974],
         [-1.1150, -0.3974],
         [-1.1150, -0.3974],
         [-1.1150, -0.3974],
         [-1.1150, -0.3974]],
        [[-0.5163, -0.9081],
         [-0.5163, -0.9081],
         [-0.5163, -0.9081],
         [-0.5163, -0.9081],
         [-0.5163, -0.9081],
         [-0.5163, -0.9081],
         [-0.5163, -0.9081],
         [-0.5163, -0.9081],
         [-0.5163, -0.9081],
         [-0.5163, -0.9081]],
        [[-1.7160, -0.1982],
         [-1.7160, -0.1982],
         [-1.7160, -0.1982],
         [-1.7160, -0.1982],
         [-1.7160, -0.1982],
         [-1.7160, -0.1982],
         [-1.7160, -0.1982],
         [-1.7160, -0.1982],
         [-1.7160, -0.1982],
         [-1.7160, -0.1982]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.3796, -1.1523],
         [-0.3796, -1.1523],
         [-0.3796, -1.1523],
         [-0.3796, -1.1523],
         [-0.3796, -1.1523],
         [-0.3796, -1.1523],
         [-0.3796, -1.1523],
         [-0.3796, -1.1523],
         [-0.3796, -1.1523],
         [-0.3796, -1.1523]],
        [[-1.4747, -0.2599],
         [-1.4747, -0.2599],
         [-1.4747, -0.2599],
         [-1.4747, -0.2599],
         [-1.4747, -0.2599],
         [-1.4747, -0.2599],
         [-1.4747, -0.2599],
         [-1.4747, -0.2599],
         [-1.4747, -0.2599],
         [-1.4747, -0.2599]],
        [[-1.4773, -0.2591],
         [-1.4773, -0.2591],
         [-1.4773, -0.2591],
         [-1.4773, -0.2591],
         [-1.4773, -0.2591],
         [-1.4773, -0.2591],
         [-1.4773, -0.2591],
         [-1.4773, -0.2591],
         [-1.4773, -0.2591],
         [-1.4773, -0.2591]],
        [[-0.6700, -0.7168],
         [-0.6700, -0.7168],
         [-0.6700, -0.7168],
         [-0.6700, -0.7168],
         [-0.6700, -0.7168],
         [-0.6700, -0.7168],
         [-0.6700, -0.7168],
         [-0.6700, -0.7168],
         [-0.6700, -0.7168],
         [-0.6700, -0.7168]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4884, -0.9508],
         [-0.4884, -0.9508],
         [-0.4884, -0.9508],
         [-0.4884, -0.9508],
         [-0.4884, -0.9508],
         [-0.4884, -0.9508],
         [-0.4884, -0.9508],
         [-0.4884, -0.9508],
         [-0.4884, -0.9508],
         [-0.4884, -0.9508]],
        [[-0.7091, -0.6774],
         [-0.7091, -0.6774],
         [-0.7091, -0.6774],
         [-0.7091, -0.6774],
         [-0.7091, -0.6774],
         [-0.7091, -0.6774],
         [-0.7091, -0.6774],
         [-0.7091, -0.6774],
         [-0.7091, -0.6774],
         [-0.7091, -0.6774]],
        [[-0.3158, -1.3064],
         [-0.3158, -1.3064],
         [-0.3158, -1.3064],
         [-0.3158, -1.3064],
         [-0.3158, -1.3064],
         [-0.3158, -1.3064],
         [-0.3158, -1.3064],
         [-0.3158, -1.3064],
         [-0.3158, -1.3064],
         [-0.3158, -1.3064]],
        [[-0.6422, -0.7468],
         [-0.6422, -0.7468],
         [-0.6422, -0.7468],
         [-0.6422, -0.7468],
         [-0.6422, -0.7468],
         [-0.6422, -0.7468],
         [-0.6422, -0.7468],
         [-0.6422, -0.7468],
         [-0.6422, -0.7468],
         [-0.6422, -0.7468]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5336, -0.8831],
         [-0.5336, -0.8831],
         [-0.5336, -0.8831],
         [-0.5336, -0.8831],
         [-0.5336, -0.8831],
         [-0.5336, -0.8831],
         [-0.5336, -0.8831],
         [-0.5336, -0.8831],
         [-0.5336, -0.8831],
         [-0.5336, -0.8831]],
        [[-1.0803, -0.4148],
         [-1.0803, -0.4148],
         [-1.0803, -0.4148],
         [-1.0803, -0.4148],
         [-1.0803, -0.4148],
         [-1.0803, -0.4148],
         [-1.0803, -0.4148],
         [-1.0803, -0.4148],
         [-1.0803, -0.4148],
         [-1.0803, -0.4148]],
        [[-0.9011, -0.5211],
         [-0.9011, -0.5211],
         [-0.9011, -0.5211],
         [-0.9011, -0.5211],
         [-0.9011, -0.5211],
         [-0.9011, -0.5211],
         [-0.9011, -0.5211],
         [-0.9011, -0.5211],
         [-0.9011, -0.5211],
         [-0.9011, -0.5211]],
        [[-1.5108, -0.2494],
         [-1.5108, -0.2494],
         [-1.5108, -0.2494],
         [-1.5108, -0.2494],
         [-1.5108, -0.2494],
         [-1.5108, -0.2494],
         [-1.5108, -0.2494],
         [-1.5108, -0.2494],
         [-1.5108, -0.2494],
         [-1.5108, -0.2494]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4901, -0.9481],
         [-0.4901, -0.9481],
         [-0.4901, -0.9481],
         [-0.4901, -0.9481],
         [-0.4901, -0.9481],
         [-0.4901, -0.9481],
         [-0.4901, -0.9481],
         [-0.4901, -0.9481],
         [-0.4901, -0.9481],
         [-0.4901, -0.9481]],
        [[-0.5953, -0.8017],
         [-0.5953, -0.8017],
         [-0.5953, -0.8017],
         [-0.5953, -0.8017],
         [-0.5953, -0.8017],
         [-0.5953, -0.8017],
         [-0.5953, -0.8017],
         [-0.5953, -0.8017],
         [-0.5953, -0.8017],
         [-0.5953, -0.8017]],
        [[-0.5734, -0.8291],
         [-0.5734, -0.8291],
         [-0.5734, -0.8291],
         [-0.5734, -0.8291],
         [-0.5734, -0.8291],
         [-0.5734, -0.8291],
         [-0.5734, -0.8291],
         [-0.5734, -0.8291],
         [-0.5734, -0.8291],
         [-0.5734, -0.8291]],
        [[-0.5032, -0.9279],
         [-0.5032, -0.9279],
         [-0.5032, -0.9279],
         [-0.5032, -0.9279],
         [-0.5032, -0.9279],
         [-0.5032, -0.9279],
         [-0.5032, -0.9279],
         [-0.5032, -0.9279],
         [-0.5032, -0.9279],
         [-0.5032, -0.9279]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7459, -0.6430],
         [-0.7459, -0.6430],
         [-0.7459, -0.6430],
         [-0.7459, -0.6430],
         [-0.7459, -0.6430],
         [-0.7459, -0.6430],
         [-0.7459, -0.6430],
         [-0.7459, -0.6430],
         [-0.7459, -0.6430],
         [-0.7459, -0.6430]],
        [[-0.8558, -0.5533],
         [-0.8558, -0.5533],
         [-0.8558, -0.5533],
         [-0.8558, -0.5533],
         [-0.8558, -0.5533],
         [-0.8558, -0.5533],
         [-0.8558, -0.5533],
         [-0.8558, -0.5533],
         [-0.8558, -0.5533],
         [-0.8558, -0.5533]],
        [[-0.3264, -1.2783],
         [-0.3264, -1.2783],
         [-0.3264, -1.2783],
         [-0.3264, -1.2783],
         [-0.3264, -1.2783],
         [-0.3264, -1.2783],
         [-0.3264, -1.2783],
         [-0.3264, -1.2783],
         [-0.3264, -1.2783],
         [-0.3264, -1.2783]],
        [[-1.1324, -0.3890],
         [-1.1324, -0.3890],
         [-1.1324, -0.3890],
         [-1.1324, -0.3890],
         [-1.1324, -0.3890],
         [-1.1324, -0.3890],
         [-1.1324, -0.3890],
         [-1.1324, -0.3890],
         [-1.1324, -0.3890],
         [-1.1324, -0.3890]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6951, -0.6912],
         [-0.6951, -0.6912],
         [-0.6951, -0.6912],
         [-0.6951, -0.6912],
         [-0.6951, -0.6912],
         [-0.6951, -0.6912],
         [-0.6951, -0.6912],
         [-0.6951, -0.6912],
         [-0.6951, -0.6912],
         [-0.6951, -0.6912]],
        [[-1.0392, -0.4365],
         [-1.0392, -0.4365],
         [-1.0392, -0.4365],
         [-1.0392, -0.4365],
         [-1.0392, -0.4365],
         [-1.0392, -0.4365],
         [-1.0392, -0.4365],
         [-1.0392, -0.4365],
         [-1.0392, -0.4365],
         [-1.0392, -0.4365]],
        [[-0.4815, -0.9619],
         [-0.4815, -0.9619],
         [-0.4815, -0.9619],
         [-0.4815, -0.9619],
         [-0.4815, -0.9619],
         [-0.4815, -0.9619],
         [-0.4815, -0.9619],
         [-0.4815, -0.9619],
         [-0.4815, -0.9619],
         [-0.4815, -0.9619]],
        [[-0.7157, -0.6711],
         [-0.7157, -0.6711],
         [-0.7157, -0.6711],
         [-0.7157, -0.6711],
         [-0.7157, -0.6711],
         [-0.7157, -0.6711],
         [-0.7157, -0.6711],
         [-0.7157, -0.6711],
         [-0.7157, -0.6711],
         [-0.7157, -0.6711]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.2998, -0.3183],
         [-1.2998, -0.3183],
         [-1.2998, -0.3183],
         [-1.2998, -0.3183],
         [-1.2998, -0.3183],
         [-1.2998, -0.3183],
         [-1.2998, -0.3183],
         [-1.2998, -0.3183],
         [-1.2998, -0.3183],
         [-1.2998, -0.3183]],
        [[-0.4634, -0.9919],
         [-0.4634, -0.9919],
         [-0.4634, -0.9919],
         [-0.4634, -0.9919],
         [-0.4634, -0.9919],
         [-0.4634, -0.9919],
         [-0.4634, -0.9919],
         [-0.4634, -0.9919],
         [-0.4634, -0.9919],
         [-0.4634, -0.9919]],
        [[-0.3409, -1.2417],
         [-0.3409, -1.2417],
         [-0.3409, -1.2417],
         [-0.3409, -1.2417],
         [-0.3409, -1.2417],
         [-0.3409, -1.2417],
         [-0.3409, -1.2417],
         [-0.3409, -1.2417],
         [-0.3409, -1.2417],
         [-0.3409, -1.2417]],
        [[-0.8172, -0.5828],
         [-0.8172, -0.5828],
         [-0.8172, -0.5828],
         [-0.8172, -0.5828],
         [-0.8172, -0.5828],
         [-0.8172, -0.5828],
         [-0.8172, -0.5828],
         [-0.8172, -0.5828],
         [-0.8172, -0.5828],
         [-0.8172, -0.5828]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.1378, -0.3864],
         [-1.1378, -0.3864],
         [-1.1378, -0.3864],
         [-1.1378, -0.3864],
         [-1.1378, -0.3864],
         [-1.1378, -0.3864],
         [-1.1378, -0.3864],
         [-1.1378, -0.3864],
         [-1.1378, -0.3864],
         [-1.1378, -0.3864]],
        [[-1.4802, -0.2582],
         [-1.4802, -0.2582],
         [-1.4802, -0.2582],
         [-1.4802, -0.2582],
         [-1.4802, -0.2582],
         [-1.4802, -0.2582],
         [-1.4802, -0.2582],
         [-1.4802, -0.2582],
         [-1.4802, -0.2582],
         [-1.4802, -0.2582]],
        [[-0.2408, -1.5418],
         [-0.2408, -1.5418],
         [-0.2408, -1.5418],
         [-0.2408, -1.5418],
         [-0.2408, -1.5418],
         [-0.2408, -1.5418],
         [-0.2408, -1.5418],
         [-0.2408, -1.5418],
         [-0.2408, -1.5418],
         [-0.2408, -1.5418]],
        [[-0.8125, -0.5865],
         [-0.8125, -0.5865],
         [-0.8125, -0.5865],
         [-0.8125, -0.5865],
         [-0.8125, -0.5865],
         [-0.8125, -0.5865],
         [-0.8125, -0.5865],
         [-0.8125, -0.5865],
         [-0.8125, -0.5865],
         [-0.8125, -0.5865]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.3190, -1.2977],
         [-0.3190, -1.2977],
         [-0.3190, -1.2977],
         [-0.3190, -1.2977],
         [-0.3190, -1.2977],
         [-0.3190, -1.2977],
         [-0.3190, -1.2977],
         [-0.3190, -1.2977],
         [-0.3190, -1.2977],
         [-0.3190, -1.2977]],
        [[-0.2175, -1.6325],
         [-0.2175, -1.6325],
         [-0.2175, -1.6325],
         [-0.2175, -1.6325],
         [-0.2175, -1.6325],
         [-0.2175, -1.6325],
         [-0.2175, -1.6325],
         [-0.2175, -1.6325],
         [-0.2175, -1.6325],
         [-0.2175, -1.6325]],
        [[-0.2590, -1.4777],
         [-0.2590, -1.4777],
         [-0.2590, -1.4777],
         [-0.2590, -1.4777],
         [-0.2590, -1.4777],
         [-0.2590, -1.4777],
         [-0.2590, -1.4777],
         [-0.2590, -1.4777],
         [-0.2590, -1.4777],
         [-0.2590, -1.4777]],
        [[-1.2000, -0.3584],
         [-1.2000, -0.3584],
         [-1.2000, -0.3584],
         [-1.2000, -0.3584],
         [-1.2000, -0.3584],
         [-1.2000, -0.3584],
         [-1.2000, -0.3584],
         [-1.2000, -0.3584],
         [-1.2000, -0.3584],
         [-1.2000, -0.3584]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.3007, -1.3482],
         [-0.3007, -1.3482],
         [-0.3007, -1.3482],
         [-0.3007, -1.3482],
         [-0.3007, -1.3482],
         [-0.3007, -1.3482],
         [-0.3007, -1.3482],
         [-0.3007, -1.3482],
         [-0.3007, -1.3482],
         [-0.3007, -1.3482]],
        [[-0.4331, -1.0456],
         [-0.4331, -1.0456],
         [-0.4331, -1.0456],
         [-0.4331, -1.0456],
         [-0.4331, -1.0456],
         [-0.4331, -1.0456],
         [-0.4331, -1.0456],
         [-0.4331, -1.0456],
         [-0.4331, -1.0456],
         [-0.4331, -1.0456]],
        [[-0.3617, -1.1924],
         [-0.3617, -1.1924],
         [-0.3617, -1.1924],
         [-0.3617, -1.1924],
         [-0.3617, -1.1924],
         [-0.3617, -1.1924],
         [-0.3617, -1.1924],
         [-0.3617, -1.1924],
         [-0.3617, -1.1924],
         [-0.3617, -1.1924]],
        [[-0.3800, -1.1517],
         [-0.3800, -1.1517],
         [-0.3800, -1.1517],
         [-0.3800, -1.1517],
         [-0.3800, -1.1517],
         [-0.3800, -1.1517],
         [-0.3800, -1.1517],
         [-0.3800, -1.1517],
         [-0.3800, -1.1517],
         [-0.3800, -1.1517]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4185, -1.0731],
         [-0.4185, -1.0731],
         [-0.4185, -1.0731],
         [-0.4185, -1.0731],
         [-0.4185, -1.0731],
         [-0.4185, -1.0731],
         [-0.4185, -1.0731],
         [-0.4185, -1.0731],
         [-0.4185, -1.0731],
         [-0.4185, -1.0731]],
        [[-0.5984, -0.7978],
         [-0.5984, -0.7978],
         [-0.5984, -0.7978],
         [-0.5984, -0.7978],
         [-0.5984, -0.7978],
         [-0.5984, -0.7978],
         [-0.5984, -0.7978],
         [-0.5984, -0.7978],
         [-0.5984, -0.7978],
         [-0.5984, -0.7978]],
        [[-0.9186, -0.5093],
         [-0.9186, -0.5093],
         [-0.9186, -0.5093],
         [-0.9186, -0.5093],
         [-0.9186, -0.5093],
         [-0.9186, -0.5093],
         [-0.9186, -0.5093],
         [-0.9186, -0.5093],
         [-0.9186, -0.5093],
         [-0.9186, -0.5093]],
        [[-0.5014, -0.9306],
         [-0.5014, -0.9306],
         [-0.5014, -0.9306],
         [-0.5014, -0.9306],
         [-0.5014, -0.9306],
         [-0.5014, -0.9306],
         [-0.5014, -0.9306],
         [-0.5014, -0.9306],
         [-0.5014, -0.9306],
         [-0.5014, -0.9306]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.4224, -0.2759],
         [-1.4224, -0.2759],
         [-1.4224, -0.2759],
         [-1.4224, -0.2759],
         [-1.4224, -0.2759],
         [-1.4224, -0.2759],
         [-1.4224, -0.2759],
         [-1.4224, -0.2759],
         [-1.4224, -0.2759],
         [-1.4224, -0.2759]],
        [[-0.9023, -0.5203],
         [-0.9023, -0.5203],
         [-0.9023, -0.5203],
         [-0.9023, -0.5203],
         [-0.9023, -0.5203],
         [-0.9023, -0.5203],
         [-0.9023, -0.5203],
         [-0.9023, -0.5203],
         [-0.9023, -0.5203],
         [-0.9023, -0.5203]],
        [[-0.8573, -0.5522],
         [-0.8573, -0.5522],
         [-0.8573, -0.5522],
         [-0.8573, -0.5522],
         [-0.8573, -0.5522],
         [-0.8573, -0.5522],
         [-0.8573, -0.5522],
         [-0.8573, -0.5522],
         [-0.8573, -0.5522],
         [-0.8573, -0.5522]],
        [[-1.0793, -0.4153],
         [-1.0793, -0.4153],
         [-1.0793, -0.4153],
         [-1.0793, -0.4153],
         [-1.0793, -0.4153],
         [-1.0793, -0.4153],
         [-1.0793, -0.4153],
         [-1.0793, -0.4153],
         [-1.0793, -0.4153],
         [-1.0793, -0.4153]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.3914, -0.2860],
         [-1.3914, -0.2860],
         [-1.3914, -0.2860],
         [-1.3914, -0.2860],
         [-1.3914, -0.2860],
         [-1.3914, -0.2860],
         [-1.3914, -0.2860],
         [-1.3914, -0.2860],
         [-1.3914, -0.2860],
         [-1.3914, -0.2860]],
        [[-1.2221, -0.3490],
         [-1.2221, -0.3490],
         [-1.2221, -0.3490],
         [-1.2221, -0.3490],
         [-1.2221, -0.3490],
         [-1.2221, -0.3490],
         [-1.2221, -0.3490],
         [-1.2221, -0.3490],
         [-1.2221, -0.3490],
         [-1.2221, -0.3490]],
        [[-0.4018, -1.1059],
         [-0.4018, -1.1059],
         [-0.4018, -1.1059],
         [-0.4018, -1.1059],
         [-0.4018, -1.1059],
         [-0.4018, -1.1059],
         [-0.4018, -1.1059],
         [-0.4018, -1.1059],
         [-0.4018, -1.1059],
         [-0.4018, -1.1059]],
        [[-1.0704, -0.4199],
         [-1.0704, -0.4199],
         [-1.0704, -0.4199],
         [-1.0704, -0.4199],
         [-1.0704, -0.4199],
         [-1.0704, -0.4199],
         [-1.0704, -0.4199],
         [-1.0704, -0.4199],
         [-1.0704, -0.4199],
         [-1.0704, -0.4199]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6524, -0.7356],
         [-0.6524, -0.7356],
         [-0.6524, -0.7356],
         [-0.6524, -0.7356],
         [-0.6524, -0.7356],
         [-0.6524, -0.7356],
         [-0.6524, -0.7356],
         [-0.6524, -0.7356],
         [-0.6524, -0.7356],
         [-0.6524, -0.7356]],
        [[-0.6549, -0.7329],
         [-0.6549, -0.7329],
         [-0.6549, -0.7329],
         [-0.6549, -0.7329],
         [-0.6549, -0.7329],
         [-0.6549, -0.7329],
         [-0.6549, -0.7329],
         [-0.6549, -0.7329],
         [-0.6549, -0.7329],
         [-0.6549, -0.7329]],
        [[-0.7152, -0.6716],
         [-0.7152, -0.6716],
         [-0.7152, -0.6716],
         [-0.7152, -0.6716],
         [-0.7152, -0.6716],
         [-0.7152, -0.6716],
         [-0.7152, -0.6716],
         [-0.7152, -0.6716],
         [-0.7152, -0.6716],
         [-0.7152, -0.6716]],
        [[-1.3997, -0.2833],
         [-1.3997, -0.2833],
         [-1.3997, -0.2833],
         [-1.3997, -0.2833],
         [-1.3997, -0.2833],
         [-1.3997, -0.2833],
         [-1.3997, -0.2833],
         [-1.3997, -0.2833],
         [-1.3997, -0.2833],
         [-1.3997, -0.2833]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7432, -0.6455],
         [-0.7432, -0.6455],
         [-0.7432, -0.6455],
         [-0.7432, -0.6455],
         [-0.7432, -0.6455],
         [-0.7432, -0.6455],
         [-0.7432, -0.6455],
         [-0.7432, -0.6455],
         [-0.7432, -0.6455],
         [-0.7432, -0.6455]],
        [[-1.1826, -0.3660],
         [-1.1826, -0.3660],
         [-1.1826, -0.3660],
         [-1.1826, -0.3660],
         [-1.1826, -0.3660],
         [-1.1826, -0.3660],
         [-1.1826, -0.3660],
         [-1.1826, -0.3660],
         [-1.1826, -0.3660],
         [-1.1826, -0.3660]],
        [[-1.0633, -0.4236],
         [-1.0633, -0.4236],
         [-1.0633, -0.4236],
         [-1.0633, -0.4236],
         [-1.0633, -0.4236],
         [-1.0633, -0.4236],
         [-1.0633, -0.4236],
         [-1.0633, -0.4236],
         [-1.0633, -0.4236],
         [-1.0633, -0.4236]],
        [[-1.2194, -0.3501],
         [-1.2194, -0.3501],
         [-1.2194, -0.3501],
         [-1.2194, -0.3501],
         [-1.2194, -0.3501],
         [-1.2194, -0.3501],
         [-1.2194, -0.3501],
         [-1.2194, -0.3501],
         [-1.2194, -0.3501],
         [-1.2194, -0.3501]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6671, -0.7199],
         [-0.6671, -0.7199],
         [-0.6671, -0.7199],
         [-0.6671, -0.7199],
         [-0.6671, -0.7199],
         [-0.6671, -0.7199],
         [-0.6671, -0.7199],
         [-0.6671, -0.7199],
         [-0.6671, -0.7199],
         [-0.6671, -0.7199]],
        [[-0.2276, -1.5917],
         [-0.2276, -1.5917],
         [-0.2276, -1.5917],
         [-0.2276, -1.5917],
         [-0.2276, -1.5917],
         [-0.2276, -1.5917],
         [-0.2276, -1.5917],
         [-0.2276, -1.5917],
         [-0.2276, -1.5917],
         [-0.2276, -1.5917]],
        [[-1.1434, -0.3838],
         [-1.1434, -0.3838],
         [-1.1434, -0.3838],
         [-1.1434, -0.3838],
         [-1.1434, -0.3838],
         [-1.1434, -0.3838],
         [-1.1434, -0.3838],
         [-1.1434, -0.3838],
         [-1.1434, -0.3838],
         [-1.1434, -0.3838]],
        [[-1.4575, -0.2650],
         [-1.4575, -0.2650],
         [-1.4575, -0.2650],
         [-1.4575, -0.2650],
         [-1.4575, -0.2650],
         [-1.4575, -0.2650],
         [-1.4575, -0.2650],
         [-1.4575, -0.2650],
         [-1.4575, -0.2650],
         [-1.4575, -0.2650]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.2954, -0.3199],
         [-1.2954, -0.3199],
         [-1.2954, -0.3199],
         [-1.2954, -0.3199],
         [-1.2954, -0.3199],
         [-1.2954, -0.3199],
         [-1.2954, -0.3199],
         [-1.2954, -0.3199],
         [-1.2954, -0.3199],
         [-1.2954, -0.3199]],
        [[-0.7237, -0.6635],
         [-0.7237, -0.6635],
         [-0.7237, -0.6635],
         [-0.7237, -0.6635],
         [-0.7237, -0.6635],
         [-0.7237, -0.6635],
         [-0.7237, -0.6635],
         [-0.7237, -0.6635],
         [-0.7237, -0.6635],
         [-0.7237, -0.6635]],
        [[-0.4489, -1.0171],
         [-0.4489, -1.0171],
         [-0.4489, -1.0171],
         [-0.4489, -1.0171],
         [-0.4489, -1.0171],
         [-0.4489, -1.0171],
         [-0.4489, -1.0171],
         [-0.4489, -1.0171],
         [-0.4489, -1.0171],
         [-0.4489, -1.0171]],
        [[-1.3472, -0.3011],
         [-1.3472, -0.3011],
         [-1.3472, -0.3011],
         [-1.3472, -0.3011],
         [-1.3472, -0.3011],
         [-1.3472, -0.3011],
         [-1.3472, -0.3011],
         [-1.3472, -0.3011],
         [-1.3472, -0.3011],
         [-1.3472, -0.3011]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.0698, -0.4202],
         [-1.0698, -0.4202],
         [-1.0698, -0.4202],
         [-1.0698, -0.4202],
         [-1.0698, -0.4202],
         [-1.0698, -0.4202],
         [-1.0698, -0.4202],
         [-1.0698, -0.4202],
         [-1.0698, -0.4202],
         [-1.0698, -0.4202]],
        [[-0.5687, -0.8353],
         [-0.5687, -0.8353],
         [-0.5687, -0.8353],
         [-0.5687, -0.8353],
         [-0.5687, -0.8353],
         [-0.5687, -0.8353],
         [-0.5687, -0.8353],
         [-0.5687, -0.8353],
         [-0.5687, -0.8353],
         [-0.5687, -0.8353]],
        [[-0.7466, -0.6424],
         [-0.7466, -0.6424],
         [-0.7466, -0.6424],
         [-0.7466, -0.6424],
         [-0.7466, -0.6424],
         [-0.7466, -0.6424],
         [-0.7466, -0.6424],
         [-0.7466, -0.6424],
         [-0.7466, -0.6424],
         [-0.7466, -0.6424]],
        [[-0.8863, -0.5314],
         [-0.8863, -0.5314],
         [-0.8863, -0.5314],
         [-0.8863, -0.5314],
         [-0.8863, -0.5314],
         [-0.8863, -0.5314],
         [-0.8863, -0.5314],
         [-0.8863, -0.5314],
         [-0.8863, -0.5314],
         [-0.8863, -0.5314]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5424, -0.8707],
         [-0.5424, -0.8707],
         [-0.5424, -0.8707],
         [-0.5424, -0.8707],
         [-0.5424, -0.8707],
         [-0.5424, -0.8707],
         [-0.5424, -0.8707],
         [-0.5424, -0.8707],
         [-0.5424, -0.8707],
         [-0.5424, -0.8707]],
        [[-0.9335, -0.4995],
         [-0.9335, -0.4995],
         [-0.9335, -0.4995],
         [-0.9335, -0.4995],
         [-0.9335, -0.4995],
         [-0.9335, -0.4995],
         [-0.9335, -0.4995],
         [-0.9335, -0.4995],
         [-0.9335, -0.4995],
         [-0.9335, -0.4995]],
        [[-0.3849, -1.1410],
         [-0.3849, -1.1410],
         [-0.3849, -1.1410],
         [-0.3849, -1.1410],
         [-0.3849, -1.1410],
         [-0.3849, -1.1410],
         [-0.3849, -1.1410],
         [-0.3849, -1.1410],
         [-0.3849, -1.1410],
         [-0.3849, -1.1410]],
        [[-1.3837, -0.2885],
         [-1.3837, -0.2885],
         [-1.3837, -0.2885],
         [-1.3837, -0.2885],
         [-1.3837, -0.2885],
         [-1.3837, -0.2885],
         [-1.3837, -0.2885],
         [-1.3837, -0.2885],
         [-1.3837, -0.2885],
         [-1.3837, -0.2885]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.0215, -0.4464],
         [-1.0215, -0.4464],
         [-1.0215, -0.4464],
         [-1.0215, -0.4464],
         [-1.0215, -0.4464],
         [-1.0215, -0.4464],
         [-1.0215, -0.4464],
         [-1.0215, -0.4464],
         [-1.0215, -0.4464],
         [-1.0215, -0.4464]],
        [[-0.4434, -1.0267],
         [-0.4434, -1.0267],
         [-0.4434, -1.0267],
         [-0.4434, -1.0267],
         [-0.4434, -1.0267],
         [-0.4434, -1.0267],
         [-0.4434, -1.0267],
         [-0.4434, -1.0267],
         [-0.4434, -1.0267],
         [-0.4434, -1.0267]],
        [[-0.7934, -0.6020],
         [-0.7934, -0.6020],
         [-0.7934, -0.6020],
         [-0.7934, -0.6020],
         [-0.7934, -0.6020],
         [-0.7934, -0.6020],
         [-0.7934, -0.6020],
         [-0.7934, -0.6020],
         [-0.7934, -0.6020],
         [-0.7934, -0.6020]],
        [[-0.4951, -0.9404],
         [-0.4951, -0.9404],
         [-0.4951, -0.9404],
         [-0.4951, -0.9404],
         [-0.4951, -0.9404],
         [-0.4951, -0.9404],
         [-0.4951, -0.9404],
         [-0.4951, -0.9404],
         [-0.4951, -0.9404],
         [-0.4951, -0.9404]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7492, -0.6400],
         [-0.7492, -0.6400],
         [-0.7492, -0.6400],
         [-0.7492, -0.6400],
         [-0.7492, -0.6400],
         [-0.7492, -0.6400],
         [-0.7492, -0.6400],
         [-0.7492, -0.6400],
         [-0.7492, -0.6400],
         [-0.7492, -0.6400]],
        [[-1.5657, -0.2344],
         [-1.5657, -0.2344],
         [-1.5657, -0.2344],
         [-1.5657, -0.2344],
         [-1.5657, -0.2344],
         [-1.5657, -0.2344],
         [-1.5657, -0.2344],
         [-1.5657, -0.2344],
         [-1.5657, -0.2344],
         [-1.5657, -0.2344]],
        [[-0.9190, -0.5090],
         [-0.9190, -0.5090],
         [-0.9190, -0.5090],
         [-0.9190, -0.5090],
         [-0.9190, -0.5090],
         [-0.9190, -0.5090],
         [-0.9190, -0.5090],
         [-0.9190, -0.5090],
         [-0.9190, -0.5090],
         [-0.9190, -0.5090]],
        [[-0.4214, -1.0676],
         [-0.4214, -1.0676],
         [-0.4214, -1.0676],
         [-0.4214, -1.0676],
         [-0.4214, -1.0676],
         [-0.4214, -1.0676],
         [-0.4214, -1.0676],
         [-0.4214, -1.0676],
         [-0.4214, -1.0676],
         [-0.4214, -1.0676]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.9134, -0.5127],
         [-0.9134, -0.5127],
         [-0.9134, -0.5127],
         [-0.9134, -0.5127],
         [-0.9134, -0.5127],
         [-0.9134, -0.5127],
         [-0.9134, -0.5127],
         [-0.9134, -0.5127],
         [-0.9134, -0.5127],
         [-0.9134, -0.5127]],
        [[-1.5206, -0.2466],
         [-1.5206, -0.2466],
         [-1.5206, -0.2466],
         [-1.5206, -0.2466],
         [-1.5206, -0.2466],
         [-1.5206, -0.2466],
         [-1.5206, -0.2466],
         [-1.5206, -0.2466],
         [-1.5206, -0.2466],
         [-1.5206, -0.2466]],
        [[-0.4207, -1.0687],
         [-0.4207, -1.0687],
         [-0.4207, -1.0687],
         [-0.4207, -1.0687],
         [-0.4207, -1.0687],
         [-0.4207, -1.0687],
         [-0.4207, -1.0687],
         [-0.4207, -1.0687],
         [-0.4207, -1.0687],
         [-0.4207, -1.0687]],
        [[-1.1216, -0.3941],
         [-1.1216, -0.3941],
         [-1.1216, -0.3941],
         [-1.1216, -0.3941],
         [-1.1216, -0.3941],
         [-1.1216, -0.3941],
         [-1.1216, -0.3941],
         [-1.1216, -0.3941],
         [-1.1216, -0.3941],
         [-1.1216, -0.3941]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Online Simulation:   4%|▍         | 372/9306 [00:13<05:33, 26.80it/s]
Traceback (most recent call last):
  File "C:/HumanChoicePredictionCloned/StrategyTransfer.py", line 112, in <module>
    env_model = environments.LSTM_env.LSTM_env(env_name, config=config)
  File "C:\HumanChoicePredictionCloned\environments\environment.py", line 38, in __init__
    self.train()
  File "C:\HumanChoicePredictionCloned\environments\environment.py", line 208, in train
    loss.backward()
  File "C:\ProgramData\anaconda3\envs\final_project_env\lib\site-packages\torch\_tensor.py", line 396, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "C:\ProgramData\anaconda3\envs\final_project_env\lib\site-packages\torch\autograd\__init__.py", line 173, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
                                     tensor([[[-1.0283, -0.4426],
         [-1.0283, -0.4426],
         [-1.0283, -0.4426],
         [-1.0283, -0.4426],
         [-1.0283, -0.4426],
         [-1.0283, -0.4426],
         [-1.0283, -0.4426],
         [-1.0283, -0.4426],
         [-1.0283, -0.4426],
         [-1.0283, -0.4426]],
        [[-0.6819, -0.7045],
         [-0.6819, -0.7045],
         [-0.6819, -0.7045],
         [-0.6819, -0.7045],
         [-0.6819, -0.7045],
         [-0.6819, -0.7045],
         [-0.6819, -0.7045],
         [-0.6819, -0.7045],
         [-0.6819, -0.7045],
         [-0.6819, -0.7045]],
        [[-1.0183, -0.4482],
         [-1.0183, -0.4482],
         [-1.0183, -0.4482],
         [-1.0183, -0.4482],
         [-1.0183, -0.4482],
         [-1.0183, -0.4482],
         [-1.0183, -0.4482],
         [-1.0183, -0.4482],
         [-1.0183, -0.4482],
         [-1.0183, -0.4482]],
        [[-0.4082, -1.0931],
         [-0.4082, -1.0931],
         [-0.4082, -1.0931],
         [-0.4082, -1.0931],
         [-0.4082, -1.0931],
         [-0.4082, -1.0931],
         [-0.4082, -1.0931],
         [-0.4082, -1.0931],
         [-0.4082, -1.0931],
         [-0.4082, -1.0931]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5041, -0.9265],
         [-0.5041, -0.9265],
         [-0.5041, -0.9265],
         [-0.5041, -0.9265],
         [-0.5041, -0.9265],
         [-0.5041, -0.9265],
         [-0.5041, -0.9265],
         [-0.5041, -0.9265],
         [-0.5041, -0.9265],
         [-0.5041, -0.9265]],
        [[-0.8067, -0.5912],
         [-0.8067, -0.5912],
         [-0.8067, -0.5912],
         [-0.8067, -0.5912],
         [-0.8067, -0.5912],
         [-0.8067, -0.5912],
         [-0.8067, -0.5912],
         [-0.8067, -0.5912],
         [-0.8067, -0.5912],
         [-0.8067, -0.5912]],
        [[-0.5896, -0.8087],
         [-0.5896, -0.8087],
         [-0.5896, -0.8087],
         [-0.5896, -0.8087],
         [-0.5896, -0.8087],
         [-0.5896, -0.8087],
         [-0.5896, -0.8087],
         [-0.5896, -0.8087],
         [-0.5896, -0.8087],
         [-0.5896, -0.8087]],
        [[-0.7762, -0.6165],
         [-0.7762, -0.6165],
         [-0.7762, -0.6165],
         [-0.7762, -0.6165],
         [-0.7762, -0.6165],
         [-0.7762, -0.6165],
         [-0.7762, -0.6165],
         [-0.7762, -0.6165],
         [-0.7762, -0.6165],
         [-0.7762, -0.6165]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.9696, -0.4768],
         [-0.9696, -0.4768],
         [-0.9696, -0.4768],
         [-0.9696, -0.4768],
         [-0.9696, -0.4768],
         [-0.9696, -0.4768],
         [-0.9696, -0.4768],
         [-0.9696, -0.4768],
         [-0.9696, -0.4768],
         [-0.9696, -0.4768]],
        [[-0.3018, -1.3451],
         [-0.3018, -1.3451],
         [-0.3018, -1.3451],
         [-0.3018, -1.3451],
         [-0.3018, -1.3451],
         [-0.3018, -1.3451],
         [-0.3018, -1.3451],
         [-0.3018, -1.3451],
         [-0.3018, -1.3451],
         [-0.3018, -1.3451]],
        [[-0.6803, -0.7061],
         [-0.6803, -0.7061],
         [-0.6803, -0.7061],
         [-0.6803, -0.7061],
         [-0.6803, -0.7061],
         [-0.6803, -0.7061],
         [-0.6803, -0.7061],
         [-0.6803, -0.7061],
         [-0.6803, -0.7061],
         [-0.6803, -0.7061]],
        [[-0.9738, -0.4743],
         [-0.9738, -0.4743],
         [-0.9738, -0.4743],
         [-0.9738, -0.4743],
         [-0.9738, -0.4743],
         [-0.9738, -0.4743],
         [-0.9738, -0.4743],
         [-0.9738, -0.4743],
         [-0.9738, -0.4743],
         [-0.9738, -0.4743]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.3281, -0.3078],
         [-1.3281, -0.3078],
         [-1.3281, -0.3078],
         [-1.3281, -0.3078],
         [-1.3281, -0.3078],
         [-1.3281, -0.3078],
         [-1.3281, -0.3078],
         [-1.3281, -0.3078],
         [-1.3281, -0.3078],
         [-1.3281, -0.3078]],
        [[-0.4279, -1.0552],
         [-0.4279, -1.0552],
         [-0.4279, -1.0552],
         [-0.4279, -1.0552],
         [-0.4279, -1.0552],
         [-0.4279, -1.0552],
         [-0.4279, -1.0552],
         [-0.4279, -1.0552],
         [-0.4279, -1.0552],
         [-0.4279, -1.0552]],
        [[-0.5551, -0.8534],
         [-0.5551, -0.8534],
         [-0.5551, -0.8534],
         [-0.5551, -0.8534],
         [-0.5551, -0.8534],
         [-0.5551, -0.8534],
         [-0.5551, -0.8534],
         [-0.5551, -0.8534],
         [-0.5551, -0.8534],
         [-0.5551, -0.8534]],
        [[-0.3352, -1.2559],
         [-0.3352, -1.2559],
         [-0.3352, -1.2559],
         [-0.3352, -1.2559],
         [-0.3352, -1.2559],
         [-0.3352, -1.2559],
         [-0.3352, -1.2559],
         [-0.3352, -1.2559],
         [-0.3352, -1.2559],
         [-0.3352, -1.2559]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.5017, -0.9302],
         [-0.5017, -0.9302],
         [-0.5017, -0.9302],
         [-0.5017, -0.9302],
         [-0.5017, -0.9302],
         [-0.5017, -0.9302],
         [-0.5017, -0.9302],
         [-0.5017, -0.9302],
         [-0.5017, -0.9302],
         [-0.5017, -0.9302]],
        [[-1.1287, -0.3908],
         [-1.1287, -0.3908],
         [-1.1287, -0.3908],
         [-1.1287, -0.3908],
         [-1.1287, -0.3908],
         [-1.1287, -0.3908],
         [-1.1287, -0.3908],
         [-1.1287, -0.3908],
         [-1.1287, -0.3908],
         [-1.1287, -0.3908]],
        [[-0.4868, -0.9534],
         [-0.4868, -0.9534],
         [-0.4868, -0.9534],
         [-0.4868, -0.9534],
         [-0.4868, -0.9534],
         [-0.4868, -0.9534],
         [-0.4868, -0.9534],
         [-0.4868, -0.9534],
         [-0.4868, -0.9534],
         [-0.4868, -0.9534]],
        [[-1.5567, -0.2368],
         [-1.5567, -0.2368],
         [-1.5567, -0.2368],
         [-1.5567, -0.2368],
         [-1.5567, -0.2368],
         [-1.5567, -0.2368],
         [-1.5567, -0.2368],
         [-1.5567, -0.2368],
         [-1.5567, -0.2368],
         [-1.5567, -0.2368]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.8663, -0.5456],
         [-0.8663, -0.5456],
         [-0.8663, -0.5456],
         [-0.8663, -0.5456],
         [-0.8663, -0.5456],
         [-0.8663, -0.5456],
         [-0.8663, -0.5456],
         [-0.8663, -0.5456],
         [-0.8663, -0.5456],
         [-0.8663, -0.5456]],
        [[-0.6440, -0.7449],
         [-0.6440, -0.7449],
         [-0.6440, -0.7449],
         [-0.6440, -0.7449],
         [-0.6440, -0.7449],
         [-0.6440, -0.7449],
         [-0.6440, -0.7449],
         [-0.6440, -0.7449],
         [-0.6440, -0.7449],
         [-0.6440, -0.7449]],
        [[-1.7237, -0.1965],
         [-1.7237, -0.1965],
         [-1.7237, -0.1965],
         [-1.7237, -0.1965],
         [-1.7237, -0.1965],
         [-1.7237, -0.1965],
         [-1.7237, -0.1965],
         [-1.7237, -0.1965],
         [-1.7237, -0.1965],
         [-1.7237, -0.1965]],
        [[-0.4884, -0.9509],
         [-0.4884, -0.9509],
         [-0.4884, -0.9509],
         [-0.4884, -0.9509],
         [-0.4884, -0.9509],
         [-0.4884, -0.9509],
         [-0.4884, -0.9509],
         [-0.4884, -0.9509],
         [-0.4884, -0.9509],
         [-0.4884, -0.9509]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.0706, -0.4198],
         [-1.0706, -0.4198],
         [-1.0706, -0.4198],
         [-1.0706, -0.4198],
         [-1.0706, -0.4198],
         [-1.0706, -0.4198],
         [-1.0706, -0.4198],
         [-1.0706, -0.4198],
         [-1.0706, -0.4198],
         [-1.0706, -0.4198]],
        [[-0.5299, -0.8883],
         [-0.5299, -0.8883],
         [-0.5299, -0.8883],
         [-0.5299, -0.8883],
         [-0.5299, -0.8883],
         [-0.5299, -0.8883],
         [-0.5299, -0.8883],
         [-0.5299, -0.8883],
         [-0.5299, -0.8883],
         [-0.5299, -0.8883]],
        [[-0.7511, -0.6384],
         [-0.7511, -0.6384],
         [-0.7511, -0.6384],
         [-0.7511, -0.6384],
         [-0.7511, -0.6384],
         [-0.7511, -0.6384],
         [-0.7511, -0.6384],
         [-0.7511, -0.6384],
         [-0.7511, -0.6384],
         [-0.7511, -0.6384]],
        [[-1.4867, -0.2563],
         [-1.4867, -0.2563],
         [-1.4867, -0.2563],
         [-1.4867, -0.2563],
         [-1.4867, -0.2563],
         [-1.4867, -0.2563],
         [-1.4867, -0.2563],
         [-1.4867, -0.2563],
         [-1.4867, -0.2563],
         [-1.4867, -0.2563]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.2686, -0.3302],
         [-1.2686, -0.3302],
         [-1.2686, -0.3302],
         [-1.2686, -0.3302],
         [-1.2686, -0.3302],
         [-1.2686, -0.3302],
         [-1.2686, -0.3302],
         [-1.2686, -0.3302],
         [-1.2686, -0.3302],
         [-1.2686, -0.3302]],
        [[-0.4373, -1.0379],
         [-0.4373, -1.0379],
         [-0.4373, -1.0379],
         [-0.4373, -1.0379],
         [-0.4373, -1.0379],
         [-0.4373, -1.0379],
         [-0.4373, -1.0379],
         [-0.4373, -1.0379],
         [-0.4373, -1.0379],
         [-0.4373, -1.0379]],
        [[-0.4770, -0.9692],
         [-0.4770, -0.9692],
         [-0.4770, -0.9692],
         [-0.4770, -0.9692],
         [-0.4770, -0.9692],
         [-0.4770, -0.9692],
         [-0.4770, -0.9692],
         [-0.4770, -0.9692],
         [-0.4770, -0.9692],
         [-0.4770, -0.9692]],
        [[-0.4470, -1.0203],
         [-0.4470, -1.0203],
         [-0.4470, -1.0203],
         [-0.4470, -1.0203],
         [-0.4470, -1.0203],
         [-0.4470, -1.0203],
         [-0.4470, -1.0203],
         [-0.4470, -1.0203],
         [-0.4470, -1.0203],
         [-0.4470, -1.0203]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.0503, -0.4305],
         [-1.0503, -0.4305],
         [-1.0503, -0.4305],
         [-1.0503, -0.4305],
         [-1.0503, -0.4305],
         [-1.0503, -0.4305],
         [-1.0503, -0.4305],
         [-1.0503, -0.4305],
         [-1.0503, -0.4305],
         [-1.0503, -0.4305]],
        [[-0.3633, -1.1886],
         [-0.3633, -1.1886],
         [-0.3633, -1.1886],
         [-0.3633, -1.1886],
         [-0.3633, -1.1886],
         [-0.3633, -1.1886],
         [-0.3633, -1.1886],
         [-0.3633, -1.1886],
         [-0.3633, -1.1886],
         [-0.3633, -1.1886]],
        [[-1.0859, -0.4119],
         [-1.0859, -0.4119],
         [-1.0859, -0.4119],
         [-1.0859, -0.4119],
         [-1.0859, -0.4119],
         [-1.0859, -0.4119],
         [-1.0859, -0.4119],
         [-1.0859, -0.4119],
         [-1.0859, -0.4119],
         [-1.0859, -0.4119]],
        [[-1.5856, -0.2292],
         [-1.5856, -0.2292],
         [-1.5856, -0.2292],
         [-1.5856, -0.2292],
         [-1.5856, -0.2292],
         [-1.5856, -0.2292],
         [-1.5856, -0.2292],
         [-1.5856, -0.2292],
         [-1.5856, -0.2292],
         [-1.5856, -0.2292]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.6350, -0.7549],
         [-0.6350, -0.7549],
         [-0.6350, -0.7549],
         [-0.6350, -0.7549],
         [-0.6350, -0.7549],
         [-0.6350, -0.7549],
         [-0.6350, -0.7549],
         [-0.6350, -0.7549],
         [-0.6350, -0.7549],
         [-0.6350, -0.7549]],
        [[-0.3262, -1.2790],
         [-0.3262, -1.2790],
         [-0.3262, -1.2790],
         [-0.3262, -1.2790],
         [-0.3262, -1.2790],
         [-0.3262, -1.2790],
         [-0.3262, -1.2790],
         [-0.3262, -1.2790],
         [-0.3262, -1.2790],
         [-0.3262, -1.2790]],
        [[-1.2256, -0.3475],
         [-1.2256, -0.3475],
         [-1.2256, -0.3475],
         [-1.2256, -0.3475],
         [-1.2256, -0.3475],
         [-1.2256, -0.3475],
         [-1.2256, -0.3475],
         [-1.2256, -0.3475],
         [-1.2256, -0.3475],
         [-1.2256, -0.3475]],
        [[-0.9480, -0.4903],
         [-0.9480, -0.4903],
         [-0.9480, -0.4903],
         [-0.9480, -0.4903],
         [-0.9480, -0.4903],
         [-0.9480, -0.4903],
         [-0.9480, -0.4903],
         [-0.9480, -0.4903],
         [-0.9480, -0.4903],
         [-0.9480, -0.4903]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.4433, -0.2694],
         [-1.4433, -0.2694],
         [-1.4433, -0.2694],
         [-1.4433, -0.2694],
         [-1.4433, -0.2694],
         [-1.4433, -0.2694],
         [-1.4433, -0.2694],
         [-1.4433, -0.2694],
         [-1.4433, -0.2694],
         [-1.4433, -0.2694]],
        [[-0.7279, -0.6596],
         [-0.7279, -0.6596],
         [-0.7279, -0.6596],
         [-0.7279, -0.6596],
         [-0.7279, -0.6596],
         [-0.7279, -0.6596],
         [-0.7279, -0.6596],
         [-0.7279, -0.6596],
         [-0.7279, -0.6596],
         [-0.7279, -0.6596]],
        [[-0.4054, -1.0987],
         [-0.4054, -1.0987],
         [-0.4054, -1.0987],
         [-0.4054, -1.0987],
         [-0.4054, -1.0987],
         [-0.4054, -1.0987],
         [-0.4054, -1.0987],
         [-0.4054, -1.0987],
         [-0.4054, -1.0987],
         [-0.4054, -1.0987]],
        [[-0.9429, -0.4935],
         [-0.9429, -0.4935],
         [-0.9429, -0.4935],
         [-0.9429, -0.4935],
         [-0.9429, -0.4935],
         [-0.9429, -0.4935],
         [-0.9429, -0.4935],
         [-0.9429, -0.4935],
         [-0.9429, -0.4935],
         [-0.9429, -0.4935]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.1504, -0.3806],
         [-1.1504, -0.3806],
         [-1.1504, -0.3806],
         [-1.1504, -0.3806],
         [-1.1504, -0.3806],
         [-1.1504, -0.3806],
         [-1.1504, -0.3806],
         [-1.1504, -0.3806],
         [-1.1504, -0.3806],
         [-1.1504, -0.3806]],
        [[-0.9248, -0.5052],
         [-0.9248, -0.5052],
         [-0.9248, -0.5052],
         [-0.9248, -0.5052],
         [-0.9248, -0.5052],
         [-0.9248, -0.5052],
         [-0.9248, -0.5052],
         [-0.9248, -0.5052],
         [-0.9248, -0.5052],
         [-0.9248, -0.5052]],
        [[-1.2572, -0.3347],
         [-1.2572, -0.3347],
         [-1.2572, -0.3347],
         [-1.2572, -0.3347],
         [-1.2572, -0.3347],
         [-1.2572, -0.3347],
         [-1.2572, -0.3347],
         [-1.2572, -0.3347],
         [-1.2572, -0.3347],
         [-1.2572, -0.3347]],
        [[-1.1641, -0.3743],
         [-1.1641, -0.3743],
         [-1.1641, -0.3743],
         [-1.1641, -0.3743],
         [-1.1641, -0.3743],
         [-1.1641, -0.3743],
         [-1.1641, -0.3743],
         [-1.1641, -0.3743],
         [-1.1641, -0.3743],
         [-1.1641, -0.3743]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.8030, -0.5942],
         [-0.8030, -0.5942],
         [-0.8030, -0.5942],
         [-0.8030, -0.5942],
         [-0.8030, -0.5942],
         [-0.8030, -0.5942],
         [-0.8030, -0.5942],
         [-0.8030, -0.5942],
         [-0.8030, -0.5942],
         [-0.8030, -0.5942]],
        [[-0.6038, -0.7913],
         [-0.6038, -0.7913],
         [-0.6038, -0.7913],
         [-0.6038, -0.7913],
         [-0.6038, -0.7913],
         [-0.6038, -0.7913],
         [-0.6038, -0.7913],
         [-0.6038, -0.7913],
         [-0.6038, -0.7913],
         [-0.6038, -0.7913]],
        [[-0.6478, -0.7407],
         [-0.6478, -0.7407],
         [-0.6478, -0.7407],
         [-0.6478, -0.7407],
         [-0.6478, -0.7407],
         [-0.6478, -0.7407],
         [-0.6478, -0.7407],
         [-0.6478, -0.7407],
         [-0.6478, -0.7407],
         [-0.6478, -0.7407]],
        [[-0.7346, -0.6533],
         [-0.7346, -0.6533],
         [-0.7346, -0.6533],
         [-0.7346, -0.6533],
         [-0.7346, -0.6533],
         [-0.7346, -0.6533],
         [-0.7346, -0.6533],
         [-0.7346, -0.6533],
         [-0.7346, -0.6533],
         [-0.7346, -0.6533]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.3350, -0.3054],
         [-1.3350, -0.3054],
         [-1.3350, -0.3054],
         [-1.3350, -0.3054],
         [-1.3350, -0.3054],
         [-1.3350, -0.3054],
         [-1.3350, -0.3054],
         [-1.3350, -0.3054],
         [-1.3350, -0.3054],
         [-1.3350, -0.3054]],
        [[-0.8119, -0.5870],
         [-0.8119, -0.5870],
         [-0.8119, -0.5870],
         [-0.8119, -0.5870],
         [-0.8119, -0.5870],
         [-0.8119, -0.5870],
         [-0.8119, -0.5870],
         [-0.8119, -0.5870],
         [-0.8119, -0.5870],
         [-0.8119, -0.5870]],
        [[-0.9813, -0.4697],
         [-0.9813, -0.4697],
         [-0.9813, -0.4697],
         [-0.9813, -0.4697],
         [-0.9813, -0.4697],
         [-0.9813, -0.4697],
         [-0.9813, -0.4697],
         [-0.9813, -0.4697],
         [-0.9813, -0.4697],
         [-0.9813, -0.4697]],
        [[-0.5725, -0.8304],
         [-0.5725, -0.8304],
         [-0.5725, -0.8304],
         [-0.5725, -0.8304],
         [-0.5725, -0.8304],
         [-0.5725, -0.8304],
         [-0.5725, -0.8304],
         [-0.5725, -0.8304],
         [-0.5725, -0.8304],
         [-0.5725, -0.8304]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.7968, -0.5993],
         [-0.7968, -0.5993],
         [-0.7968, -0.5993],
         [-0.7968, -0.5993],
         [-0.7968, -0.5993],
         [-0.7968, -0.5993],
         [-0.7968, -0.5993],
         [-0.7968, -0.5993],
         [-0.7968, -0.5993],
         [-0.7968, -0.5993]],
        [[-1.0032, -0.4568],
         [-1.0032, -0.4568],
         [-1.0032, -0.4568],
         [-1.0032, -0.4568],
         [-1.0032, -0.4568],
         [-1.0032, -0.4568],
         [-1.0032, -0.4568],
         [-1.0032, -0.4568],
         [-1.0032, -0.4568],
         [-1.0032, -0.4568]],
        [[-0.4757, -0.9713],
         [-0.4757, -0.9713],
         [-0.4757, -0.9713],
         [-0.4757, -0.9713],
         [-0.4757, -0.9713],
         [-0.4757, -0.9713],
         [-0.4757, -0.9713],
         [-0.4757, -0.9713],
         [-0.4757, -0.9713],
         [-0.4757, -0.9713]],
        [[-0.7195, -0.6675],
         [-0.7195, -0.6675],
         [-0.7195, -0.6675],
         [-0.7195, -0.6675],
         [-0.7195, -0.6675],
         [-0.7195, -0.6675],
         [-0.7195, -0.6675],
         [-0.7195, -0.6675],
         [-0.7195, -0.6675],
         [-0.7195, -0.6675]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4529, -1.0099],
         [-0.4529, -1.0099],
         [-0.4529, -1.0099],
         [-0.4529, -1.0099],
         [-0.4529, -1.0099],
         [-0.4529, -1.0099],
         [-0.4529, -1.0099],
         [-0.4529, -1.0099],
         [-0.4529, -1.0099],
         [-0.4529, -1.0099]],
        [[-0.3033, -1.3408],
         [-0.3033, -1.3408],
         [-0.3033, -1.3408],
         [-0.3033, -1.3408],
         [-0.3033, -1.3408],
         [-0.3033, -1.3408],
         [-0.3033, -1.3408],
         [-0.3033, -1.3408],
         [-0.3033, -1.3408],
         [-0.3033, -1.3408]],
        [[-0.5679, -0.8363],
         [-0.5679, -0.8363],
         [-0.5679, -0.8363],
         [-0.5679, -0.8363],
         [-0.5679, -0.8363],
         [-0.5679, -0.8363],
         [-0.5679, -0.8363],
         [-0.5679, -0.8363],
         [-0.5679, -0.8363],
         [-0.5679, -0.8363]],
        [[-0.6421, -0.7469],
         [-0.6421, -0.7469],
         [-0.6421, -0.7469],
         [-0.6421, -0.7469],
         [-0.6421, -0.7469],
         [-0.6421, -0.7469],
         [-0.6421, -0.7469],
         [-0.6421, -0.7469],
         [-0.6421, -0.7469],
         [-0.6421, -0.7469]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.3629, -0.2956],
         [-1.3629, -0.2956],
         [-1.3629, -0.2956],
         [-1.3629, -0.2956],
         [-1.3629, -0.2956],
         [-1.3629, -0.2956],
         [-1.3629, -0.2956],
         [-1.3629, -0.2956],
         [-1.3629, -0.2956],
         [-1.3629, -0.2956]],
        [[-1.3987, -0.2836],
         [-1.3987, -0.2836],
         [-1.3987, -0.2836],
         [-1.3987, -0.2836],
         [-1.3987, -0.2836],
         [-1.3987, -0.2836],
         [-1.3987, -0.2836],
         [-1.3987, -0.2836],
         [-1.3987, -0.2836],
         [-1.3987, -0.2836]],
        [[-0.7096, -0.6770],
         [-0.7096, -0.6770],
         [-0.7096, -0.6770],
         [-0.7096, -0.6770],
         [-0.7096, -0.6770],
         [-0.7096, -0.6770],
         [-0.7096, -0.6770],
         [-0.7096, -0.6770],
         [-0.7096, -0.6770],
         [-0.7096, -0.6770]],
        [[-0.6952, -0.6910],
         [-0.6952, -0.6910],
         [-0.6952, -0.6910],
         [-0.6952, -0.6910],
         [-0.6952, -0.6910],
         [-0.6952, -0.6910],
         [-0.6952, -0.6910],
         [-0.6952, -0.6910],
         [-0.6952, -0.6910],
         [-0.6952, -0.6910]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-0.4743, -0.9737],
         [-0.4743, -0.9737],
         [-0.4743, -0.9737],
         [-0.4743, -0.9737],
         [-0.4743, -0.9737],
         [-0.4743, -0.9737],
         [-0.4743, -0.9737],
         [-0.4743, -0.9737],
         [-0.4743, -0.9737],
         [-0.4743, -0.9737]],
        [[-0.6769, -0.7097],
         [-0.6769, -0.7097],
         [-0.6769, -0.7097],
         [-0.6769, -0.7097],
         [-0.6769, -0.7097],
         [-0.6769, -0.7097],
         [-0.6769, -0.7097],
         [-0.6769, -0.7097],
         [-0.6769, -0.7097],
         [-0.6769, -0.7097]],
        [[-0.8050, -0.5925],
         [-0.8050, -0.5925],
         [-0.8050, -0.5925],
         [-0.8050, -0.5925],
         [-0.8050, -0.5925],
         [-0.8050, -0.5925],
         [-0.8050, -0.5925],
         [-0.8050, -0.5925],
         [-0.8050, -0.5925],
         [-0.8050, -0.5925]],
        [[-0.9238, -0.5059],
         [-0.9238, -0.5059],
         [-0.9238, -0.5059],
         [-0.9238, -0.5059],
         [-0.9238, -0.5059],
         [-0.9238, -0.5059],
         [-0.9238, -0.5059],
         [-0.9238, -0.5059],
         [-0.9238, -0.5059],
         [-0.9238, -0.5059]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])
context shape: torch.Size([4, 32])
shape torch.Size([4, 10, 32])
shape output torch.Size([4, 10, 32])
context vect torch.Size([4, 10, 32])
BEFORE STUFF OUTPUT SHAPE: torch.Size([4, 10, 2])
Reshaped output shape: torch.Size([4, 10, 2])
SpecialLSTM:
  - Input Shape (after input_fc): torch.Size([4, 10, 32])
  - LSTM Output Shape: torch.Size([4, 10, 32])
  - Output Shape (before reshaping): torch.Size([4, 10, 2])
Shapes:
Output shape: torch.Size([4, 10, 2]) tensor([[[-1.2411, -0.3412],
         [-1.2411, -0.3412],
         [-1.2411, -0.3412],
         [-1.2411, -0.3412],
         [-1.2411, -0.3412],
         [-1.2411, -0.3412],
         [-1.2411, -0.3412],
         [-1.2411, -0.3412],
         [-1.2411, -0.3412],
         [-1.2411, -0.3412]],
        [[-0.5781, -0.8232],
         [-0.5781, -0.8232],
         [-0.5781, -0.8232],
         [-0.5781, -0.8232],
         [-0.5781, -0.8232],
         [-0.5781, -0.8232],
         [-0.5781, -0.8232],
         [-0.5781, -0.8232],
         [-0.5781, -0.8232],
         [-0.5781, -0.8232]],
        [[-0.2852, -1.3939],
         [-0.2852, -1.3939],
         [-0.2852, -1.3939],
         [-0.2852, -1.3939],
         [-0.2852, -1.3939],
         [-0.2852, -1.3939],
         [-0.2852, -1.3939],
         [-0.2852, -1.3939],
         [-0.2852, -1.3939],
         [-0.2852, -1.3939]],
        [[-0.4836, -0.9586],
         [-0.4836, -0.9586],
         [-0.4836, -0.9586],
         [-0.4836, -0.9586],
         [-0.4836, -0.9586],
         [-0.4836, -0.9586],
         [-0.4836, -0.9586],
         [-0.4836, -0.9586],
         [-0.4836, -0.9586],
         [-0.4836, -0.9586]]], grad_fn=<LogSoftmaxBackward0>)
Mask shape: torch.Size([40])
Reshaped output shape: torch.Size([40, 2])
Shapes after reshaping and indexing:
Output shape after reshape and indexing: torch.Size([40, 2])